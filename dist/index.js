(()=>{var __webpack_modules__={3790:(e,t,r)=>{"use strict";var s=Object.create;var n=Object.defineProperty;var o=Object.getOwnPropertyDescriptor;var i=Object.getOwnPropertyNames;var a=Object.getPrototypeOf;var c=Object.prototype.hasOwnProperty;var __export=(e,t)=>{for(var r in t)n(e,r,{get:t[r],enumerable:true})};var __copyProps=(e,t,r,s)=>{if(t&&typeof t==="object"||typeof t==="function"){for(let a of i(t))if(!c.call(e,a)&&a!==r)n(e,a,{get:()=>t[a],enumerable:!(s=o(t,a))||s.enumerable})}return e};var __toESM=(e,t,r)=>(r=e!=null?s(a(e)):{},__copyProps(t||!e||!e.__esModule?n(r,"default",{value:e,enumerable:true}):r,e));var __toCommonJS=e=>__copyProps(n({},"__esModule",{value:true}),e);var l={};__export(l,{RequestError:()=>d,createAdaptorServer:()=>createAdaptorServer,getRequestListener:()=>getRequestListener,serve:()=>serve});e.exports=__toCommonJS(l);var u=r(8611);var f=r(5675);var h=r(2203);var d=class extends Error{static name="RequestError";constructor(e,t){super(e,t)}};var toRequestError=e=>{if(e instanceof d){return e}return new d(e.message,{cause:e})};var p=global.Request;var y=class extends p{constructor(e,t){if(typeof e==="object"&&g in e){e=e[g]()}if(typeof t?.body?.getReader!=="undefined"){t.duplex??="half"}super(e,t)}};var newRequestFromIncoming=(e,t,r,s)=>{const n=[];const o=r.rawHeaders;for(let e=0;e<o.length;e+=2){const{[e]:t,[e+1]:r}=o;if(t.charCodeAt(0)!==58){n.push([t,r])}}const i={method:e,headers:n,signal:s.signal};if(e==="TRACE"){i.method="GET";const e=new y(t,i);Object.defineProperty(e,"method",{get(){return"TRACE"}});return e}if(!(e==="GET"||e==="HEAD")){if("rawBody"in r&&r.rawBody instanceof Buffer){i.body=new ReadableStream({start(e){e.enqueue(r.rawBody);e.close()}})}else{i.body=h.Readable.toWeb(r)}}return new y(t,i)};var g=Symbol("getRequestCache");var m=Symbol("requestCache");var b=Symbol("incomingKey");var S=Symbol("urlKey");var v=Symbol("abortControllerKey");var k=Symbol("getAbortController");var w={get method(){return this[b].method||"GET"},get url(){return this[S]},[k](){this[g]();return this[v]},[g](){this[v]||=new AbortController;return this[m]||=newRequestFromIncoming(this.method,this[S],this[b],this[v])}};["body","bodyUsed","cache","credentials","destination","headers","integrity","mode","redirect","referrer","referrerPolicy","signal","keepalive"].forEach((e=>{Object.defineProperty(w,e,{get(){return this[g]()[e]}})}));["arrayBuffer","blob","clone","formData","json","text"].forEach((e=>{Object.defineProperty(w,e,{value:function(){return this[g]()[e]()}})}));Object.setPrototypeOf(w,y.prototype);var newRequest=(e,t)=>{const r=Object.create(w);r[b]=e;const s=e.url||"";if(s[0]!=="/"&&(s.startsWith("http://")||s.startsWith("https://"))){if(e instanceof f.Http2ServerRequest){throw new d("Absolute URL for :path is not allowed in HTTP/2")}try{const e=new URL(s);r[S]=e.href}catch(e){throw new d("Invalid absolute URL",{cause:e})}return r}const n=(e instanceof f.Http2ServerRequest?e.authority:e.headers.host)||t;if(!n){throw new d("Missing host header")}let o;if(e instanceof f.Http2ServerRequest){o=e.scheme;if(!(o==="http"||o==="https")){throw new d("Unsupported scheme")}}else{o=e.socket&&e.socket.encrypted?"https":"http"}const i=new URL(`${o}://${n}${s}`);if(i.hostname.length!==n.length&&i.hostname!==n.replace(/:\d+$/,"")){throw new d("Invalid host header")}r[S]=i.href;return r};function writeFromReadableStream(e,t){if(e.locked){throw new TypeError("ReadableStream is locked.")}else if(t.destroyed){e.cancel();return}const r=e.getReader();t.on("close",cancel);t.on("error",cancel);r.read().then(flow,cancel);return r.closed.finally((()=>{t.off("close",cancel);t.off("error",cancel)}));function cancel(e){r.cancel(e).catch((()=>{}));if(e){t.destroy(e)}}function onDrain(){r.read().then(flow,cancel)}function flow({done:e,value:s}){try{if(e){t.end()}else if(!t.write(s)){t.once("drain",onDrain)}else{return r.read().then(flow,cancel)}}catch(e){cancel(e)}}}var buildOutgoingHttpHeaders=e=>{const t={};if(!(e instanceof Headers)){e=new Headers(e??void 0)}const r=[];for(const[s,n]of e){if(s==="set-cookie"){r.push(n)}else{t[s]=n}}if(r.length>0){t["set-cookie"]=r}t["content-type"]??="text/plain; charset=UTF-8";return t};var E=Symbol("responseCache");var _=Symbol("getResponseCache");var C=Symbol("cache");var O=global.Response;var A=class _Response{#e;#t;[_](){delete this[C];return this[E]||=new O(this.#e,this.#t)}constructor(e,t){this.#e=e;if(t instanceof _Response){const e=t[E];if(e){this.#t=e;this[_]();return}else{this.#t=t.#t}}else{this.#t=t}if(typeof e==="string"||typeof e?.getReader!=="undefined"){let r=t?.headers||{"content-type":"text/plain; charset=UTF-8"};if(r instanceof Headers){r=buildOutgoingHttpHeaders(r)}this[C]=[t?.status||200,e,r]}}};["body","bodyUsed","headers","ok","redirected","status","statusText","trailers","type","url"].forEach((e=>{Object.defineProperty(A.prototype,e,{get(){return this[_]()[e]}})}));["arrayBuffer","blob","clone","formData","json","text"].forEach((e=>{Object.defineProperty(A.prototype,e,{value:function(){return this[_]()[e]()}})}));Object.setPrototypeOf(A,O);Object.setPrototypeOf(A.prototype,O.prototype);var R=Reflect.ownKeys(new O).find((e=>typeof e==="symbol"&&e.toString()==="Symbol(state)"));if(!R){console.warn("Failed to find Response internal state key")}function getInternalBody(e){if(!R){return}if(e instanceof A){e=e[_]()}const t=e[R];return t&&t.body||void 0}var x="x-hono-already-sent";var M=__toESM(r(6982));var j=global.fetch;if(typeof global.crypto==="undefined"){global.crypto=M.default}global.fetch=(e,t)=>{t={compress:false,...t};return j(e,t)};var P=/^no$/i;var T=/^(application\/json\b|text\/(?!event-stream\b))/i;var handleRequestError=()=>new Response(null,{status:400});var handleFetchError=e=>new Response(null,{status:e instanceof Error&&(e.name==="TimeoutError"||e.constructor.name==="TimeoutError")?504:500});var handleResponseError=(e,t)=>{const r=e instanceof Error?e:new Error("unknown error",{cause:e});if(r.code==="ERR_STREAM_PREMATURE_CLOSE"){console.info("The user aborted a request.")}else{console.error(e);if(!t.headersSent){t.writeHead(500,{"Content-Type":"text/plain"})}t.end(`Error: ${r.message}`);t.destroy(r)}};var responseViaCache=(e,t)=>{const[r,s,n]=e[C];if(typeof s==="string"){n["Content-Length"]=Buffer.byteLength(s);t.writeHead(r,n);t.end(s)}else{t.writeHead(r,n);return writeFromReadableStream(s,t)?.catch((e=>handleResponseError(e,t)))}};var responseViaResponseObject=async(e,t,r={})=>{if(e instanceof Promise){if(r.errorHandler){try{e=await e}catch(t){const s=await r.errorHandler(t);if(!s){return}e=s}}else{e=await e.catch(handleFetchError)}}if(C in e){return responseViaCache(e,t)}const s=buildOutgoingHttpHeaders(e.headers);const n=getInternalBody(e);if(n){const{length:r,source:o,stream:i}=n;if(o instanceof Uint8Array&&o.byteLength!==r){}else{if(r){s["content-length"]=r}t.writeHead(e.status,s);if(typeof o==="string"||o instanceof Uint8Array){t.end(o)}else if(o instanceof Blob){t.end(new Uint8Array(await o.arrayBuffer()))}else{await writeFromReadableStream(i,t)}return}}if(e.body){const{"transfer-encoding":r,"content-encoding":n,"content-length":o,"x-accel-buffering":i,"content-type":a}=s;if(r||n||o||i&&P.test(i)||!T.test(a)){t.writeHead(e.status,s);await writeFromReadableStream(e.body,t)}else{const r=await e.arrayBuffer();s["content-length"]=r.byteLength;t.writeHead(e.status,s);t.end(new Uint8Array(r))}}else if(s[x]){}else{t.writeHead(e.status,s);t.end()}};var getRequestListener=(e,t={})=>{if(t.overrideGlobalObjects!==false&&global.Request!==y){Object.defineProperty(global,"Request",{value:y});Object.defineProperty(global,"Response",{value:A})}return async(r,s)=>{let n,o;try{o=newRequest(r,t.hostname);s.on("close",(()=>{const e=o[v];if(!e){return}if(r.errored){o[v].abort(r.errored.toString())}else if(!s.writableFinished){o[v].abort("Client connection prematurely closed.")}}));n=e(o,{incoming:r,outgoing:s});if(C in n){return responseViaCache(n,s)}}catch(e){if(!n){if(t.errorHandler){n=await t.errorHandler(o?e:toRequestError(e));if(!n){return}}else if(!o){n=handleRequestError()}else{n=handleFetchError(e)}}else{return handleResponseError(e,s)}}try{return await responseViaResponseObject(n,s,t)}catch(e){return handleResponseError(e,s)}}};var createAdaptorServer=e=>{const t=e.fetch;const r=getRequestListener(t,{hostname:e.hostname,overrideGlobalObjects:e.overrideGlobalObjects});const s=e.createServer||u.createServer;const n=s(e.serverOptions||{},r);return n};var serve=(e,t)=>{const r=createAdaptorServer(e);r.listen(e?.port??3e3,e.hostname,(()=>{const e=r.address();t&&t(e)}));return r};0&&0},4317:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});t.getKeyIndexes=t.hasFlag=t.exists=t.list=void 0;const n=s(r(7613));t.list=Object.keys(n.default);const o={};t.list.forEach((e=>{o[e]=n.default[e].flags.reduce((function(e,t){e[t]=true;return e}),{})}));function exists(e){return Boolean(n.default[e])}t.exists=exists;function hasFlag(e,t){if(!o[e]){throw new Error("Unknown command "+e)}return Boolean(o[e][t])}t.hasFlag=hasFlag;function getKeyIndexes(e,t,r){const s=n.default[e];if(!s){throw new Error("Unknown command "+e)}if(!Array.isArray(t)){throw new Error("Expect args to be an array")}const o=[];const i=Boolean(r&&r.parseExternalKey);const takeDynamicKeys=(e,t)=>{const r=[];const s=Number(e[t]);for(let e=0;e<s;e++){r.push(e+t+1)}return r};const takeKeyAfterToken=(e,t,r)=>{for(let s=t;s<e.length-1;s+=1){if(String(e[s]).toLowerCase()===r.toLowerCase()){return s+1}}return null};switch(e){case"zunionstore":case"zinterstore":case"zdiffstore":o.push(0,...takeDynamicKeys(t,1));break;case"eval":case"evalsha":case"eval_ro":case"evalsha_ro":case"fcall":case"fcall_ro":case"blmpop":case"bzmpop":o.push(...takeDynamicKeys(t,1));break;case"sintercard":case"lmpop":case"zunion":case"zinter":case"zmpop":case"zintercard":case"zdiff":{o.push(...takeDynamicKeys(t,0));break}case"georadius":{o.push(0);const e=takeKeyAfterToken(t,5,"STORE");if(e)o.push(e);const r=takeKeyAfterToken(t,5,"STOREDIST");if(r)o.push(r);break}case"georadiusbymember":{o.push(0);const e=takeKeyAfterToken(t,4,"STORE");if(e)o.push(e);const r=takeKeyAfterToken(t,4,"STOREDIST");if(r)o.push(r);break}case"sort":case"sort_ro":o.push(0);for(let e=1;e<t.length-1;e++){let r=t[e];if(typeof r!=="string"){continue}const s=r.toUpperCase();if(s==="GET"){e+=1;r=t[e];if(r!=="#"){if(i){o.push([e,getExternalKeyNameLength(r)])}else{o.push(e)}}}else if(s==="BY"){e+=1;if(i){o.push([e,getExternalKeyNameLength(t[e])])}else{o.push(e)}}else if(s==="STORE"){e+=1;o.push(e)}}break;case"migrate":if(t[2]===""){for(let e=5;e<t.length-1;e++){const r=t[e];if(typeof r==="string"&&r.toUpperCase()==="KEYS"){for(let r=e+1;r<t.length;r++){o.push(r)}break}}}else{o.push(2)}break;case"xreadgroup":case"xread":for(let r=e==="xread"?0:3;r<t.length-1;r++){if(String(t[r]).toUpperCase()==="STREAMS"){for(let e=r+1;e<=r+(t.length-1-r)/2;e++){o.push(e)}break}}break;default:if(s.step>0){const e=s.keyStart-1;const r=s.keyStop>0?s.keyStop:t.length+s.keyStop+1;for(let t=e;t<r;t+=s.step){o.push(t)}}break}return o}t.getKeyIndexes=getKeyIndexes;function getExternalKeyNameLength(e){if(typeof e!=="string"){e=String(e)}const t=e.indexOf("->");return t===-1?e.length:t}},8999:e=>{var t=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920];var r=function toUTF8Array(e){var t;var r=0;var s=0;var n=[];var o=e.length;for(;r<o;r++){t=e.charCodeAt(r);if(t<128){n[s++]=t}else if(t<2048){n[s++]=t>>6|192;n[s++]=t&63|128}else if((t&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320){t=65536+((t&1023)<<10)+(e.charCodeAt(++r)&1023);n[s++]=t>>18|240;n[s++]=t>>12&63|128;n[s++]=t>>6&63|128;n[s++]=t&63|128}else{n[s++]=t>>12|224;n[s++]=t>>6&63|128;n[s++]=t&63|128}}return n};var s=e.exports=function generate(e){var s;var n=0;var o=-1;var i=0;var a=0;var c=typeof e==="string"?r(e):e;var l=c.length;while(n<l){s=c[n++];if(o===-1){if(s===123){o=n}}else if(s!==125){a=t[(s^a>>8)&255]^a<<8}else if(n-1!==o){return a&16383}i=t[(s^i>>8)&255]^i<<8}return i&16383};e.exports.generateMulti=function generateMulti(e){var t=1;var r=e.length;var n=s(e[0]);while(t<r){if(s(e[t++])!==n)return-1}return n}},6110:(e,t,r)=>{t.formatArgs=formatArgs;t.save=save;t.load=load;t.useColors=useColors;t.storage=localstorage();t.destroy=(()=>{let e=false;return()=>{if(!e){e=true;console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}}})();t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function useColors(){if(typeof window!=="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)){return true}if(typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)){return false}let e;return typeof document!=="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!=="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!=="undefined"&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function formatArgs(t){t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff);if(!this.useColors){return}const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let s=0;let n=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{if(e==="%%"){return}s++;if(e==="%c"){n=s}}));t.splice(n,0,r)}t.log=console.debug||console.log||(()=>{});function save(e){try{if(e){t.storage.setItem("debug",e)}else{t.storage.removeItem("debug")}}catch(e){}}function load(){let e;try{e=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch(e){}if(!e&&typeof process!=="undefined"&&"env"in process){e=process.env.DEBUG}return e}function localstorage(){try{return localStorage}catch(e){}}e.exports=r(897)(t);const{formatters:s}=e.exports;s.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},897:(e,t,r)=>{function setup(e){createDebug.debug=createDebug;createDebug.default=createDebug;createDebug.coerce=coerce;createDebug.disable=disable;createDebug.enable=enable;createDebug.enabled=enabled;createDebug.humanize=r(744);createDebug.destroy=destroy;Object.keys(e).forEach((t=>{createDebug[t]=e[t]}));createDebug.names=[];createDebug.skips=[];createDebug.formatters={};function selectColor(e){let t=0;for(let r=0;r<e.length;r++){t=(t<<5)-t+e.charCodeAt(r);t|=0}return createDebug.colors[Math.abs(t)%createDebug.colors.length]}createDebug.selectColor=selectColor;function createDebug(e){let t;let r=null;let s;let n;function debug(...e){if(!debug.enabled){return}const r=debug;const s=Number(new Date);const n=s-(t||s);r.diff=n;r.prev=t;r.curr=s;t=s;e[0]=createDebug.coerce(e[0]);if(typeof e[0]!=="string"){e.unshift("%O")}let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((t,s)=>{if(t==="%%"){return"%"}o++;const n=createDebug.formatters[s];if(typeof n==="function"){const s=e[o];t=n.call(r,s);e.splice(o,1);o--}return t}));createDebug.formatArgs.call(r,e);const i=r.log||createDebug.log;i.apply(r,e)}debug.namespace=e;debug.useColors=createDebug.useColors();debug.color=createDebug.selectColor(e);debug.extend=extend;debug.destroy=createDebug.destroy;Object.defineProperty(debug,"enabled",{enumerable:true,configurable:false,get:()=>{if(r!==null){return r}if(s!==createDebug.namespaces){s=createDebug.namespaces;n=createDebug.enabled(e)}return n},set:e=>{r=e}});if(typeof createDebug.init==="function"){createDebug.init(debug)}return debug}function extend(e,t){const r=createDebug(this.namespace+(typeof t==="undefined"?":":t)+e);r.log=this.log;return r}function enable(e){createDebug.save(e);createDebug.namespaces=e;createDebug.names=[];createDebug.skips=[];const t=(typeof e==="string"?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const e of t){if(e[0]==="-"){createDebug.skips.push(e.slice(1))}else{createDebug.names.push(e)}}}function matchesTemplate(e,t){let r=0;let s=0;let n=-1;let o=0;while(r<e.length){if(s<t.length&&(t[s]===e[r]||t[s]==="*")){if(t[s]==="*"){n=s;o=r;s++}else{r++;s++}}else if(n!==-1){s=n+1;o++;r=o}else{return false}}while(s<t.length&&t[s]==="*"){s++}return s===t.length}function disable(){const e=[...createDebug.names,...createDebug.skips.map((e=>"-"+e))].join(",");createDebug.enable("");return e}function enabled(e){for(const t of createDebug.skips){if(matchesTemplate(e,t)){return false}}for(const t of createDebug.names){if(matchesTemplate(e,t)){return true}}return false}function coerce(e){if(e instanceof Error){return e.stack||e.message}return e}function destroy(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}createDebug.enable(createDebug.load());return createDebug}e.exports=setup},2830:(e,t,r)=>{if(typeof process==="undefined"||process.type==="renderer"||process.browser===true||process.__nwjs){e.exports=r(6110)}else{e.exports=r(5108)}},5108:(e,t,r)=>{const s=r(2018);const n=r(9023);t.init=init;t.log=log;t.formatArgs=formatArgs;t.save=save;t.load=load;t.useColors=useColors;t.destroy=n.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");t.colors=[6,2,3,4,5,1];try{const e=r(75);if(e&&(e.stderr||e).level>=2){t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221]}}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let s=process.env[t];if(/^(yes|on|true|enabled)$/i.test(s)){s=true}else if(/^(no|off|false|disabled)$/i.test(s)){s=false}else if(s==="null"){s=null}else{s=Number(s)}e[r]=s;return e}),{});function useColors(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):s.isatty(process.stderr.fd)}function formatArgs(t){const{namespace:r,useColors:s}=this;if(s){const s=this.color;const n="[3"+(s<8?s:"8;5;"+s);const o=`  ${n};1m${r} [0m`;t[0]=o+t[0].split("\n").join("\n"+o);t.push(n+"m+"+e.exports.humanize(this.diff)+"[0m")}else{t[0]=getDate()+r+" "+t[0]}}function getDate(){if(t.inspectOpts.hideDate){return""}return(new Date).toISOString()+" "}function log(...e){return process.stderr.write(n.formatWithOptions(t.inspectOpts,...e)+"\n")}function save(e){if(e){process.env.DEBUG=e}else{delete process.env.DEBUG}}function load(){return process.env.DEBUG}function init(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let s=0;s<r.length;s++){e.inspectOpts[r[s]]=t.inspectOpts[r[s]]}}e.exports=r(897)(t);const{formatters:o}=e.exports;o.o=function(e){this.inspectOpts.colors=this.useColors;return n.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")};o.O=function(e){this.inspectOpts.colors=this.useColors;return n.inspect(e,this.inspectOpts)}},9036:e=>{"use strict";function Denque(e,t){var t=t||{};this._capacity=t.capacity;this._head=0;this._tail=0;if(Array.isArray(e)){this._fromArray(e)}else{this._capacityMask=3;this._list=new Array(4)}}Denque.prototype.peekAt=function peekAt(e){var t=e;if(t!==(t|0)){return void 0}var r=this.size();if(t>=r||t<-r)return undefined;if(t<0)t+=r;t=this._head+t&this._capacityMask;return this._list[t]};Denque.prototype.get=function get(e){return this.peekAt(e)};Denque.prototype.peek=function peek(){if(this._head===this._tail)return undefined;return this._list[this._head]};Denque.prototype.peekFront=function peekFront(){return this.peek()};Denque.prototype.peekBack=function peekBack(){return this.peekAt(-1)};Object.defineProperty(Denque.prototype,"length",{get:function length(){return this.size()}});Denque.prototype.size=function size(){if(this._head===this._tail)return 0;if(this._head<this._tail)return this._tail-this._head;else return this._capacityMask+1-(this._head-this._tail)};Denque.prototype.unshift=function unshift(e){if(arguments.length===0)return this.size();var t=this._list.length;this._head=this._head-1+t&this._capacityMask;this._list[this._head]=e;if(this._tail===this._head)this._growArray();if(this._capacity&&this.size()>this._capacity)this.pop();if(this._head<this._tail)return this._tail-this._head;else return this._capacityMask+1-(this._head-this._tail)};Denque.prototype.shift=function shift(){var e=this._head;if(e===this._tail)return undefined;var t=this._list[e];this._list[e]=undefined;this._head=e+1&this._capacityMask;if(e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2)this._shrinkArray();return t};Denque.prototype.push=function push(e){if(arguments.length===0)return this.size();var t=this._tail;this._list[t]=e;this._tail=t+1&this._capacityMask;if(this._tail===this._head){this._growArray()}if(this._capacity&&this.size()>this._capacity){this.shift()}if(this._head<this._tail)return this._tail-this._head;else return this._capacityMask+1-(this._head-this._tail)};Denque.prototype.pop=function pop(){var e=this._tail;if(e===this._head)return undefined;var t=this._list.length;this._tail=e-1+t&this._capacityMask;var r=this._list[this._tail];this._list[this._tail]=undefined;if(this._head<2&&e>1e4&&e<=t>>>2)this._shrinkArray();return r};Denque.prototype.removeOne=function removeOne(e){var t=e;if(t!==(t|0)){return void 0}if(this._head===this._tail)return void 0;var r=this.size();var s=this._list.length;if(t>=r||t<-r)return void 0;if(t<0)t+=r;t=this._head+t&this._capacityMask;var n=this._list[t];var o;if(e<r/2){for(o=e;o>0;o--){this._list[t]=this._list[t=t-1+s&this._capacityMask]}this._list[t]=void 0;this._head=this._head+1+s&this._capacityMask}else{for(o=r-1-e;o>0;o--){this._list[t]=this._list[t=t+1+s&this._capacityMask]}this._list[t]=void 0;this._tail=this._tail-1+s&this._capacityMask}return n};Denque.prototype.remove=function remove(e,t){var r=e;var s;var n=t;if(r!==(r|0)){return void 0}if(this._head===this._tail)return void 0;var o=this.size();var i=this._list.length;if(r>=o||r<-o||t<1)return void 0;if(r<0)r+=o;if(t===1||!t){s=new Array(1);s[0]=this.removeOne(r);return s}if(r===0&&r+t>=o){s=this.toArray();this.clear();return s}if(r+t>o)t=o-r;var a;s=new Array(t);for(a=0;a<t;a++){s[a]=this._list[this._head+r+a&this._capacityMask]}r=this._head+r&this._capacityMask;if(e+t===o){this._tail=this._tail-t+i&this._capacityMask;for(a=t;a>0;a--){this._list[r=r+1+i&this._capacityMask]=void 0}return s}if(e===0){this._head=this._head+t+i&this._capacityMask;for(a=t-1;a>0;a--){this._list[r=r+1+i&this._capacityMask]=void 0}return s}if(r<o/2){this._head=this._head+e+t+i&this._capacityMask;for(a=e;a>0;a--){this.unshift(this._list[r=r-1+i&this._capacityMask])}r=this._head-1+i&this._capacityMask;while(n>0){this._list[r=r-1+i&this._capacityMask]=void 0;n--}if(e<0)this._tail=r}else{this._tail=r;r=r+t+i&this._capacityMask;for(a=o-(t+e);a>0;a--){this.push(this._list[r++])}r=this._tail;while(n>0){this._list[r=r+1+i&this._capacityMask]=void 0;n--}}if(this._head<2&&this._tail>1e4&&this._tail<=i>>>2)this._shrinkArray();return s};Denque.prototype.splice=function splice(e,t){var r=e;if(r!==(r|0)){return void 0}var s=this.size();if(r<0)r+=s;if(r>s)return void 0;if(arguments.length>2){var n;var o;var i;var a=arguments.length;var c=this._list.length;var l=2;if(!s||r<s/2){o=new Array(r);for(n=0;n<r;n++){o[n]=this._list[this._head+n&this._capacityMask]}if(t===0){i=[];if(r>0){this._head=this._head+r+c&this._capacityMask}}else{i=this.remove(r,t);this._head=this._head+r+c&this._capacityMask}while(a>l){this.unshift(arguments[--a])}for(n=r;n>0;n--){this.unshift(o[n-1])}}else{o=new Array(s-(r+t));var u=o.length;for(n=0;n<u;n++){o[n]=this._list[this._head+r+t+n&this._capacityMask]}if(t===0){i=[];if(r!=s){this._tail=this._head+r+c&this._capacityMask}}else{i=this.remove(r,t);this._tail=this._tail-u+c&this._capacityMask}while(l<a){this.push(arguments[l++])}for(n=0;n<u;n++){this.push(o[n])}}return i}else{return this.remove(r,t)}};Denque.prototype.clear=function clear(){this._list=new Array(this._list.length);this._head=0;this._tail=0};Denque.prototype.isEmpty=function isEmpty(){return this._head===this._tail};Denque.prototype.toArray=function toArray(){return this._copyArray(false)};Denque.prototype._fromArray=function _fromArray(e){var t=e.length;var r=this._nextPowerOf2(t);this._list=new Array(r);this._capacityMask=r-1;this._tail=t;for(var s=0;s<t;s++)this._list[s]=e[s]};Denque.prototype._copyArray=function _copyArray(e,t){var r=this._list;var s=r.length;var n=this.length;t=t|n;if(t==n&&this._head<this._tail){return this._list.slice(this._head,this._tail)}var o=new Array(t);var i=0;var a;if(e||this._head>this._tail){for(a=this._head;a<s;a++)o[i++]=r[a];for(a=0;a<this._tail;a++)o[i++]=r[a]}else{for(a=this._head;a<this._tail;a++)o[i++]=r[a]}return o};Denque.prototype._growArray=function _growArray(){if(this._head!=0){var e=this._copyArray(true,this._list.length<<1);this._tail=this._list.length;this._head=0;this._list=e}else{this._tail=this._list.length;this._list.length<<=1}this._capacityMask=this._capacityMask<<1|1};Denque.prototype._shrinkArray=function _shrinkArray(){this._list.length>>>=1;this._capacityMask>>>=1};Denque.prototype._nextPowerOf2=function _nextPowerOf2(e){var t=Math.log(e)/Math.log(2);var r=1<<t+1;return Math.max(r,4)};e.exports=Denque},5017:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const s=r(4317);const n=r(8999);const o=r(5659);const i=r(7670);class Command{constructor(e,t=[],r={},s){this.name=e;this.inTransaction=false;this.isResolved=false;this.transformed=false;this.replyEncoding=r.replyEncoding;this.errorStack=r.errorStack;this.args=t.flat();this.callback=s;this.initPromise();if(r.keyPrefix){const e=r.keyPrefix instanceof Buffer;let t=e?r.keyPrefix:null;this._iterateKeys((s=>{if(s instanceof Buffer){if(t===null){t=Buffer.from(r.keyPrefix)}return Buffer.concat([t,s])}else if(e){return Buffer.concat([r.keyPrefix,Buffer.from(String(s))])}return r.keyPrefix+s}))}if(r.readOnly){this.isReadOnly=true}}static checkFlag(e,t){return!!this.getFlagMap()[e][t]}static setArgumentTransformer(e,t){this._transformer.argument[e]=t}static setReplyTransformer(e,t){this._transformer.reply[e]=t}static getFlagMap(){if(!this.flagMap){this.flagMap=Object.keys(Command.FLAGS).reduce(((e,t)=>{e[t]={};Command.FLAGS[t].forEach((r=>{e[t][r]=true}));return e}),{})}return this.flagMap}getSlot(){if(typeof this.slot==="undefined"){const e=this.getKeys()[0];this.slot=e==null?null:n(e)}return this.slot}getKeys(){return this._iterateKeys()}toWritable(e){let t;const r="*"+(this.args.length+1)+"\r\n$"+Buffer.byteLength(this.name)+"\r\n"+this.name+"\r\n";if(this.bufferMode){const e=new MixedBuffers;e.push(r);for(let t=0;t<this.args.length;++t){const r=this.args[t];if(r instanceof Buffer){if(r.length===0){e.push("$0\r\n\r\n")}else{e.push("$"+r.length+"\r\n");e.push(r);e.push("\r\n")}}else{e.push("$"+Buffer.byteLength(r)+"\r\n"+r+"\r\n")}}t=e.toBuffer()}else{t=r;for(let e=0;e<this.args.length;++e){const r=this.args[e];t+="$"+Buffer.byteLength(r)+"\r\n"+r+"\r\n"}}return t}stringifyArguments(){for(let e=0;e<this.args.length;++e){const t=this.args[e];if(typeof t==="string"){}else if(t instanceof Buffer){this.bufferMode=true}else{this.args[e]=(0,i.toArg)(t)}}}transformReply(e){if(this.replyEncoding){e=(0,i.convertBufferToString)(e,this.replyEncoding)}const t=Command._transformer.reply[this.name];if(t){e=t(e)}return e}setTimeout(e){if(!this._commandTimeoutTimer){this._commandTimeoutTimer=setTimeout((()=>{if(!this.isResolved){this.reject(new Error("Command timed out"))}}),e)}}initPromise(){const e=new Promise(((e,t)=>{if(!this.transformed){this.transformed=true;const e=Command._transformer.argument[this.name];if(e){this.args=e(this.args)}this.stringifyArguments()}this.resolve=this._convertValue(e);if(this.errorStack){this.reject=e=>{t((0,i.optimizeErrorStack)(e,this.errorStack.stack,__dirname))}}else{this.reject=t}}));this.promise=(0,o.default)(e,this.callback)}_iterateKeys(e=e=>e){if(typeof this.keys==="undefined"){this.keys=[];if((0,s.exists)(this.name)){const t=(0,s.getKeyIndexes)(this.name,this.args);for(const r of t){this.args[r]=e(this.args[r]);this.keys.push(this.args[r])}}}return this.keys}_convertValue(e){return t=>{try{const r=this._commandTimeoutTimer;if(r){clearTimeout(r);delete this._commandTimeoutTimer}e(this.transformReply(t));this.isResolved=true}catch(e){this.reject(e)}return this.promise}}}t["default"]=Command;Command.FLAGS={VALID_IN_SUBSCRIBER_MODE:["subscribe","psubscribe","unsubscribe","punsubscribe","ssubscribe","sunsubscribe","ping","quit"],VALID_IN_MONITOR_MODE:["monitor","auth"],ENTER_SUBSCRIBER_MODE:["subscribe","psubscribe","ssubscribe"],EXIT_SUBSCRIBER_MODE:["unsubscribe","punsubscribe","sunsubscribe"],WILL_DISCONNECT:["quit"]};Command._transformer={argument:{},reply:{}};const msetArgumentTransformer=function(e){if(e.length===1){if(e[0]instanceof Map){return(0,i.convertMapToArray)(e[0])}if(typeof e[0]==="object"&&e[0]!==null){return(0,i.convertObjectToArray)(e[0])}}return e};const hsetArgumentTransformer=function(e){if(e.length===2){if(e[1]instanceof Map){return[e[0]].concat((0,i.convertMapToArray)(e[1]))}if(typeof e[1]==="object"&&e[1]!==null){return[e[0]].concat((0,i.convertObjectToArray)(e[1]))}}return e};Command.setArgumentTransformer("mset",msetArgumentTransformer);Command.setArgumentTransformer("msetnx",msetArgumentTransformer);Command.setArgumentTransformer("hset",hsetArgumentTransformer);Command.setArgumentTransformer("hmset",hsetArgumentTransformer);Command.setReplyTransformer("hgetall",(function(e){if(Array.isArray(e)){const t={};for(let r=0;r<e.length;r+=2){const s=e[r];const n=e[r+1];if(s in t){Object.defineProperty(t,s,{value:n,configurable:true,enumerable:true,writable:true})}else{t[s]=n}}return t}return e}));class MixedBuffers{constructor(){this.length=0;this.items=[]}push(e){this.length+=Buffer.byteLength(e);this.items.push(e)}toBuffer(){const e=Buffer.allocUnsafe(this.length);let t=0;for(const r of this.items){const s=Buffer.byteLength(r);Buffer.isBuffer(r)?r.copy(e,t):e.write(r,t,s);t+=s}return e}}},4588:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const s=r(5017);const n=r(7670);const o=r(5665);const i=r(2183);const a=(0,n.Debug)("dataHandler");class DataHandler{constructor(e,t){this.redis=e;const r=new o({stringNumbers:t.stringNumbers,returnBuffers:true,returnError:e=>{this.returnError(e)},returnFatalError:e=>{this.returnFatalError(e)},returnReply:e=>{this.returnReply(e)}});e.stream.prependListener("data",(e=>{r.execute(e)}));e.stream.resume()}returnFatalError(e){e.message+=". Please report this.";this.redis.recoverFromFatalError(e,e,{offlineQueue:false})}returnError(e){const t=this.shiftCommand(e);if(!t){return}e.command={name:t.command.name,args:t.command.args};this.redis.handleReconnection(e,t)}returnReply(e){if(this.handleMonitorReply(e)){return}if(this.handleSubscriberReply(e)){return}const t=this.shiftCommand(e);if(!t){return}if(s.default.checkFlag("ENTER_SUBSCRIBER_MODE",t.command.name)){this.redis.condition.subscriber=new i.default;this.redis.condition.subscriber.add(t.command.name,e[1].toString());if(!fillSubCommand(t.command,e[2])){this.redis.commandQueue.unshift(t)}}else if(s.default.checkFlag("EXIT_SUBSCRIBER_MODE",t.command.name)){if(!fillUnsubCommand(t.command,e[2])){this.redis.commandQueue.unshift(t)}}else{t.command.resolve(e)}}handleSubscriberReply(e){if(!this.redis.condition.subscriber){return false}const t=Array.isArray(e)?e[0].toString():null;a('receive reply "%s" in subscriber mode',t);switch(t){case"message":if(this.redis.listeners("message").length>0){this.redis.emit("message",e[1].toString(),e[2]?e[2].toString():"")}this.redis.emit("messageBuffer",e[1],e[2]);break;case"pmessage":{const t=e[1].toString();if(this.redis.listeners("pmessage").length>0){this.redis.emit("pmessage",t,e[2].toString(),e[3].toString())}this.redis.emit("pmessageBuffer",t,e[2],e[3]);break}case"smessage":{if(this.redis.listeners("smessage").length>0){this.redis.emit("smessage",e[1].toString(),e[2]?e[2].toString():"")}this.redis.emit("smessageBuffer",e[1],e[2]);break}case"ssubscribe":case"subscribe":case"psubscribe":{const r=e[1].toString();this.redis.condition.subscriber.add(t,r);const s=this.shiftCommand(e);if(!s){return}if(!fillSubCommand(s.command,e[2])){this.redis.commandQueue.unshift(s)}break}case"sunsubscribe":case"unsubscribe":case"punsubscribe":{const r=e[1]?e[1].toString():null;if(r){this.redis.condition.subscriber.del(t,r)}const s=e[2];if(Number(s)===0){this.redis.condition.subscriber=false}const n=this.shiftCommand(e);if(!n){return}if(!fillUnsubCommand(n.command,s)){this.redis.commandQueue.unshift(n)}break}default:{const t=this.shiftCommand(e);if(!t){return}t.command.resolve(e)}}return true}handleMonitorReply(e){if(this.redis.status!=="monitoring"){return false}const t=e.toString();if(t==="OK"){return false}const r=t.indexOf(" ");const s=t.slice(0,r);const n=t.indexOf('"');const o=t.slice(n+1,-1).split('" "').map((e=>e.replace(/\\"/g,'"')));const i=t.slice(r+2,n-2).split(" ");this.redis.emit("monitor",s,o,i[1],i[0]);return true}shiftCommand(e){const t=this.redis.commandQueue.shift();if(!t){const t="Command queue state error. If you can reproduce this, please report it.";const r=new Error(t+(e instanceof Error?` Last error: ${e.message}`:` Last reply: ${e.toString()}`));this.redis.emit("error",r);return null}return t}}t["default"]=DataHandler;const c=new WeakMap;function fillSubCommand(e,t){let r=c.has(e)?c.get(e):e.args.length;r-=1;if(r<=0){e.resolve(t);c.delete(e);return true}c.set(e,r);return false}function fillUnsubCommand(e,t){let r=c.has(e)?c.get(e):e.args.length;if(r===0){if(Number(t)===0){c.delete(e);e.resolve(t);return true}return false}r-=1;if(r<=0){e.resolve(t);return true}c.set(e,r);return false}},8940:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const s=r(8999);const n=r(4317);const o=r(5659);const i=r(9023);const a=r(5017);const c=r(7670);const l=r(3240);function generateMultiWithNodes(e,t){const r=s(t[0]);const n=e._groupsBySlot[r];for(let r=1;r<t.length;r++){if(e._groupsBySlot[s(t[r])]!==n){return-1}}return r}class Pipeline extends l.default{constructor(e){super();this.redis=e;this.isPipeline=true;this.replyPending=0;this._queue=[];this._result=[];this._transactions=0;this._shaToScript={};this.isCluster=this.redis.constructor.name==="Cluster"||this.redis.isCluster;this.options=e.options;Object.keys(e.scriptsSet).forEach((t=>{const r=e.scriptsSet[t];this._shaToScript[r.sha]=r;this[t]=e[t];this[t+"Buffer"]=e[t+"Buffer"]}));e.addedBuiltinSet.forEach((t=>{this[t]=e[t];this[t+"Buffer"]=e[t+"Buffer"]}));this.promise=new Promise(((e,t)=>{this.resolve=e;this.reject=t}));const t=this;Object.defineProperty(this,"length",{get:function(){return t._queue.length}})}fillResult(e,t){if(this._queue[t].name==="exec"&&Array.isArray(e[1])){const r=e[1].length;for(let s=0;s<r;s++){if(e[1][s]instanceof Error){continue}const n=this._queue[t-(r-s)];try{e[1][s]=n.transformReply(e[1][s])}catch(t){e[1][s]=t}}}this._result[t]=e;if(--this.replyPending){return}if(this.isCluster){let e=true;let t;for(let r=0;r<this._result.length;++r){const s=this._result[r][0];const o=this._queue[r];if(s){if(o.name==="exec"&&s.message==="EXECABORT Transaction discarded because of previous errors."){continue}if(!t){t={name:s.name,message:s.message}}else if(t.name!==s.name||t.message!==s.message){e=false;break}}else if(!o.inTransaction){const t=(0,n.exists)(o.name)&&(0,n.hasFlag)(o.name,"readonly");if(!t){e=false;break}}}if(t&&e){const e=this;const r=t.message.split(" ");const s=this._queue;let n=false;this._queue=[];for(let e=0;e<s.length;++e){if(r[0]==="ASK"&&!n&&s[e].name!=="asking"&&(!s[e-1]||s[e-1].name!=="asking")){const e=new a.default("asking");e.ignore=true;this.sendCommand(e)}s[e].initPromise();this.sendCommand(s[e]);n=s[e].inTransaction}let o=true;if(typeof this.leftRedirections==="undefined"){this.leftRedirections={}}const exec=function(){e.exec()};const i=this.redis;i.handleError(t,this.leftRedirections,{moved:function(t,s){e.preferKey=s;i.slots[r[1]]=[s];i._groupsBySlot[r[1]]=i._groupsIds[i.slots[r[1]].join(";")];i.refreshSlotsCache();e.exec()},ask:function(t,r){e.preferKey=r;e.exec()},tryagain:exec,clusterDown:exec,connectionClosed:exec,maxRedirections:()=>{o=false},defaults:()=>{o=false}});if(o){return}}}let r=0;for(let e=0;e<this._queue.length-r;++e){if(this._queue[e+r].ignore){r+=1}this._result[e]=this._result[e+r]}this.resolve(this._result.slice(0,this._result.length-r))}sendCommand(e){if(this._transactions>0){e.inTransaction=true}const t=this._queue.length;e.pipelineIndex=t;e.promise.then((e=>{this.fillResult([null,e],t)})).catch((e=>{this.fillResult([e],t)}));this._queue.push(e);return this}addBatch(e){let t,r,s;for(let n=0;n<e.length;++n){t=e[n];r=t[0];s=t.slice(1);this[r].apply(this,s)}return this}}t["default"]=Pipeline;const u=Pipeline.prototype.multi;Pipeline.prototype.multi=function(){this._transactions+=1;return u.apply(this,arguments)};const f=Pipeline.prototype.execBuffer;Pipeline.prototype.execBuffer=(0,i.deprecate)((function(){if(this._transactions>0){this._transactions-=1}return f.apply(this,arguments)}),"Pipeline#execBuffer: Use Pipeline#exec instead");Pipeline.prototype.exec=function(e){if(this.isCluster&&!this.redis.slots.length){if(this.redis.status==="wait")this.redis.connect().catch(c.noop);if(e&&!this.nodeifiedPromise){this.nodeifiedPromise=true;(0,o.default)(this.promise,e)}this.redis.delayUntilReady((t=>{if(t){this.reject(t);return}this.exec(e)}));return this.promise}if(this._transactions>0){this._transactions-=1;return f.apply(this,arguments)}if(!this.nodeifiedPromise){this.nodeifiedPromise=true;(0,o.default)(this.promise,e)}if(!this._queue.length){this.resolve([])}let t;if(this.isCluster){const e=[];for(let t=0;t<this._queue.length;t++){const r=this._queue[t].getKeys();if(r.length){e.push(r[0])}if(r.length&&s.generateMulti(r)<0){this.reject(new Error("All the keys in a pipeline command should belong to the same slot"));return this.promise}}if(e.length){t=generateMultiWithNodes(this.redis,e);if(t<0){this.reject(new Error("All keys in the pipeline should belong to the same slots allocation group"));return this.promise}}else{t=Math.random()*16384|0}}const r=this;execPipeline();return this.promise;function execPipeline(){let e=r.replyPending=r._queue.length;let s;if(r.isCluster){s={slot:t,redis:r.redis.connectionPool.nodes.all[r.preferKey]}}let n="";let o;const i={isPipeline:true,destination:r.isCluster?s:{redis:r.redis},write(t){if(typeof t!=="string"){if(!o){o=[]}if(n){o.push(Buffer.from(n,"utf8"));n=""}o.push(t)}else{n+=t}if(! --e){if(o){if(n){o.push(Buffer.from(n,"utf8"))}i.destination.redis.stream.write(Buffer.concat(o))}else{i.destination.redis.stream.write(n)}e=r._queue.length;n="";o=undefined}}};for(let e=0;e<r._queue.length;++e){r.redis.sendCommand(r._queue[e],i,s)}return r.promise}}},5695:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const s=r(4317);const n=r(4434);const o=r(5659);const i=r(1633);const a=r(5017);const c=r(8053);const l=r(8325);const u=r(1107);const f=r(7669);const h=r(6443);const d=r(5708);const p=r(7670);const y=r(6985);const g=r(3240);const m=r(7274);const b=r(9036);const S=(0,p.Debug)("redis");class Redis extends g.default{constructor(e,t,r){super();this.status="wait";this.isCluster=false;this.reconnectTimeout=null;this.connectionEpoch=0;this.retryAttempts=0;this.manuallyClosing=false;this._autoPipelines=new Map;this._runningAutoPipelines=new Set;this.parseOptions(e,t,r);n.EventEmitter.call(this);this.resetCommandQueue();this.resetOfflineQueue();if(this.options.Connector){this.connector=new this.options.Connector(this.options)}else if(this.options.sentinels){const e=new l.default(this.options);e.emitter=this;this.connector=e}else{this.connector=new c.StandaloneConnector(this.options)}if(this.options.scripts){Object.entries(this.options.scripts).forEach((([e,t])=>{this.defineCommand(e,t)}))}if(this.options.lazyConnect){this.setStatus("wait")}else{this.connect().catch(m.noop)}}static createClient(...e){return new Redis(...e)}get autoPipelineQueueSize(){let e=0;for(const t of this._autoPipelines.values()){e+=t.length}return e}connect(e){const t=new Promise(((e,t)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){t(new Error("Redis is already connecting/connected"));return}this.connectionEpoch+=1;this.setStatus("connecting");const{options:r}=this;this.condition={select:r.db,auth:r.username?[r.username,r.password]:r.password,subscriber:false};const s=this;(0,o.default)(this.connector.connect((function(e,t){s.silentEmit(e,t)})),(function(n,o){if(n){s.flushQueue(n);s.silentEmit("error",n);t(n);s.setStatus("end");return}let i=r.tls?"secureConnect":"connect";if("sentinels"in r&&r.sentinels&&!r.enableTLSForSentinelMode){i="connect"}s.stream=o;if(r.noDelay){o.setNoDelay(true)}if(typeof r.keepAlive==="number"){if(o.connecting){o.once(i,(()=>{o.setKeepAlive(true,r.keepAlive)}))}else{o.setKeepAlive(true,r.keepAlive)}}if(o.connecting){o.once(i,u.connectHandler(s));if(r.connectTimeout){let e=false;o.setTimeout(r.connectTimeout,(function(){if(e){return}o.setTimeout(0);o.destroy();const t=new Error("connect ETIMEDOUT");t.errorno="ETIMEDOUT";t.code="ETIMEDOUT";t.syscall="connect";u.errorHandler(s)(t)}));o.once(i,(function(){e=true;o.setTimeout(0)}))}}else if(o.destroyed){const e=s.connector.firstError;if(e){process.nextTick((()=>{u.errorHandler(s)(e)}))}process.nextTick(u.closeHandler(s))}else{process.nextTick(u.connectHandler(s))}if(!o.destroyed){o.once("error",u.errorHandler(s));o.once("close",u.closeHandler(s))}const connectionReadyHandler=function(){s.removeListener("close",connectionCloseHandler);e()};var connectionCloseHandler=function(){s.removeListener("ready",connectionReadyHandler);t(new Error(p.CONNECTION_CLOSED_ERROR_MSG))};s.once("ready",connectionReadyHandler);s.once("close",connectionCloseHandler)}))}));return(0,o.default)(t,e)}disconnect(e=false){if(!e){this.manuallyClosing=true}if(this.reconnectTimeout&&!e){clearTimeout(this.reconnectTimeout);this.reconnectTimeout=null}if(this.status==="wait"){u.closeHandler(this)()}else{this.connector.disconnect()}}end(){this.disconnect()}duplicate(e){return new Redis({...this.options,...e})}get mode(){var e;return this.options.monitor?"monitor":((e=this.condition)===null||e===void 0?void 0:e.subscriber)?"subscriber":"normal"}monitor(e){const t=this.duplicate({monitor:true,lazyConnect:false});return(0,o.default)(new Promise((function(e,r){t.once("error",r);t.once("monitoring",(function(){e(t)}))})),e)}sendCommand(e,t){var r,n;if(this.status==="wait"){this.connect().catch(m.noop)}if(this.status==="end"){e.reject(new Error(p.CONNECTION_CLOSED_ERROR_MSG));return e.promise}if(((r=this.condition)===null||r===void 0?void 0:r.subscriber)&&!a.default.checkFlag("VALID_IN_SUBSCRIBER_MODE",e.name)){e.reject(new Error("Connection in subscriber mode, only subscriber commands may be used"));return e.promise}if(typeof this.options.commandTimeout==="number"){e.setTimeout(this.options.commandTimeout)}let o=this.status==="ready"||!t&&this.status==="connect"&&(0,s.exists)(e.name)&&(0,s.hasFlag)(e.name,"loading");if(!this.stream){o=false}else if(!this.stream.writable){o=false}else if(this.stream._writableState&&this.stream._writableState.ended){o=false}if(!o){if(!this.options.enableOfflineQueue){e.reject(new Error("Stream isn't writeable and enableOfflineQueue options is false"));return e.promise}if(e.name==="quit"&&this.offlineQueue.length===0){this.disconnect();e.resolve(Buffer.from("OK"));return e.promise}if(S.enabled){S("queue command[%s]: %d -> %s(%o)",this._getDescription(),this.condition.select,e.name,e.args)}this.offlineQueue.push({command:e,stream:t,select:this.condition.select})}else{if(S.enabled){S("write command[%s]: %d -> %s(%o)",this._getDescription(),(n=this.condition)===null||n===void 0?void 0:n.select,e.name,e.args)}if(t){if("isPipeline"in t&&t.isPipeline){t.write(e.toWritable(t.destination.redis.stream))}else{t.write(e.toWritable(t))}}else{this.stream.write(e.toWritable(this.stream))}this.commandQueue.push({command:e,stream:t,select:this.condition.select});if(a.default.checkFlag("WILL_DISCONNECT",e.name)){this.manuallyClosing=true}if(this.options.socketTimeout!==undefined&&this.socketTimeoutTimer===undefined){this.setSocketTimeout()}}if(e.name==="select"&&(0,p.isInt)(e.args[0])){const t=parseInt(e.args[0],10);if(this.condition.select!==t){this.condition.select=t;this.emit("select",t);S("switch to db [%d]",this.condition.select)}}return e.promise}setSocketTimeout(){this.socketTimeoutTimer=setTimeout((()=>{this.stream.destroy(new Error(`Socket timeout. Expecting data, but didn't receive any in ${this.options.socketTimeout}ms.`));this.socketTimeoutTimer=undefined}),this.options.socketTimeout);this.stream.once("data",(()=>{clearTimeout(this.socketTimeoutTimer);this.socketTimeoutTimer=undefined;if(this.commandQueue.length===0)return;this.setSocketTimeout()}))}scanStream(e){return this.createScanStream("scan",{options:e})}scanBufferStream(e){return this.createScanStream("scanBuffer",{options:e})}sscanStream(e,t){return this.createScanStream("sscan",{key:e,options:t})}sscanBufferStream(e,t){return this.createScanStream("sscanBuffer",{key:e,options:t})}hscanStream(e,t){return this.createScanStream("hscan",{key:e,options:t})}hscanBufferStream(e,t){return this.createScanStream("hscanBuffer",{key:e,options:t})}zscanStream(e,t){return this.createScanStream("zscan",{key:e,options:t})}zscanBufferStream(e,t){return this.createScanStream("zscanBuffer",{key:e,options:t})}silentEmit(e,t){let r;if(e==="error"){r=t;if(this.status==="end"){return}if(this.manuallyClosing){if(r instanceof Error&&(r.message===p.CONNECTION_CLOSED_ERROR_MSG||r.syscall==="connect"||r.syscall==="read")){return}}}if(this.listeners(e).length>0){return this.emit.apply(this,arguments)}if(r&&r instanceof Error){console.error("[ioredis] Unhandled error event:",r.stack)}return false}recoverFromFatalError(e,t,r){this.flushQueue(t,r);this.silentEmit("error",t);this.disconnect(true)}handleReconnection(e,t){var r;let s=false;if(this.options.reconnectOnError){s=this.options.reconnectOnError(e)}switch(s){case 1:case true:if(this.status!=="reconnecting"){this.disconnect(true)}t.command.reject(e);break;case 2:if(this.status!=="reconnecting"){this.disconnect(true)}if(((r=this.condition)===null||r===void 0?void 0:r.select)!==t.select&&t.command.name!=="select"){this.select(t.select)}this.sendCommand(t.command);break;default:t.command.reject(e)}}_getDescription(){let e;if("path"in this.options&&this.options.path){e=this.options.path}else if(this.stream&&this.stream.remoteAddress&&this.stream.remotePort){e=this.stream.remoteAddress+":"+this.stream.remotePort}else if("host"in this.options&&this.options.host){e=this.options.host+":"+this.options.port}else{e=""}if(this.options.connectionName){e+=` (${this.options.connectionName})`}return e}resetCommandQueue(){this.commandQueue=new b}resetOfflineQueue(){this.offlineQueue=new b}parseOptions(...e){const t={};let r=false;for(let s=0;s<e.length;++s){const n=e[s];if(n===null||typeof n==="undefined"){continue}if(typeof n==="object"){(0,m.defaults)(t,n)}else if(typeof n==="string"){(0,m.defaults)(t,(0,p.parseURL)(n));if(n.startsWith("rediss://")){r=true}}else if(typeof n==="number"){t.port=n}else{throw new Error("Invalid argument "+n)}}if(r){(0,m.defaults)(t,{tls:true})}(0,m.defaults)(t,Redis.defaultOptions);if(typeof t.port==="string"){t.port=parseInt(t.port,10)}if(typeof t.db==="string"){t.db=parseInt(t.db,10)}this.options=(0,p.resolveTLSProfile)(t)}setStatus(e,t){if(S.enabled){S("status[%s]: %s -> %s",this._getDescription(),this.status||"[empty]",e)}this.status=e;process.nextTick(this.emit.bind(this,e,t))}createScanStream(e,{key:t,options:r={}}){return new h.default({objectMode:true,key:t,redis:this,command:e,...r})}flushQueue(e,t){t=(0,m.defaults)({},t,{offlineQueue:true,commandQueue:true});let r;if(t.offlineQueue){while(r=this.offlineQueue.shift()){r.command.reject(e)}}if(t.commandQueue){if(this.commandQueue.length>0){if(this.stream){this.stream.removeAllListeners("data")}while(r=this.commandQueue.shift()){r.command.reject(e)}}}}_readyCheck(e){const t=this;this.info((function(r,s){if(r){if(r.message&&r.message.includes("NOPERM")){console.warn(`Skipping the ready check because INFO command fails: "${r.message}". You can disable ready check with "enableReadyCheck". More: https://github.com/luin/ioredis/wiki/Disable-ready-check.`);return e(null,{})}return e(r)}if(typeof s!=="string"){return e(null,s)}const n={};const o=s.split("\r\n");for(let e=0;e<o.length;++e){const[t,...r]=o[e].split(":");const s=r.join(":");if(s){n[t]=s}}if(!n.loading||n.loading==="0"){e(null,n)}else{const r=(n.loading_eta_seconds||1)*1e3;const s=t.options.maxLoadingRetryTime&&t.options.maxLoadingRetryTime<r?t.options.maxLoadingRetryTime:r;S("Redis server still loading, trying again in "+s+"ms");setTimeout((function(){t._readyCheck(e)}),s)}})).catch(m.noop)}}Redis.Cluster=i.default;Redis.Command=a.default;Redis.defaultOptions=f.DEFAULT_REDIS_OPTIONS;(0,y.default)(Redis,n.EventEmitter);(0,d.addTransactionSupport)(Redis.prototype);t["default"]=Redis},6443:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const s=r(2203);class ScanStream extends s.Readable{constructor(e){super(e);this.opt=e;this._redisCursor="0";this._redisDrained=false}_read(){if(this._redisDrained){this.push(null);return}const e=[this._redisCursor];if(this.opt.key){e.unshift(this.opt.key)}if(this.opt.match){e.push("MATCH",this.opt.match)}if(this.opt.type){e.push("TYPE",this.opt.type)}if(this.opt.count){e.push("COUNT",String(this.opt.count))}if(this.opt.noValues){e.push("NOVALUES")}this.opt.redis[this.opt.command](e,((e,t)=>{if(e){this.emit("error",e);return}this._redisCursor=t[0]instanceof Buffer?t[0].toString():t[0];if(this._redisCursor==="0"){this._redisDrained=true}this.push(t[1])}))}close(){this._redisDrained=true}}t["default"]=ScanStream},6833:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const s=r(6982);const n=r(5017);const o=r(5659);class Script{constructor(e,t=null,r="",o=false){this.lua=e;this.numberOfKeys=t;this.keyPrefix=r;this.readOnly=o;this.sha=(0,s.createHash)("sha1").update(e).digest("hex");const i=this.sha;const a=new WeakSet;this.Command=class CustomScriptCommand extends n.default{toWritable(t){const r=this.reject;this.reject=e=>{if(e.message.indexOf("NOSCRIPT")!==-1){a.delete(t)}r.call(this,e)};if(!a.has(t)){a.add(t);this.name="eval";this.args[0]=e}else if(this.name==="eval"){this.name="evalsha";this.args[0]=i}return super.toWritable(t)}}}execute(e,t,r,s){if(typeof this.numberOfKeys==="number"){t.unshift(this.numberOfKeys)}if(this.keyPrefix){r.keyPrefix=this.keyPrefix}if(this.readOnly){r.readOnly=true}const n=new this.Command("evalsha",[this.sha,...t],r);n.promise=n.promise.catch((s=>{if(s.message.indexOf("NOSCRIPT")===-1){throw s}const n=new this.Command("evalsha",[this.sha,...t],r);const o=e.isPipeline?e.redis:e;return o.sendCommand(n)}));(0,o.default)(n.promise,s);return e.sendCommand(n)}}t["default"]=Script},2183:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});class SubscriptionSet{constructor(){this.set={subscribe:{},psubscribe:{},ssubscribe:{}}}add(e,t){this.set[mapSet(e)][t]=true}del(e,t){delete this.set[mapSet(e)][t]}channels(e){return Object.keys(this.set[mapSet(e)])}isEmpty(){return this.channels("subscribe").length===0&&this.channels("psubscribe").length===0&&this.channels("ssubscribe").length===0}}t["default"]=SubscriptionSet;function mapSet(e){if(e==="unsubscribe"){return"subscribe"}if(e==="punsubscribe"){return"psubscribe"}if(e==="sunsubscribe"){return"ssubscribe"}return e}},8596:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.executeWithAutoPipelining=t.getFirstValueInFlattenedArray=t.shouldUseAutoPipelining=t.notAllowedAutoPipelineCommands=t.kCallbacks=t.kExec=void 0;const s=r(7274);const n=r(8999);const o=r(5659);t.kExec=Symbol("exec");t.kCallbacks=Symbol("callbacks");t.notAllowedAutoPipelineCommands=["auth","info","script","quit","cluster","pipeline","multi","subscribe","psubscribe","unsubscribe","unpsubscribe","select"];function executeAutoPipeline(e,r){if(e._runningAutoPipelines.has(r)){return}if(!e._autoPipelines.has(r)){return}e._runningAutoPipelines.add(r);const s=e._autoPipelines.get(r);e._autoPipelines.delete(r);const n=s[t.kCallbacks];s[t.kCallbacks]=null;s.exec((function(t,s){e._runningAutoPipelines.delete(r);if(t){for(let e=0;e<n.length;e++){process.nextTick(n[e],t)}}else{for(let e=0;e<n.length;e++){process.nextTick(n[e],...s[e])}}if(e._autoPipelines.has(r)){executeAutoPipeline(e,r)}}))}function shouldUseAutoPipelining(e,r,s){return r&&e.options.enableAutoPipelining&&!e.isPipeline&&!t.notAllowedAutoPipelineCommands.includes(s)&&!e.options.autoPipeliningIgnoredCommands.includes(s)}t.shouldUseAutoPipelining=shouldUseAutoPipelining;function getFirstValueInFlattenedArray(e){for(let t=0;t<e.length;t++){const r=e[t];if(typeof r==="string"){return r}else if(Array.isArray(r)||(0,s.isArguments)(r)){if(r.length===0){continue}return r[0]}const n=[r].flat();if(n.length>0){return n[0]}}return undefined}t.getFirstValueInFlattenedArray=getFirstValueInFlattenedArray;function executeWithAutoPipelining(e,r,i,a,c){if(e.isCluster&&!e.slots.length){if(e.status==="wait")e.connect().catch(s.noop);return(0,o.default)(new Promise((function(t,s){e.delayUntilReady((n=>{if(n){s(n);return}executeWithAutoPipelining(e,r,i,a,null).then(t,s)}))})),c)}const l=e.options.keyPrefix||"";const u=e.isCluster?e.slots[n(`${l}${getFirstValueInFlattenedArray(a)}`)].join(","):"main";if(!e._autoPipelines.has(u)){const r=e.pipeline();r[t.kExec]=false;r[t.kCallbacks]=[];e._autoPipelines.set(u,r)}const f=e._autoPipelines.get(u);if(!f[t.kExec]){f[t.kExec]=true;setImmediate(executeAutoPipeline,e,u)}const h=new Promise((function(e,s){f[t.kCallbacks].push((function(t,r){if(t){s(t);return}e(r)}));if(r==="call"){a.unshift(i)}f[r](...a)}));return(0,o.default)(h,c)}t.executeWithAutoPipelining=executeWithAutoPipelining},1885:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DEFAULT_CLUSTER_OPTIONS=void 0;const s=r(2250);t.DEFAULT_CLUSTER_OPTIONS={clusterRetryStrategy:e=>Math.min(100+e*2,2e3),enableOfflineQueue:true,enableReadyCheck:true,scaleReads:"master",maxRedirections:16,retryDelayOnMoved:0,retryDelayOnFailover:100,retryDelayOnClusterDown:100,retryDelayOnTryAgain:100,slotsRefreshTimeout:1e3,useSRVRecords:false,resolveSrv:s.resolveSrv,dnsLookup:s.lookup,enableAutoPipelining:false,autoPipeliningIgnoredCommands:[],shardedSubscribers:false}},8093:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const s=r(6617);const n=r(7670);const o=r(5695);const i=(0,n.Debug)("cluster:subscriber");class ClusterSubscriber{constructor(e,t,r=false){this.connectionPool=e;this.emitter=t;this.isSharded=r;this.started=false;this.subscriber=null;this.slotRange=[];this.onSubscriberEnd=()=>{if(!this.started){i("subscriber has disconnected, but ClusterSubscriber is not started, so not reconnecting.");return}i("subscriber has disconnected, selecting a new one...");this.selectSubscriber()};this.connectionPool.on("-node",((e,t)=>{if(!this.started||!this.subscriber){return}if((0,s.getNodeKey)(this.subscriber.options)===t){i("subscriber has left, selecting a new one...");this.selectSubscriber()}}));this.connectionPool.on("+node",(()=>{if(!this.started||this.subscriber){return}i("a new node is discovered and there is no subscriber, selecting a new one...");this.selectSubscriber()}))}getInstance(){return this.subscriber}associateSlotRange(e){if(this.isSharded){this.slotRange=e}return this.slotRange}start(){this.started=true;this.selectSubscriber();i("started")}stop(){this.started=false;if(this.subscriber){this.subscriber.disconnect();this.subscriber=null}}isStarted(){return this.started}selectSubscriber(){const e=this.lastActiveSubscriber;if(e){e.off("end",this.onSubscriberEnd);e.disconnect()}if(this.subscriber){this.subscriber.off("end",this.onSubscriberEnd);this.subscriber.disconnect()}const t=(0,n.sample)(this.connectionPool.getNodes());if(!t){i("selecting subscriber failed since there is no node discovered in the cluster yet");this.subscriber=null;return}const{options:r}=t;i("selected a subscriber %s:%s",r.host,r.port);let a="subscriber";if(this.isSharded)a="ssubscriber";this.subscriber=new o.default({port:r.port,host:r.host,username:r.username,password:r.password,enableReadyCheck:true,connectionName:(0,s.getConnectionName)(a,r.connectionName),lazyConnect:true,tls:r.tls,retryStrategy:null});this.subscriber.on("error",n.noop);this.subscriber.once("end",this.onSubscriberEnd);const c={subscribe:[],psubscribe:[],ssubscribe:[]};if(e){const t=e.condition||e.prevCondition;if(t&&t.subscriber){c.subscribe=t.subscriber.channels("subscribe");c.psubscribe=t.subscriber.channels("psubscribe");c.ssubscribe=t.subscriber.channels("ssubscribe")}}if(c.subscribe.length||c.psubscribe.length||c.ssubscribe.length){let e=0;for(const t of["subscribe","psubscribe","ssubscribe"]){const r=c[t];if(r.length){e+=1;i("%s %d channels",t,r.length);this.subscriber[t](r).then((()=>{if(! --e){this.lastActiveSubscriber=this.subscriber}})).catch((()=>{i("failed to %s %d channels",t,r.length)}))}}}else{this.lastActiveSubscriber=this.subscriber}for(const e of["message","messageBuffer"]){this.subscriber.on(e,((t,r)=>{this.emitter.emit(e,t,r)}))}for(const e of["pmessage","pmessageBuffer"]){this.subscriber.on(e,((t,r,s)=>{this.emitter.emit(e,t,r,s)}))}if(this.isSharded==true){for(const e of["smessage","smessageBuffer"]){this.subscriber.on(e,((t,r)=>{this.emitter.emit(e,t,r)}))}}}}t["default"]=ClusterSubscriber},5870:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const s=r(7670);const n=r(8093);const o=r(9107);const i=r(6617);const a=r(8999);const c=(0,s.Debug)("cluster:subscriberGroup");class ClusterSubscriberGroup{constructor(e){this.cluster=e;this.shardedSubscribers=new Map;this.clusterSlots=[];this.subscriberToSlotsIndex=new Map;this.channels=new Map;e.on("+node",(e=>{this._addSubscriber(e)}));e.on("-node",(e=>{this._removeSubscriber(e)}));e.on("refresh",(()=>{this._refreshSlots(e)}))}getResponsibleSubscriber(e){const t=this.clusterSlots[e][0];return this.shardedSubscribers.get(t)}addChannels(e){const t=a(e[0]);e.forEach((e=>{if(a(e)!=t)return-1}));const r=this.channels.get(t);if(!r){this.channels.set(t,e)}else{this.channels.set(t,r.concat(e))}return[...this.channels.values()].flatMap((e=>e)).length}removeChannels(e){const t=a(e[0]);e.forEach((e=>{if(a(e)!=t)return-1}));const r=this.channels.get(t);if(r){const s=r.filter((t=>!e.includes(t)));this.channels.set(t,s)}return[...this.channels.values()].flatMap((e=>e)).length}stop(){for(const e of this.shardedSubscribers.values()){e.stop()}}start(){for(const e of this.shardedSubscribers.values()){if(!e.isStarted()){e.start()}}}_addSubscriber(e){const t=new o.default(e.options);if(t.addMasterNode(e)){const r=new n.default(t,this.cluster,true);const s=(0,i.getNodeKey)(e.options);this.shardedSubscribers.set(s,r);r.start();this._resubscribe();this.cluster.emit("+subscriber");return r}return null}_removeSubscriber(e){const t=(0,i.getNodeKey)(e.options);const r=this.shardedSubscribers.get(t);if(r){r.stop();this.shardedSubscribers.delete(t);this._resubscribe();this.cluster.emit("-subscriber")}return this.shardedSubscribers}_refreshSlots(e){if(this._slotsAreEqual(e.slots)){c("Nothing to refresh because the new cluster map is equal to the previous one.")}else{c("Refreshing the slots of the subscriber group.");this.subscriberToSlotsIndex=new Map;for(let t=0;t<e.slots.length;t++){const r=e.slots[t][0];if(!this.subscriberToSlotsIndex.has(r)){this.subscriberToSlotsIndex.set(r,[])}this.subscriberToSlotsIndex.get(r).push(Number(t))}this._resubscribe();this.clusterSlots=JSON.parse(JSON.stringify(e.slots));this.cluster.emit("subscribersReady");return true}return false}_resubscribe(){if(this.shardedSubscribers){this.shardedSubscribers.forEach(((e,t)=>{const r=this.subscriberToSlotsIndex.get(t);if(r){e.associateSlotRange(r);r.forEach((t=>{const r=e.getInstance();const s=this.channels.get(t);if(s&&s.length>0){if(r){r.ssubscribe(s);r.on("ready",(()=>{r.ssubscribe(s)}))}}}))}}))}}_slotsAreEqual(e){if(this.clusterSlots===undefined)return false;else return JSON.stringify(this.clusterSlots)===JSON.stringify(e)}}t["default"]=ClusterSubscriberGroup},9107:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const s=r(4434);const n=r(7670);const o=r(6617);const i=r(5695);const a=(0,n.Debug)("cluster:connectionPool");class ConnectionPool extends s.EventEmitter{constructor(e){super();this.redisOptions=e;this.nodes={all:{},master:{},slave:{}};this.specifiedOptions={}}getNodes(e="all"){const t=this.nodes[e];return Object.keys(t).map((e=>t[e]))}getInstanceByKey(e){return this.nodes.all[e]}getSampleInstance(e){const t=Object.keys(this.nodes[e]);const r=(0,n.sample)(t);return this.nodes[e][r]}addMasterNode(e){const t=(0,o.getNodeKey)(e.options);const r=this.createRedisFromOptions(e,e.options.readOnly);if(!e.options.readOnly){this.nodes.all[t]=r;this.nodes.master[t]=r;return true}return false}createRedisFromOptions(e,t){const r=new i.default((0,n.defaults)({retryStrategy:null,enableOfflineQueue:true,readOnly:t},e,this.redisOptions,{lazyConnect:true}));return r}findOrCreate(e,t=false){const r=(0,o.getNodeKey)(e);t=Boolean(t);if(this.specifiedOptions[r]){Object.assign(e,this.specifiedOptions[r])}else{this.specifiedOptions[r]=e}let s;if(this.nodes.all[r]){s=this.nodes.all[r];if(s.options.readOnly!==t){s.options.readOnly=t;a("Change role of %s to %s",r,t?"slave":"master");s[t?"readonly":"readwrite"]().catch(n.noop);if(t){delete this.nodes.master[r];this.nodes.slave[r]=s}else{delete this.nodes.slave[r];this.nodes.master[r]=s}}}else{a("Connecting to %s as %s",r,t?"slave":"master");s=this.createRedisFromOptions(e,t);this.nodes.all[r]=s;this.nodes[t?"slave":"master"][r]=s;s.once("end",(()=>{this.removeNode(r);this.emit("-node",s,r);if(!Object.keys(this.nodes.all).length){this.emit("drain")}}));this.emit("+node",s,r);s.on("error",(function(e){this.emit("nodeError",e,r)}))}return s}reset(e){a("Reset with %O",e);const t={};e.forEach((e=>{const r=(0,o.getNodeKey)(e);if(!(e.readOnly&&t[r])){t[r]=e}}));Object.keys(this.nodes.all).forEach((e=>{if(!t[e]){a("Disconnect %s because the node does not hold any slot",e);this.nodes.all[e].disconnect();this.removeNode(e)}}));Object.keys(t).forEach((e=>{const r=t[e];this.findOrCreate(r,r.readOnly)}))}removeNode(e){const{nodes:t}=this;if(t.all[e]){a("Remove %s from the pool",e);delete t.all[e]}delete t.master[e];delete t.slave[e]}}t["default"]=ConnectionPool},3455:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const s=r(7670);const n=r(9036);const o=(0,s.Debug)("delayqueue");class DelayQueue{constructor(){this.queues={};this.timeouts={}}push(e,t,r){const s=r.callback||process.nextTick;if(!this.queues[e]){this.queues[e]=new n}const o=this.queues[e];o.push(t);if(!this.timeouts[e]){this.timeouts[e]=setTimeout((()=>{s((()=>{this.timeouts[e]=null;this.execute(e)}))}),r.timeout)}}execute(e){const t=this.queues[e];if(!t){return}const{length:r}=t;if(!r){return}o("send %d commands in %s queue",r,e);this.queues[e]=null;while(t.length>0){t.shift()()}}}t["default"]=DelayQueue},1633:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const s=r(4317);const n=r(4434);const o=r(6961);const i=r(5659);const a=r(5017);const c=r(1784);const l=r(5695);const u=r(6443);const f=r(5708);const h=r(7670);const d=r(6985);const p=r(3240);const y=r(1885);const g=r(8093);const m=r(9107);const b=r(3455);const S=r(6617);const v=r(9036);const k=r(5870);const w=(0,h.Debug)("cluster");const E=new WeakSet;class Cluster extends p.default{constructor(e,t={}){super();this.slots=[];this._groupsIds={};this._groupsBySlot=Array(16384);this.isCluster=true;this.retryAttempts=0;this.delayQueue=new b.default;this.offlineQueue=new v;this.isRefreshing=false;this._refreshSlotsCacheCallbacks=[];this._autoPipelines=new Map;this._runningAutoPipelines=new Set;this._readyDelayedCallbacks=[];this.connectionEpoch=0;n.EventEmitter.call(this);this.startupNodes=e;this.options=(0,h.defaults)({},t,y.DEFAULT_CLUSTER_OPTIONS,this.options);if(this.options.shardedSubscribers==true)this.shardedSubscribers=new k.default(this);if(this.options.redisOptions&&this.options.redisOptions.keyPrefix&&!this.options.keyPrefix){this.options.keyPrefix=this.options.redisOptions.keyPrefix}if(typeof this.options.scaleReads!=="function"&&["all","master","slave"].indexOf(this.options.scaleReads)===-1){throw new Error('Invalid option scaleReads "'+this.options.scaleReads+'". Expected "all", "master", "slave" or a custom function')}this.connectionPool=new m.default(this.options.redisOptions);this.connectionPool.on("-node",((e,t)=>{this.emit("-node",e)}));this.connectionPool.on("+node",(e=>{this.emit("+node",e)}));this.connectionPool.on("drain",(()=>{this.setStatus("close")}));this.connectionPool.on("nodeError",((e,t)=>{this.emit("node error",e,t)}));this.subscriber=new g.default(this.connectionPool,this);if(this.options.scripts){Object.entries(this.options.scripts).forEach((([e,t])=>{this.defineCommand(e,t)}))}if(this.options.lazyConnect){this.setStatus("wait")}else{this.connect().catch((e=>{w("connecting failed: %s",e)}))}}connect(){return new Promise(((e,t)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){t(new Error("Redis is already connecting/connected"));return}const r=++this.connectionEpoch;this.setStatus("connecting");this.resolveStartupNodeHostnames().then((s=>{if(this.connectionEpoch!==r){w("discard connecting after resolving startup nodes because epoch not match: %d != %d",r,this.connectionEpoch);t(new o.RedisError("Connection is discarded because a new connection is made"));return}if(this.status!=="connecting"){w("discard connecting after resolving startup nodes because the status changed to %s",this.status);t(new o.RedisError("Connection is aborted"));return}this.connectionPool.reset(s);const readyHandler=()=>{this.setStatus("ready");this.retryAttempts=0;this.executeOfflineCommands();this.resetNodesRefreshInterval();e()};let n=undefined;const refreshListener=()=>{this.invokeReadyDelayedCallbacks(undefined);this.removeListener("close",n);this.manuallyClosing=false;this.setStatus("connect");if(this.options.enableReadyCheck){this.readyCheck(((e,t)=>{if(e||t){w("Ready check failed (%s). Reconnecting...",e||t);if(this.status==="connect"){this.disconnect(true)}}else{readyHandler()}}))}else{readyHandler()}};n=()=>{const e=new Error("None of startup nodes is available");this.removeListener("refresh",refreshListener);this.invokeReadyDelayedCallbacks(e);t(e)};this.once("refresh",refreshListener);this.once("close",n);this.once("close",this.handleCloseEvent.bind(this));this.refreshSlotsCache((e=>{if(e&&e.message===c.default.defaultMessage){l.default.prototype.silentEmit.call(this,"error",e);this.connectionPool.reset([])}}));this.subscriber.start();if(this.options.shardedSubscribers){this.shardedSubscribers.start()}})).catch((e=>{this.setStatus("close");this.handleCloseEvent(e);this.invokeReadyDelayedCallbacks(e);t(e)}))}))}disconnect(e=false){const t=this.status;this.setStatus("disconnecting");if(!e){this.manuallyClosing=true}if(this.reconnectTimeout&&!e){clearTimeout(this.reconnectTimeout);this.reconnectTimeout=null;w("Canceled reconnecting attempts")}this.clearNodesRefreshInterval();this.subscriber.stop();if(this.options.shardedSubscribers){this.shardedSubscribers.stop()}if(t==="wait"){this.setStatus("close");this.handleCloseEvent()}else{this.connectionPool.reset([])}}quit(e){const t=this.status;this.setStatus("disconnecting");this.manuallyClosing=true;if(this.reconnectTimeout){clearTimeout(this.reconnectTimeout);this.reconnectTimeout=null}this.clearNodesRefreshInterval();this.subscriber.stop();if(this.options.shardedSubscribers){this.shardedSubscribers.stop()}if(t==="wait"){const t=(0,i.default)(Promise.resolve("OK"),e);setImmediate(function(){this.setStatus("close");this.handleCloseEvent()}.bind(this));return t}return(0,i.default)(Promise.all(this.nodes().map((e=>e.quit().catch((e=>{if(e.message===h.CONNECTION_CLOSED_ERROR_MSG){return"OK"}throw e}))))).then((()=>"OK")),e)}duplicate(e=[],t={}){const r=e.length>0?e:this.startupNodes.slice(0);const s=Object.assign({},this.options,t);return new Cluster(r,s)}nodes(e="all"){if(e!=="all"&&e!=="master"&&e!=="slave"){throw new Error('Invalid role "'+e+'". Expected "all", "master" or "slave"')}return this.connectionPool.getNodes(e)}delayUntilReady(e){this._readyDelayedCallbacks.push(e)}get autoPipelineQueueSize(){let e=0;for(const t of this._autoPipelines.values()){e+=t.length}return e}refreshSlotsCache(e){if(e){this._refreshSlotsCacheCallbacks.push(e)}if(this.isRefreshing){return}this.isRefreshing=true;const t=this;const wrapper=e=>{this.isRefreshing=false;for(const t of this._refreshSlotsCacheCallbacks){t(e)}this._refreshSlotsCacheCallbacks=[]};const r=(0,h.shuffle)(this.connectionPool.getNodes());let s=null;function tryNode(e){if(e===r.length){const e=new c.default(c.default.defaultMessage,s);return wrapper(e)}const n=r[e];const o=`${n.options.host}:${n.options.port}`;w("getting slot cache from %s",o);t.getInfoFromNode(n,(function(r){switch(t.status){case"close":case"end":return wrapper(new Error("Cluster is disconnected."));case"disconnecting":return wrapper(new Error("Cluster is disconnecting."))}if(r){t.emit("node error",r,o);s=r;tryNode(e+1)}else{t.emit("refresh");wrapper()}}))}tryNode(0)}sendCommand(e,t,r){if(this.status==="wait"){this.connect().catch(h.noop)}if(this.status==="end"){e.reject(new Error(h.CONNECTION_CLOSED_ERROR_MSG));return e.promise}let n=this.options.scaleReads;if(n!=="master"){const t=e.isReadOnly||(0,s.exists)(e.name)&&(0,s.hasFlag)(e.name,"readonly");if(!t){n="master"}}let i=r?r.slot:e.getSlot();const c={};const l=this;if(!r&&!E.has(e)){E.add(e);const t=e.reject;e.reject=function(r){const s=tryConnection.bind(null,true);l.handleError(r,c,{moved:function(t,r){w("command %s is moved to %s",e.name,r);i=Number(t);if(l.slots[t]){l.slots[t][0]=r}else{l.slots[t]=[r]}l._groupsBySlot[t]=l._groupsIds[l.slots[t].join(";")];l.connectionPool.findOrCreate(l.natMapper(r));tryConnection();w("refreshing slot caches... (triggered by MOVED error)");l.refreshSlotsCache()},ask:function(t,r){w("command %s is required to ask %s:%s",e.name,r);const s=l.natMapper(r);l.connectionPool.findOrCreate(s);tryConnection(false,`${s.host}:${s.port}`)},tryagain:s,clusterDown:s,connectionClosed:s,maxRedirections:function(r){t.call(e,r)},defaults:function(){t.call(e,r)}})}}tryConnection();function tryConnection(s,c){if(l.status==="end"){e.reject(new o.AbortError("Cluster is ended."));return}let u;if(l.status==="ready"||e.name==="cluster"){if(r&&r.redis){u=r.redis}else if(a.default.checkFlag("ENTER_SUBSCRIBER_MODE",e.name)||a.default.checkFlag("EXIT_SUBSCRIBER_MODE",e.name)){if(l.options.shardedSubscribers==true&&(e.name=="ssubscribe"||e.name=="sunsubscribe")){const t=l.shardedSubscribers.getResponsibleSubscriber(i);let r=-1;if(e.name=="ssubscribe")r=l.shardedSubscribers.addChannels(e.getKeys());if(e.name=="sunsubscribe")r=l.shardedSubscribers.removeChannels(e.getKeys());if(r!==-1){u=t.getInstance()}else{e.reject(new o.AbortError("Can't add or remove the given channels. Are they in the same slot?"))}}else{u=l.subscriber.getInstance()}if(!u){e.reject(new o.AbortError("No subscriber for the cluster"));return}}else{if(!s){if(typeof i==="number"&&l.slots[i]){const t=l.slots[i];if(typeof n==="function"){const r=t.map((function(e){return l.connectionPool.getInstanceByKey(e)}));u=n(r,e);if(Array.isArray(u)){u=(0,h.sample)(u)}if(!u){u=r[0]}}else{let e;if(n==="all"){e=(0,h.sample)(t)}else if(n==="slave"&&t.length>1){e=(0,h.sample)(t,1)}else{e=t[0]}u=l.connectionPool.getInstanceByKey(e)}}if(c){u=l.connectionPool.getInstanceByKey(c);u.asking()}}if(!u){u=(typeof n==="function"?null:l.connectionPool.getSampleInstance(n))||l.connectionPool.getSampleInstance("all")}}if(r&&!r.redis){r.redis=u}}if(u){u.sendCommand(e,t)}else if(l.options.enableOfflineQueue){l.offlineQueue.push({command:e,stream:t,node:r})}else{e.reject(new Error("Cluster isn't ready and enableOfflineQueue options is false"))}}return e.promise}sscanStream(e,t){return this.createScanStream("sscan",{key:e,options:t})}sscanBufferStream(e,t){return this.createScanStream("sscanBuffer",{key:e,options:t})}hscanStream(e,t){return this.createScanStream("hscan",{key:e,options:t})}hscanBufferStream(e,t){return this.createScanStream("hscanBuffer",{key:e,options:t})}zscanStream(e,t){return this.createScanStream("zscan",{key:e,options:t})}zscanBufferStream(e,t){return this.createScanStream("zscanBuffer",{key:e,options:t})}handleError(e,t,r){if(typeof t.value==="undefined"){t.value=this.options.maxRedirections}else{t.value-=1}if(t.value<=0){r.maxRedirections(new Error("Too many Cluster redirections. Last error: "+e));return}const s=e.message.split(" ");if(s[0]==="MOVED"){const e=this.options.retryDelayOnMoved;if(e&&typeof e==="number"){this.delayQueue.push("moved",r.moved.bind(null,s[1],s[2]),{timeout:e})}else{r.moved(s[1],s[2])}}else if(s[0]==="ASK"){r.ask(s[1],s[2])}else if(s[0]==="TRYAGAIN"){this.delayQueue.push("tryagain",r.tryagain,{timeout:this.options.retryDelayOnTryAgain})}else if(s[0]==="CLUSTERDOWN"&&this.options.retryDelayOnClusterDown>0){this.delayQueue.push("clusterdown",r.connectionClosed,{timeout:this.options.retryDelayOnClusterDown,callback:this.refreshSlotsCache.bind(this)})}else if(e.message===h.CONNECTION_CLOSED_ERROR_MSG&&this.options.retryDelayOnFailover>0&&this.status==="ready"){this.delayQueue.push("failover",r.connectionClosed,{timeout:this.options.retryDelayOnFailover,callback:this.refreshSlotsCache.bind(this)})}else{r.defaults()}}resetOfflineQueue(){this.offlineQueue=new v}clearNodesRefreshInterval(){if(this.slotsTimer){clearTimeout(this.slotsTimer);this.slotsTimer=null}}resetNodesRefreshInterval(){if(this.slotsTimer||!this.options.slotsRefreshInterval){return}const nextRound=()=>{this.slotsTimer=setTimeout((()=>{w('refreshing slot caches... (triggered by "slotsRefreshInterval" option)');this.refreshSlotsCache((()=>{nextRound()}))}),this.options.slotsRefreshInterval)};nextRound()}setStatus(e){w("status: %s -> %s",this.status||"[empty]",e);this.status=e;process.nextTick((()=>{this.emit(e)}))}handleCloseEvent(e){if(e){w("closed because %s",e)}let t;if(!this.manuallyClosing&&typeof this.options.clusterRetryStrategy==="function"){t=this.options.clusterRetryStrategy.call(this,++this.retryAttempts,e)}if(typeof t==="number"){this.setStatus("reconnecting");this.reconnectTimeout=setTimeout((()=>{this.reconnectTimeout=null;w("Cluster is disconnected. Retrying after %dms",t);this.connect().catch((function(e){w("Got error %s when reconnecting. Ignoring...",e)}))}),t)}else{this.setStatus("end");this.flushQueue(new Error("None of startup nodes is available"))}}flushQueue(e){let t;while(t=this.offlineQueue.shift()){t.command.reject(e)}}executeOfflineCommands(){if(this.offlineQueue.length){w("send %d commands in offline queue",this.offlineQueue.length);const e=this.offlineQueue;this.resetOfflineQueue();let t;while(t=e.shift()){this.sendCommand(t.command,t.stream,t.node)}}}natMapper(e){const t=typeof e==="string"?e:`${e.host}:${e.port}`;let r=null;if(this.options.natMap&&typeof this.options.natMap==="function"){r=this.options.natMap(t)}else if(this.options.natMap&&typeof this.options.natMap==="object"){r=this.options.natMap[t]}if(r){w("NAT mapping %s -> %O",t,r);return Object.assign({},r)}return typeof e==="string"?(0,S.nodeKeyToRedisOptions)(e):e}getInfoFromNode(e,t){if(!e){return t(new Error("Node is disconnected"))}const r=e.duplicate({enableOfflineQueue:true,enableReadyCheck:false,retryStrategy:null,connectionName:(0,S.getConnectionName)("refresher",this.options.redisOptions&&this.options.redisOptions.connectionName)});r.on("error",h.noop);r.cluster("SLOTS",(0,h.timeout)(((e,s)=>{r.disconnect();if(e){w("error encountered running CLUSTER.SLOTS: %s",e);return t(e)}if(this.status==="disconnecting"||this.status==="close"||this.status==="end"){w("ignore CLUSTER.SLOTS results (count: %d) since cluster status is %s",s.length,this.status);t();return}const n=[];w("cluster slots result count: %d",s.length);for(let e=0;e<s.length;++e){const t=s[e];const r=t[0];const o=t[1];const i=[];for(let e=2;e<t.length;e++){if(!t[e][0]){continue}const r=this.natMapper({host:t[e][0],port:t[e][1]});r.readOnly=e!==2;n.push(r);i.push(r.host+":"+r.port)}w("cluster slots result [%d]: slots %d~%d served by %s",e,r,o,i);for(let e=r;e<=o;e++){this.slots[e]=i}}this._groupsIds=Object.create(null);let o=0;for(let e=0;e<16384;e++){const t=(this.slots[e]||[]).join(";");if(!t.length){this._groupsBySlot[e]=undefined;continue}if(!this._groupsIds[t]){this._groupsIds[t]=++o}this._groupsBySlot[e]=this._groupsIds[t]}this.connectionPool.reset(n);t()}),this.options.slotsRefreshTimeout))}invokeReadyDelayedCallbacks(e){for(const t of this._readyDelayedCallbacks){process.nextTick(t,e)}this._readyDelayedCallbacks=[]}readyCheck(e){this.cluster("INFO",((t,r)=>{if(t){return e(t)}if(typeof r!=="string"){return e()}let s;const n=r.split("\r\n");for(let e=0;e<n.length;++e){const t=n[e].split(":");if(t[0]==="cluster_state"){s=t[1];break}}if(s==="fail"){w("cluster state not ok (%s)",s);e(null,s)}else{e()}}))}resolveSrv(e){return new Promise(((t,r)=>{this.options.resolveSrv(e,((e,s)=>{if(e){return r(e)}const n=this,o=(0,S.groupSrvRecords)(s),i=Object.keys(o).sort(((e,t)=>parseInt(e)-parseInt(t)));function tryFirstOne(e){if(!i.length){return r(e)}const s=i[0],a=o[s],c=(0,S.weightSrvRecords)(a);if(!a.records.length){i.shift()}n.dnsLookup(c.name).then((e=>t({host:e,port:c.port})),tryFirstOne)}tryFirstOne()}))}))}dnsLookup(e){return new Promise(((t,r)=>{this.options.dnsLookup(e,((s,n)=>{if(s){w("failed to resolve hostname %s to IP: %s",e,s.message);r(s)}else{w("resolved hostname %s to IP %s",e,n);t(n)}}))}))}async resolveStartupNodeHostnames(){if(!Array.isArray(this.startupNodes)||this.startupNodes.length===0){throw new Error("`startupNodes` should contain at least one node.")}const e=(0,S.normalizeNodeOptions)(this.startupNodes);const t=(0,S.getUniqueHostnamesFromOptions)(e);if(t.length===0){return e}const r=await Promise.all(t.map((this.options.useSRVRecords?this.resolveSrv:this.dnsLookup).bind(this)));const s=(0,h.zipMap)(t,r);return e.map((e=>{const t=s.get(e.host);if(!t){return e}if(this.options.useSRVRecords){return Object.assign({},e,t)}return Object.assign({},e,{host:t})}))}createScanStream(e,{key:t,options:r={}}){return new u.default({objectMode:true,key:t,redis:this,command:e,...r})}}(0,d.default)(Cluster,n.EventEmitter);(0,f.addTransactionSupport)(Cluster.prototype);t["default"]=Cluster},6617:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getConnectionName=t.weightSrvRecords=t.groupSrvRecords=t.getUniqueHostnamesFromOptions=t.normalizeNodeOptions=t.nodeKeyToRedisOptions=t.getNodeKey=void 0;const s=r(7670);const n=r(9278);function getNodeKey(e){e.port=e.port||6379;e.host=e.host||"127.0.0.1";return e.host+":"+e.port}t.getNodeKey=getNodeKey;function nodeKeyToRedisOptions(e){const t=e.lastIndexOf(":");if(t===-1){throw new Error(`Invalid node key ${e}`)}return{host:e.slice(0,t),port:Number(e.slice(t+1))}}t.nodeKeyToRedisOptions=nodeKeyToRedisOptions;function normalizeNodeOptions(e){return e.map((e=>{const t={};if(typeof e==="object"){Object.assign(t,e)}else if(typeof e==="string"){Object.assign(t,(0,s.parseURL)(e))}else if(typeof e==="number"){t.port=e}else{throw new Error("Invalid argument "+e)}if(typeof t.port==="string"){t.port=parseInt(t.port,10)}delete t.db;if(!t.port){t.port=6379}if(!t.host){t.host="127.0.0.1"}return(0,s.resolveTLSProfile)(t)}))}t.normalizeNodeOptions=normalizeNodeOptions;function getUniqueHostnamesFromOptions(e){const t={};e.forEach((e=>{t[e.host]=true}));return Object.keys(t).filter((e=>!(0,n.isIP)(e)))}t.getUniqueHostnamesFromOptions=getUniqueHostnamesFromOptions;function groupSrvRecords(e){const t={};for(const r of e){if(!t.hasOwnProperty(r.priority)){t[r.priority]={totalWeight:r.weight,records:[r]}}else{t[r.priority].totalWeight+=r.weight;t[r.priority].records.push(r)}}return t}t.groupSrvRecords=groupSrvRecords;function weightSrvRecords(e){if(e.records.length===1){e.totalWeight=0;return e.records.shift()}const t=Math.floor(Math.random()*(e.totalWeight+e.records.length));let r=0;for(const[s,n]of e.records.entries()){r+=1+n.weight;if(r>t){e.totalWeight-=n.weight;e.records.splice(s,1);return n}}}t.weightSrvRecords=weightSrvRecords;function getConnectionName(e,t){const r=`ioredis-cluster(${e})`;return t?`${r}:${t}`:r}t.getConnectionName=getConnectionName},2348:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const s=r(7670);const n=(0,s.Debug)("AbstractConnector");class AbstractConnector{constructor(e){this.connecting=false;this.disconnectTimeout=e}check(e){return true}disconnect(){this.connecting=false;if(this.stream){const e=this.stream;const t=setTimeout((()=>{n("stream %s:%s still open, destroying it",e.remoteAddress,e.remotePort);e.destroy()}),this.disconnectTimeout);e.on("close",(()=>clearTimeout(t)));e.end()}}}t["default"]=AbstractConnector},4037:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FailoverDetector=void 0;const s=r(7670);const n=(0,s.Debug)("FailoverDetector");const o="+switch-master";class FailoverDetector{constructor(e,t){this.isDisconnected=false;this.connector=e;this.sentinels=t}cleanup(){this.isDisconnected=true;for(const e of this.sentinels){e.client.disconnect()}}async subscribe(){n("Starting FailoverDetector");const e=[];for(const t of this.sentinels){const r=t.client.subscribe(o).catch((e=>{n("Failed to subscribe to failover messages on sentinel %s:%s (%s)",t.address.host||"127.0.0.1",t.address.port||26739,e.message)}));e.push(r);t.client.on("message",(e=>{if(!this.isDisconnected&&e===o){this.disconnect()}}))}await Promise.all(e)}disconnect(){this.isDisconnected=true;n("Failover detected, disconnecting");this.connector.disconnect()}}t.FailoverDetector=FailoverDetector},3079:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});function isSentinelEql(e,t){return(e.host||"127.0.0.1")===(t.host||"127.0.0.1")&&(e.port||26379)===(t.port||26379)}class SentinelIterator{constructor(e){this.cursor=0;this.sentinels=e.slice(0)}next(){const e=this.cursor>=this.sentinels.length;return{done:e,value:e?undefined:this.sentinels[this.cursor++]}}reset(e){if(e&&this.sentinels.length>1&&this.cursor!==1){this.sentinels.unshift(...this.sentinels.splice(this.cursor-1))}this.cursor=0}add(e){for(let t=0;t<this.sentinels.length;t++){if(isSentinelEql(e,this.sentinels[t])){return false}}this.sentinels.push(e);return true}toString(){return`${JSON.stringify(this.sentinels)} @${this.cursor}`}}t["default"]=SentinelIterator},8325:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SentinelIterator=void 0;const s=r(9278);const n=r(7670);const o=r(4756);const i=r(3079);t.SentinelIterator=i.default;const a=r(2348);const c=r(5695);const l=r(4037);const u=(0,n.Debug)("SentinelConnector");class SentinelConnector extends a.default{constructor(e){super(e.disconnectTimeout);this.options=e;this.emitter=null;this.failoverDetector=null;if(!this.options.sentinels.length){throw new Error("Requires at least one sentinel to connect to.")}if(!this.options.name){throw new Error("Requires the name of master.")}this.sentinelIterator=new i.default(this.options.sentinels)}check(e){const t=!e.role||this.options.role===e.role;if(!t){u("role invalid, expected %s, but got %s",this.options.role,e.role);this.sentinelIterator.next();this.sentinelIterator.next();this.sentinelIterator.reset(true)}return t}disconnect(){super.disconnect();if(this.failoverDetector){this.failoverDetector.cleanup()}}connect(e){this.connecting=true;this.retryAttempts=0;let t;const connectToNext=async()=>{const r=this.sentinelIterator.next();if(r.done){this.sentinelIterator.reset(false);const r=typeof this.options.sentinelRetryStrategy==="function"?this.options.sentinelRetryStrategy(++this.retryAttempts):null;let s=typeof r!=="number"?"All sentinels are unreachable and retry is disabled.":`All sentinels are unreachable. Retrying from scratch after ${r}ms.`;if(t){s+=` Last error: ${t.message}`}u(s);const n=new Error(s);if(typeof r==="number"){e("error",n);await new Promise((e=>setTimeout(e,r)));return connectToNext()}else{throw n}}let i=null;let a=null;try{i=await this.resolve(r.value)}catch(e){a=e}if(!this.connecting){throw new Error(n.CONNECTION_CLOSED_ERROR_MSG)}const c=r.value.host+":"+r.value.port;if(i){u("resolved: %s:%s from sentinel %s",i.host,i.port,c);if(this.options.enableTLSForSentinelMode&&this.options.tls){Object.assign(i,this.options.tls);this.stream=(0,o.connect)(i);this.stream.once("secureConnect",this.initFailoverDetector.bind(this))}else{this.stream=(0,s.createConnection)(i);this.stream.once("connect",this.initFailoverDetector.bind(this))}this.stream.once("error",(e=>{this.firstError=e}));return this.stream}else{const r=a?"failed to connect to sentinel "+c+" because "+a.message:"connected to sentinel "+c+" successfully, but got an invalid reply: "+i;u(r);e("sentinelError",new Error(r));if(a){t=a}return connectToNext()}};return connectToNext()}async updateSentinels(e){if(!this.options.updateSentinels){return}const t=await e.sentinel("sentinels",this.options.name);if(!Array.isArray(t)){return}t.map(n.packObject).forEach((e=>{const t=e.flags?e.flags.split(","):[];if(t.indexOf("disconnected")===-1&&e.ip&&e.port){const t=this.sentinelNatResolve(addressResponseToAddress(e));if(this.sentinelIterator.add(t)){u("adding sentinel %s:%s",t.host,t.port)}}}));u("Updated internal sentinels: %s",this.sentinelIterator)}async resolveMaster(e){const t=await e.sentinel("get-master-addr-by-name",this.options.name);await this.updateSentinels(e);return this.sentinelNatResolve(Array.isArray(t)?{host:t[0],port:Number(t[1])}:null)}async resolveSlave(e){const t=await e.sentinel("slaves",this.options.name);if(!Array.isArray(t)){return null}const r=t.map(n.packObject).filter((e=>e.flags&&!e.flags.match(/(disconnected|s_down|o_down)/)));return this.sentinelNatResolve(selectPreferredSentinel(r,this.options.preferredSlaves))}sentinelNatResolve(e){if(!e||!this.options.natMap)return e;const t=`${e.host}:${e.port}`;let r=e;if(typeof this.options.natMap==="function"){r=this.options.natMap(t)||e}else if(typeof this.options.natMap==="object"){r=this.options.natMap[t]||e}return r}connectToSentinel(e,t){const r=new c.default({port:e.port||26379,host:e.host,username:this.options.sentinelUsername||null,password:this.options.sentinelPassword||null,family:e.family||("path"in this.options&&this.options.path?undefined:this.options.family),tls:this.options.sentinelTLS,retryStrategy:null,enableReadyCheck:false,connectTimeout:this.options.connectTimeout,commandTimeout:this.options.sentinelCommandTimeout,...t});return r}async resolve(e){const t=this.connectToSentinel(e);t.on("error",noop);try{if(this.options.role==="slave"){return await this.resolveSlave(t)}else{return await this.resolveMaster(t)}}finally{t.disconnect()}}async initFailoverDetector(){var e;if(!this.options.failoverDetector){return}this.sentinelIterator.reset(true);const t=[];while(t.length<this.options.sentinelMaxConnections){const{done:e,value:r}=this.sentinelIterator.next();if(e){break}const s=this.connectToSentinel(r,{lazyConnect:true,retryStrategy:this.options.sentinelReconnectStrategy});s.on("reconnecting",(()=>{var e;(e=this.emitter)===null||e===void 0?void 0:e.emit("sentinelReconnecting")}));t.push({address:r,client:s})}this.sentinelIterator.reset(false);if(this.failoverDetector){this.failoverDetector.cleanup()}this.failoverDetector=new l.FailoverDetector(this,t);await this.failoverDetector.subscribe();(e=this.emitter)===null||e===void 0?void 0:e.emit("failoverSubscribed")}}t["default"]=SentinelConnector;function selectPreferredSentinel(e,t){if(e.length===0){return null}let r;if(typeof t==="function"){r=t(e)}else if(t!==null&&typeof t==="object"){const s=Array.isArray(t)?t:[t];s.sort(((e,t)=>{if(!e.prio){e.prio=1}if(!t.prio){t.prio=1}if(e.prio<t.prio){return-1}if(e.prio>t.prio){return 1}return 0}));for(let t=0;t<s.length;t++){for(let n=0;n<e.length;n++){const o=e[n];if(o.ip===s[t].ip){if(o.port===s[t].port){r=o;break}}}if(r){break}}}if(!r){r=(0,n.sample)(e)}return addressResponseToAddress(r)}function addressResponseToAddress(e){return{host:e.ip,port:Number(e.port)}}function noop(){}},6359:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const s=r(9278);const n=r(4756);const o=r(7670);const i=r(2348);class StandaloneConnector extends i.default{constructor(e){super(e.disconnectTimeout);this.options=e}connect(e){const{options:t}=this;this.connecting=true;let r;if("path"in t&&t.path){r={path:t.path}}else{r={};if("port"in t&&t.port!=null){r.port=t.port}if("host"in t&&t.host!=null){r.host=t.host}if("family"in t&&t.family!=null){r.family=t.family}}if(t.tls){Object.assign(r,t.tls)}return new Promise(((e,i)=>{process.nextTick((()=>{if(!this.connecting){i(new Error(o.CONNECTION_CLOSED_ERROR_MSG));return}try{if(t.tls){this.stream=(0,n.connect)(r)}else{this.stream=(0,s.createConnection)(r)}}catch(e){i(e);return}this.stream.once("error",(e=>{this.firstError=e}));e(this.stream)}))}))}}t["default"]=StandaloneConnector},8053:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SentinelConnector=t.StandaloneConnector=void 0;const s=r(6359);t.StandaloneConnector=s.default;const n=r(8325);t.SentinelConnector=n.default},4981:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const r=`-----BEGIN CERTIFICATE-----\nMIIDTzCCAjegAwIBAgIJAKSVpiDswLcwMA0GCSqGSIb3DQEBBQUAMD4xFjAUBgNV\nBAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1\ndGhvcml0eTAeFw0xMzEwMDExMjE0NTVaFw0yMzA5MjkxMjE0NTVaMD4xFjAUBgNV\nBAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1\ndGhvcml0eTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALZqkh/DczWP\nJnxnHLQ7QL0T4B4CDKWBKCcisriGbA6ZePWVNo4hfKQC6JrzfR+081NeD6VcWUiz\nrmd+jtPhIY4c+WVQYm5PKaN6DT1imYdxQw7aqO5j2KUCEh/cznpLxeSHoTxlR34E\nQwF28Wl3eg2vc5ct8LjU3eozWVk3gb7alx9mSA2SgmuX5lEQawl++rSjsBStemY2\nBDwOpAMXIrdEyP/cVn8mkvi/BDs5M5G+09j0gfhyCzRWMQ7Hn71u1eolRxwVxgi3\nTMn+/vTaFSqxKjgck6zuAYjBRPaHe7qLxHNr1So/Mc9nPy+3wHebFwbIcnUojwbp\n4nctkWbjb2cCAwEAAaNQME4wHQYDVR0OBBYEFP1whtcrydmW3ZJeuSoKZIKjze3w\nMB8GA1UdIwQYMBaAFP1whtcrydmW3ZJeuSoKZIKjze3wMAwGA1UdEwQFMAMBAf8w\nDQYJKoZIhvcNAQEFBQADggEBAG2erXhwRAa7+ZOBs0B6X57Hwyd1R4kfmXcs0rta\nlbPpvgULSiB+TCbf3EbhJnHGyvdCY1tvlffLjdA7HJ0PCOn+YYLBA0pTU/dyvrN6\nSu8NuS5yubnt9mb13nDGYo1rnt0YRfxN+8DM3fXIVr038A30UlPX2Ou1ExFJT0MZ\nuFKY6ZvLdI6/1cbgmguMlAhM+DhKyV6Sr5699LM3zqeI816pZmlREETYkGr91q7k\nBpXJu/dtHaGxg1ZGu6w/PCsYGUcECWENYD4VQPd8N32JjOfu6vEgoEAwfPP+3oGp\nZ4m3ewACcWOAenqflb+cQYC4PsF7qbXDmRaWrbKntOlZ3n0=\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIGMTCCBBmgAwIBAgICEAAwDQYJKoZIhvcNAQELBQAwajELMAkGA1UEBhMCVVMx\nCzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJzMS0w\nKwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHhcN\nMTgwMjI1MTUzNzM3WhcNMjgwMjIzMTUzNzM3WjBfMQswCQYDVQQGEwJVUzELMAkG\nA1UECAwCQ0ExEjAQBgNVBAoMCVJlZGlzTGFiczEvMC0GA1UEAwwmUkNQIEludGVy\nbWVkaWF0ZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwggIiMA0GCSqGSIb3DQEBAQUA\nA4ICDwAwggIKAoICAQDf9dqbxc8Bq7Ctq9rWcxrGNKKHivqLAFpPq02yLPx6fsOv\nTq7GsDChAYBBc4v7Y2Ap9RD5Vs3dIhEANcnolf27QwrG9RMnnvzk8pCvp1o6zSU4\nVuOE1W66/O1/7e2rVxyrnTcP7UgK43zNIXu7+tiAqWsO92uSnuMoGPGpeaUm1jym\nhjWKtkAwDFSqvHY+XL5qDVBEjeUe+WHkYUg40cAXjusAqgm2hZt29c2wnVrxW25W\nP0meNlzHGFdA2AC5z54iRiqj57dTfBTkHoBczQxcyw6hhzxZQ4e5I5zOKjXXEhZN\nr0tA3YC14CTabKRus/JmZieyZzRgEy2oti64tmLYTqSlAD78pRL40VNoaSYetXLw\nhhNsXCHgWaY6d5bLOc/aIQMAV5oLvZQKvuXAF1IDmhPA+bZbpWipp0zagf1P1H3s\nUzsMdn2KM0ejzgotbtNlj5TcrVwpmvE3ktvUAuA+hi3FkVx1US+2Gsp5x4YOzJ7u\nP1WPk6ShF0JgnJH2ILdj6kttTWwFzH17keSFICWDfH/+kM+k7Y1v3EXMQXE7y0T9\nMjvJskz6d/nv+sQhY04xt64xFMGTnZjlJMzfQNi7zWFLTZnDD0lPowq7l3YiPoTT\nt5Xky83lu0KZsZBo0WlWaDG00gLVdtRgVbcuSWxpi5BdLb1kRab66JptWjxwXQID\nAQABo4HrMIHoMDoGA1UdHwQzMDEwL6AtoCuGKWh0dHBzOi8vcmwtY2Etc2VydmVy\nLnJlZGlzbGFicy5jb20vdjEvY3JsMEYGCCsGAQUFBwEBBDowODA2BggrBgEFBQcw\nAYYqaHR0cHM6Ly9ybC1jYS1zZXJ2ZXIucmVkaXNsYWJzLmNvbS92MS9vY3NwMB0G\nA1UdDgQWBBQHar5OKvQUpP2qWt6mckzToeCOHDAfBgNVHSMEGDAWgBQi42wH6hM4\nL2sujEvLM0/u8lRXTzASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIB\nhjANBgkqhkiG9w0BAQsFAAOCAgEAirEn/iTsAKyhd+pu2W3Z5NjCko4NPU0EYUbr\nAP7+POK2rzjIrJO3nFYQ/LLuC7KCXG+2qwan2SAOGmqWst13Y+WHp44Kae0kaChW\nvcYLXXSoGQGC8QuFSNUdaeg3RbMDYFT04dOkqufeWVccoHVxyTSg9eD8LZuHn5jw\n7QDLiEECBmIJHk5Eeo2TAZrx4Yx6ufSUX5HeVjlAzqwtAqdt99uCJ/EL8bgpWbe+\nXoSpvUv0SEC1I1dCAhCKAvRlIOA6VBcmzg5Am12KzkqTul12/VEFIgzqu0Zy2Jbc\nAUPrYVu/+tOGXQaijy7YgwH8P8n3s7ZeUa1VABJHcxrxYduDDJBLZi+MjheUDaZ1\njQRHYevI2tlqeSBqdPKG4zBY5lS0GiAlmuze5oENt0P3XboHoZPHiqcK3VECgTVh\n/BkJcuudETSJcZDmQ8YfoKfBzRQNg2sv/hwvUv73Ss51Sco8GEt2lD8uEdib1Q6z\nzDT5lXJowSzOD5ZA9OGDjnSRL+2riNtKWKEqvtEG3VBJoBzu9GoxbAc7wIZLxmli\niF5a/Zf5X+UXD3s4TMmy6C4QZJpAA2egsSQCnraWO2ULhh7iXMysSkF/nzVfZn43\niqpaB8++9a37hWq14ZmOv0TJIDz//b2+KC4VFXWQ5W5QC6whsjT+OlG4p5ZYG0jo\n616pxqo=\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIFujCCA6KgAwIBAgIJAJ1aTT1lu2ScMA0GCSqGSIb3DQEBCwUAMGoxCzAJBgNV\nBAYTAlVTMQswCQYDVQQIDAJDQTELMAkGA1UEBwwCQ0ExEjAQBgNVBAoMCVJlZGlz\nTGFiczEtMCsGA1UEAwwkUmVkaXNMYWJzIFJvb3QgQ2VydGlmaWNhdGUgQXV0aG9y\naXR5MB4XDTE4MDIyNTE1MjA0MloXDTM4MDIyMDE1MjA0MlowajELMAkGA1UEBhMC\nVVMxCzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJz\nMS0wKwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkw\nggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDLEjXy7YrbN5Waau5cd6g1\nG5C2tMmeTpZ0duFAPxNU4oE3RHS5gGiok346fUXuUxbZ6QkuzeN2/2Z+RmRcJhQY\nDm0ZgdG4x59An1TJfnzKKoWj8ISmoHS/TGNBdFzXV7FYNLBuqZouqePI6ReC6Qhl\npp45huV32Q3a6IDrrvx7Wo5ZczEQeFNbCeCOQYNDdTmCyEkHqc2AGo8eoIlSTutT\nULOC7R5gzJVTS0e1hesQ7jmqHjbO+VQS1NAL4/5K6cuTEqUl+XhVhPdLWBXJQ5ag\n54qhX4v+ojLzeU1R/Vc6NjMvVtptWY6JihpgplprN0Yh2556ewcXMeturcKgXfGJ\nxeYzsjzXerEjrVocX5V8BNrg64NlifzTMKNOOv4fVZszq1SIHR8F9ROrqiOdh8iC\nJpUbLpXH9hWCSEO6VRMB2xJoKu3cgl63kF30s77x7wLFMEHiwsQRKxooE1UhgS9K\n2sO4TlQ1eWUvFvHSTVDQDlGQ6zu4qjbOpb3Q8bQwoK+ai2alkXVR4Ltxe9QlgYK3\nStsnPhruzZGA0wbXdpw0bnM+YdlEm5ffSTpNIfgHeaa7Dtb801FtA71ZlH7A6TaI\nSIQuUST9EKmv7xrJyx0W1pGoPOLw5T029aTjnICSLdtV9bLwysrLhIYG5bnPq78B\ncS+jZHFGzD7PUVGQD01nOQIDAQABo2MwYTAdBgNVHQ4EFgQUIuNsB+oTOC9rLoxL\nyzNP7vJUV08wHwYDVR0jBBgwFoAUIuNsB+oTOC9rLoxLyzNP7vJUV08wDwYDVR0T\nAQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAYYwDQYJKoZIhvcNAQELBQADggIBAHfg\nz5pMNUAKdMzK1aS1EDdK9yKz4qicILz5czSLj1mC7HKDRy8cVADUxEICis++CsCu\nrYOvyCVergHQLREcxPq4rc5Nq1uj6J6649NEeh4WazOOjL4ZfQ1jVznMbGy+fJm3\n3Hoelv6jWRG9iqeJZja7/1s6YC6bWymI/OY1e4wUKeNHAo+Vger7MlHV+RuabaX+\nhSJ8bJAM59NCM7AgMTQpJCncrcdLeceYniGy5Q/qt2b5mJkQVkIdy4TPGGB+AXDJ\nD0q3I/JDRkDUFNFdeW0js7fHdsvCR7O3tJy5zIgEV/o/BCkmJVtuwPYOrw/yOlKj\nTY/U7ATAx9VFF6/vYEOMYSmrZlFX+98L6nJtwDqfLB5VTltqZ4H/KBxGE3IRSt9l\nFXy40U+LnXzhhW+7VBAvyYX8GEXhHkKU8Gqk1xitrqfBXY74xKgyUSTolFSfFVgj\nmcM/X4K45bka+qpkj7Kfv/8D4j6aZekwhN2ly6hhC1SmQ8qjMjpG/mrWOSSHZFmf\nybu9iD2AYHeIOkshIl6xYIa++Q/00/vs46IzAbQyriOi0XxlSMMVtPx0Q3isp+ji\nn8Mq9eOuxYOEQ4of8twUkUDd528iwGtEdwf0Q01UyT84S62N8AySl1ZBKXJz6W4F\nUhWfa/HQYOAPDdEjNgnVwLI23b8t0TozyCWw7q8h\n-----END CERTIFICATE-----\n\n-----BEGIN CERTIFICATE-----\nMIIEjzCCA3egAwIBAgIQe55B/ALCKJDZtdNT8kD6hTANBgkqhkiG9w0BAQsFADBM\nMSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEGA1UEChMKR2xv\nYmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjAeFw0yMjAxMjYxMjAwMDBaFw0y\nNTAxMjYwMDAwMDBaMFgxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWdu\nIG52LXNhMS4wLAYDVQQDEyVHbG9iYWxTaWduIEF0bGFzIFIzIE9WIFRMUyBDQSAy\nMDIyIFEyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmGmg1LW9b7Lf\n8zDD83yBDTEkt+FOxKJZqF4veWc5KZsQj9HfnUS2e5nj/E+JImlGPsQuoiosLuXD\nBVBNAMcUFa11buFMGMeEMwiTmCXoXRrXQmH0qjpOfKgYc5gHG3BsRGaRrf7VR4eg\nofNMG9wUBw4/g/TT7+bQJdA4NfE7Y4d5gEryZiBGB/swaX6Jp/8MF4TgUmOWmalK\ndZCKyb4sPGQFRTtElk67F7vU+wdGcrcOx1tDcIB0ncjLPMnaFicagl+daWGsKqTh\ncounQb6QJtYHa91KvCfKWocMxQ7OIbB5UARLPmC4CJ1/f8YFm35ebfzAeULYdGXu\njE9CLor0OwIDAQABo4IBXzCCAVswDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQG\nCCsGAQUFBwMBBggrBgEFBQcDAjASBgNVHRMBAf8ECDAGAQH/AgEAMB0GA1UdDgQW\nBBSH5Zq7a7B/t95GfJWkDBpA8HHqdjAfBgNVHSMEGDAWgBSP8Et/qC5FJK5NUPpj\nmove4t0bvDB7BggrBgEFBQcBAQRvMG0wLgYIKwYBBQUHMAGGImh0dHA6Ly9vY3Nw\nMi5nbG9iYWxzaWduLmNvbS9yb290cjMwOwYIKwYBBQUHMAKGL2h0dHA6Ly9zZWN1\ncmUuZ2xvYmFsc2lnbi5jb20vY2FjZXJ0L3Jvb3QtcjMuY3J0MDYGA1UdHwQvMC0w\nK6ApoCeGJWh0dHA6Ly9jcmwuZ2xvYmFsc2lnbi5jb20vcm9vdC1yMy5jcmwwIQYD\nVR0gBBowGDAIBgZngQwBAgIwDAYKKwYBBAGgMgoBAjANBgkqhkiG9w0BAQsFAAOC\nAQEAKRic9/f+nmhQU/wz04APZLjgG5OgsuUOyUEZjKVhNGDwxGTvKhyXGGAMW2B/\n3bRi+aElpXwoxu3pL6fkElbX3B0BeS5LoDtxkyiVEBMZ8m+sXbocwlPyxrPbX6mY\n0rVIvnuUeBH8X0L5IwfpNVvKnBIilTbcebfHyXkPezGwz7E1yhUULjJFm2bt0SdX\ny+4X/WeiiYIv+fTVgZZgl+/2MKIsu/qdBJc3f3TvJ8nz+Eax1zgZmww+RSQWeOj3\n15Iw6Z5FX+NwzY/Ab+9PosR5UosSeq+9HhtaxZttXG1nVh+avYPGYddWmiMT90J5\nZgKnO/Fx2hBgTxhOTMYaD312kg==\n-----END CERTIFICATE-----\n\n-----BEGIN CERTIFICATE-----\nMIIDXzCCAkegAwIBAgILBAAAAAABIVhTCKIwDQYJKoZIhvcNAQELBQAwTDEgMB4G\nA1UECxMXR2xvYmFsU2lnbiBSb290IENBIC0gUjMxEzARBgNVBAoTCkdsb2JhbFNp\nZ24xEzARBgNVBAMTCkdsb2JhbFNpZ24wHhcNMDkwMzE4MTAwMDAwWhcNMjkwMzE4\nMTAwMDAwWjBMMSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEG\nA1UEChMKR2xvYmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjCCASIwDQYJKoZI\nhvcNAQEBBQADggEPADCCAQoCggEBAMwldpB5BngiFvXAg7aEyiie/QV2EcWtiHL8\nRgJDx7KKnQRfJMsuS+FggkbhUqsMgUdwbN1k0ev1LKMPgj0MK66X17YUhhB5uzsT\ngHeMCOFJ0mpiLx9e+pZo34knlTifBtc+ycsmWQ1z3rDI6SYOgxXG71uL0gRgykmm\nKPZpO/bLyCiR5Z2KYVc3rHQU3HTgOu5yLy6c+9C7v/U9AOEGM+iCK65TpjoWc4zd\nQQ4gOsC0p6Hpsk+QLjJg6VfLuQSSaGjlOCZgdbKfd/+RFO+uIEn8rUAVSNECMWEZ\nXriX7613t2Saer9fwRPvm2L7DWzgVGkWqQPabumDk3F2xmmFghcCAwEAAaNCMEAw\nDgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFI/wS3+o\nLkUkrk1Q+mOai97i3Ru8MA0GCSqGSIb3DQEBCwUAA4IBAQBLQNvAUKr+yAzv95ZU\nRUm7lgAJQayzE4aGKAczymvmdLm6AC2upArT9fHxD4q/c2dKg8dEe3jgr25sbwMp\njjM5RcOO5LlXbKr8EpbsU8Yt5CRsuZRj+9xTaGdWPoO4zzUhw8lo/s7awlOqzJCK\n6fBdRoyV3XpYKBovHd7NADdBj+1EbddTKJd+82cEHhXXipa0095MJ6RMG3NzdvQX\nmcIfeg7jLQitChws/zyrVQ4PkX4268NXSb7hLi18YIvDQVETI53O9zJrlAGomecs\nMx86OyXShkDOOyyGeMlhLxS67ttVb9+E7gUJTb0o2HLO02JQZR7rkpeDMdmztcpH\nWD9f\n-----END CERTIFICATE-----`;const s={RedisCloudFixed:{ca:r},RedisCloudFlexible:{ca:r}};t["default"]=s},1784:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const s=r(6961);class ClusterAllFailedError extends s.RedisError{constructor(e,t){super(e);this.lastNodeError=t;Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}}t["default"]=ClusterAllFailedError;ClusterAllFailedError.defaultMessage="Failed to refresh slots cache."},9256:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const s=r(6961);class MaxRetriesPerRequestError extends s.AbortError{constructor(e){const t=`Reached the max retries per request limit (which is ${e}). Refer to "maxRetriesPerRequest" option for details.`;super(t);Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}}t["default"]=MaxRetriesPerRequestError},4926:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MaxRetriesPerRequestError=void 0;const s=r(9256);t.MaxRetriesPerRequestError=s.default},7796:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.print=t.ReplyError=t.SentinelIterator=t.SentinelConnector=t.AbstractConnector=t.Pipeline=t.ScanStream=t.Command=t.Cluster=t.Redis=t["default"]=void 0;t=e.exports=r(5695)["default"];var s=r(5695);Object.defineProperty(t,"default",{enumerable:true,get:function(){return s.default}});var n=r(5695);Object.defineProperty(t,"Redis",{enumerable:true,get:function(){return n.default}});var o=r(1633);Object.defineProperty(t,"Cluster",{enumerable:true,get:function(){return o.default}});var i=r(5017);Object.defineProperty(t,"Command",{enumerable:true,get:function(){return i.default}});var a=r(6443);Object.defineProperty(t,"ScanStream",{enumerable:true,get:function(){return a.default}});var c=r(8940);Object.defineProperty(t,"Pipeline",{enumerable:true,get:function(){return c.default}});var l=r(2348);Object.defineProperty(t,"AbstractConnector",{enumerable:true,get:function(){return l.default}});var u=r(8325);Object.defineProperty(t,"SentinelConnector",{enumerable:true,get:function(){return u.default}});Object.defineProperty(t,"SentinelIterator",{enumerable:true,get:function(){return u.SentinelIterator}});t.ReplyError=r(6961).ReplyError;Object.defineProperty(t,"Promise",{get(){console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used.");return Promise},set(e){console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used.")}});function print(e,t){if(e){console.log("Error: "+e)}else{console.log("Reply: "+t)}}t.print=print},7669:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DEFAULT_REDIS_OPTIONS=void 0;t.DEFAULT_REDIS_OPTIONS={port:6379,host:"localhost",family:4,connectTimeout:1e4,disconnectTimeout:2e3,retryStrategy:function(e){return Math.min(e*50,2e3)},keepAlive:0,noDelay:true,connectionName:null,sentinels:null,name:null,role:"master",sentinelRetryStrategy:function(e){return Math.min(e*10,1e3)},sentinelReconnectStrategy:function(){return 6e4},natMap:null,enableTLSForSentinelMode:false,updateSentinels:true,failoverDetector:false,username:null,password:null,db:0,enableOfflineQueue:true,enableReadyCheck:true,autoResubscribe:true,autoResendUnfulfilledCommands:true,lazyConnect:false,keyPrefix:"",reconnectOnError:null,readOnly:false,stringNumbers:false,maxRetriesPerRequest:20,maxLoadingRetryTime:1e4,enableAutoPipelining:false,autoPipeliningIgnoredCommands:[],sentinelMaxConnections:10}},1107:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.readyHandler=t.errorHandler=t.closeHandler=t.connectHandler=void 0;const s=r(6961);const n=r(5017);const o=r(4926);const i=r(7670);const a=r(4588);const c=(0,i.Debug)("connection");function connectHandler(e){return function(){e.setStatus("connect");e.resetCommandQueue();let r=false;const{connectionEpoch:s}=e;if(e.condition.auth){e.auth(e.condition.auth,(function(t){if(s!==e.connectionEpoch){return}if(t){if(t.message.indexOf("no password is set")!==-1){console.warn("[WARN] Redis server does not require a password, but a password was supplied.")}else if(t.message.indexOf("without any password configured for the default user")!==-1){console.warn("[WARN] This Redis server's `default` user does not require a password, but a password was supplied")}else if(t.message.indexOf("wrong number of arguments for 'auth' command")!==-1){console.warn(`[ERROR] The server returned "wrong number of arguments for 'auth' command". You are probably passing both username and password to Redis version 5 or below. You should only pass the 'password' option for Redis version 5 and under.`)}else{r=true;e.recoverFromFatalError(t,t)}}}))}if(e.condition.select){e.select(e.condition.select).catch((t=>{e.silentEmit("error",t)}))}if(!e.options.enableReadyCheck){t.readyHandler(e)()}new a.default(e,{stringNumbers:e.options.stringNumbers});if(e.options.enableReadyCheck){e._readyCheck((function(n,o){if(s!==e.connectionEpoch){return}if(n){if(!r){e.recoverFromFatalError(new Error("Ready check failed: "+n.message),n)}}else{if(e.connector.check(o)){t.readyHandler(e)()}else{e.disconnect(true)}}}))}}}t.connectHandler=connectHandler;function abortError(e){const t=new s.AbortError("Command aborted due to connection close");t.command={name:e.name,args:e.args};return t}function abortIncompletePipelines(e){var t;let r=0;for(let s=0;s<e.length;){const n=(t=e.peekAt(s))===null||t===void 0?void 0:t.command;const o=n.pipelineIndex;if(o===undefined||o===0){r=0}if(o!==undefined&&o!==r++){e.remove(s,1);n.reject(abortError(n));continue}s++}}function abortTransactionFragments(e){var t;for(let r=0;r<e.length;){const s=(t=e.peekAt(r))===null||t===void 0?void 0:t.command;if(s.name==="multi"){break}if(s.name==="exec"){e.remove(r,1);s.reject(abortError(s));break}if(s.inTransaction){e.remove(r,1);s.reject(abortError(s))}else{r++}}}function closeHandler(e){return function(){const t=e.status;e.setStatus("close");if(e.commandQueue.length){abortIncompletePipelines(e.commandQueue)}if(e.offlineQueue.length){abortTransactionFragments(e.offlineQueue)}if(t==="ready"){if(!e.prevCondition){e.prevCondition=e.condition}if(e.commandQueue.length){e.prevCommandQueue=e.commandQueue}}if(e.manuallyClosing){e.manuallyClosing=false;c("skip reconnecting since the connection is manually closed.");return close()}if(typeof e.options.retryStrategy!=="function"){c("skip reconnecting because `retryStrategy` is not a function");return close()}const r=e.options.retryStrategy(++e.retryAttempts);if(typeof r!=="number"){c("skip reconnecting because `retryStrategy` doesn't return a number");return close()}c("reconnect in %sms",r);e.setStatus("reconnecting",r);e.reconnectTimeout=setTimeout((function(){e.reconnectTimeout=null;e.connect().catch(i.noop)}),r);const{maxRetriesPerRequest:s}=e.options;if(typeof s==="number"){if(s<0){c("maxRetriesPerRequest is negative, ignoring...")}else{const t=e.retryAttempts%(s+1);if(t===0){c("reach maxRetriesPerRequest limitation, flushing command queue...");e.flushQueue(new o.MaxRetriesPerRequestError(s))}}}};function close(){e.setStatus("end");e.flushQueue(new Error(i.CONNECTION_CLOSED_ERROR_MSG))}}t.closeHandler=closeHandler;function errorHandler(e){return function(t){c("error: %s",t);e.silentEmit("error",t)}}t.errorHandler=errorHandler;function readyHandler(e){return function(){e.setStatus("ready");e.retryAttempts=0;if(e.options.monitor){e.call("monitor").then((()=>e.setStatus("monitoring")),(t=>e.emit("error",t)));const{sendCommand:t}=e;e.sendCommand=function(r){if(n.default.checkFlag("VALID_IN_MONITOR_MODE",r.name)){return t.call(e,r)}r.reject(new Error("Connection is in monitoring mode, can't process commands."));return r.promise};e.once("close",(function(){delete e.sendCommand}));return}const t=e.prevCondition?e.prevCondition.select:e.condition.select;if(e.options.connectionName){c("set the connection name [%s]",e.options.connectionName);e.client("setname",e.options.connectionName).catch(i.noop)}if(e.options.readOnly){c("set the connection to readonly mode");e.readonly().catch(i.noop)}if(e.prevCondition){const r=e.prevCondition;e.prevCondition=null;if(r.subscriber&&e.options.autoResubscribe){if(e.condition.select!==t){c("connect to db [%d]",t);e.select(t)}const s=r.subscriber.channels("subscribe");if(s.length){c("subscribe %d channels",s.length);e.subscribe(s)}const n=r.subscriber.channels("psubscribe");if(n.length){c("psubscribe %d channels",n.length);e.psubscribe(n)}const o=r.subscriber.channels("ssubscribe");if(o.length){c("ssubscribe %d channels",o.length);e.ssubscribe(o)}}}if(e.prevCommandQueue){if(e.options.autoResendUnfulfilledCommands){c("resend %d unfulfilled commands",e.prevCommandQueue.length);while(e.prevCommandQueue.length>0){const t=e.prevCommandQueue.shift();if(t.select!==e.condition.select&&t.command.name!=="select"){e.select(t.select)}e.sendCommand(t.command,t.stream)}}else{e.prevCommandQueue=null}}if(e.offlineQueue.length){c("send %d commands in offline queue",e.offlineQueue.length);const t=e.offlineQueue;e.resetOfflineQueue();while(t.length>0){const r=t.shift();if(r.select!==e.condition.select&&r.command.name!=="select"){e.select(r.select)}e.sendCommand(r.command,r.stream)}}if(e.condition.select!==t){c("connect to db [%d]",t);e.select(t)}}}t.readyHandler=readyHandler},5708:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.addTransactionSupport=void 0;const s=r(7670);const n=r(5659);const o=r(8940);function addTransactionSupport(e){e.pipeline=function(e){const t=new o.default(this);if(Array.isArray(e)){t.addBatch(e)}return t};const{multi:t}=e;e.multi=function(e,r){if(typeof r==="undefined"&&!Array.isArray(e)){r=e;e=null}if(r&&r.pipeline===false){return t.call(this)}const i=new o.default(this);i.multi();if(Array.isArray(e)){i.addBatch(e)}const a=i.exec;i.exec=function(e){if(this.isCluster&&!this.redis.slots.length){if(this.redis.status==="wait")this.redis.connect().catch(s.noop);return(0,n.default)(new Promise(((e,t)=>{this.redis.delayUntilReady((r=>{if(r){t(r);return}this.exec(i).then(e,t)}))})),e)}if(this._transactions>0){a.call(i)}if(this.nodeifiedPromise){return a.call(i)}const t=a.call(i);return(0,n.default)(t.then((function(e){const t=e[e.length-1];if(typeof t==="undefined"){throw new Error("Pipeline cannot be used to send any commands when the `exec()` has been called on it.")}if(t[0]){t[0].previousErrors=[];for(let r=0;r<e.length-1;++r){if(e[r][0]){t[0].previousErrors.push(e[r][0])}}throw t[0]}return(0,s.wrapMultiResult)(t[1])})),e)};const{execBuffer:c}=i;i.execBuffer=function(e){if(this._transactions>0){c.call(i)}return i.exec(e)};return i};const{exec:r}=e;e.exec=function(e){return(0,n.default)(r.call(this).then((function(e){if(Array.isArray(e)){e=(0,s.wrapMultiResult)(e)}return e})),e)}}t.addTransactionSupport=addTransactionSupport},3240:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const s=r(4317);const n=r(8596);const o=r(5017);const i=r(6833);class Commander{constructor(){this.options={};this.scriptsSet={};this.addedBuiltinSet=new Set}getBuiltinCommands(){return a.slice(0)}createBuiltinCommand(e){return{string:generateFunction(null,e,"utf8"),buffer:generateFunction(null,e,null)}}addBuiltinCommand(e){this.addedBuiltinSet.add(e);this[e]=generateFunction(e,e,"utf8");this[e+"Buffer"]=generateFunction(e+"Buffer",e,null)}defineCommand(e,t){const r=new i.default(t.lua,t.numberOfKeys,this.options.keyPrefix,t.readOnly);this.scriptsSet[e]=r;this[e]=generateScriptingFunction(e,e,r,"utf8");this[e+"Buffer"]=generateScriptingFunction(e+"Buffer",e,r,null)}sendCommand(e,t,r){throw new Error('"sendCommand" is not implemented')}}const a=s.list.filter((e=>e!=="monitor"));a.push("sentinel");a.forEach((function(e){Commander.prototype[e]=generateFunction(e,e,"utf8");Commander.prototype[e+"Buffer"]=generateFunction(e+"Buffer",e,null)}));Commander.prototype.call=generateFunction("call","utf8");Commander.prototype.callBuffer=generateFunction("callBuffer",null);Commander.prototype.send_command=Commander.prototype.call;function generateFunction(e,t,r){if(typeof r==="undefined"){r=t;t=null}return function(...s){const i=t||s.shift();let a=s[s.length-1];if(typeof a==="function"){s.pop()}else{a=undefined}const c={errorStack:this.options.showFriendlyErrorStack?new Error:undefined,keyPrefix:this.options.keyPrefix,replyEncoding:r};if(!(0,n.shouldUseAutoPipelining)(this,e,i)){return this.sendCommand(new o.default(i,s,c,a))}return(0,n.executeWithAutoPipelining)(this,e,i,s,a)}}function generateScriptingFunction(e,t,r,s){return function(...o){const i=typeof o[o.length-1]==="function"?o.pop():undefined;const a={replyEncoding:s};if(this.options.showFriendlyErrorStack){a.errorStack=new Error}if(!(0,n.shouldUseAutoPipelining)(this,e,t)){return r.execute(this,o,a,i)}return(0,n.executeWithAutoPipelining)(this,e,t,o,i)}}t["default"]=Commander},6985:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});function applyMixin(e,t){Object.getOwnPropertyNames(t.prototype).forEach((r=>{Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r))}))}t["default"]=applyMixin},7633:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.genRedactedString=t.getStringValue=t.MAX_ARGUMENT_LENGTH=void 0;const s=r(2830);const n=200;t.MAX_ARGUMENT_LENGTH=n;const o="ioredis";function getStringValue(e){if(e===null){return}switch(typeof e){case"boolean":return;case"number":return;case"object":if(Buffer.isBuffer(e)){return e.toString("hex")}if(Array.isArray(e)){return e.join(",")}try{return JSON.stringify(e)}catch(e){return}case"string":return e}}t.getStringValue=getStringValue;function genRedactedString(e,t){const{length:r}=e;return r<=t?e:e.slice(0,t)+' ... <REDACTED full-length="'+r+'">'}t.genRedactedString=genRedactedString;function genDebugFunction(e){const t=(0,s.default)(`${o}:${e}`);function wrappedDebug(...e){if(!t.enabled){return}for(let t=1;t<e.length;t++){const r=getStringValue(e[t]);if(typeof r==="string"&&r.length>n){e[t]=genRedactedString(r,n)}}return t.apply(null,e)}Object.defineProperties(wrappedDebug,{namespace:{get(){return t.namespace}},enabled:{get(){return t.enabled}},destroy:{get(){return t.destroy}},log:{get(){return t.log},set(e){t.log=e}}});return wrappedDebug}t["default"]=genDebugFunction},7670:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.noop=t.defaults=t.Debug=t.zipMap=t.CONNECTION_CLOSED_ERROR_MSG=t.shuffle=t.sample=t.resolveTLSProfile=t.parseURL=t.optimizeErrorStack=t.toArg=t.convertMapToArray=t.convertObjectToArray=t.timeout=t.packObject=t.isInt=t.wrapMultiResult=t.convertBufferToString=void 0;const s=r(7016);const n=r(7274);Object.defineProperty(t,"defaults",{enumerable:true,get:function(){return n.defaults}});Object.defineProperty(t,"noop",{enumerable:true,get:function(){return n.noop}});const o=r(7633);t.Debug=o.default;const i=r(4981);function convertBufferToString(e,t){if(e instanceof Buffer){return e.toString(t)}if(Array.isArray(e)){const r=e.length;const s=Array(r);for(let n=0;n<r;++n){s[n]=e[n]instanceof Buffer&&t==="utf8"?e[n].toString():convertBufferToString(e[n],t)}return s}return e}t.convertBufferToString=convertBufferToString;function wrapMultiResult(e){if(!e){return null}const t=[];const r=e.length;for(let s=0;s<r;++s){const r=e[s];if(r instanceof Error){t.push([r])}else{t.push([null,r])}}return t}t.wrapMultiResult=wrapMultiResult;function isInt(e){const t=parseFloat(e);return!isNaN(e)&&(t|0)===t}t.isInt=isInt;function packObject(e){const t={};const r=e.length;for(let s=1;s<r;s+=2){t[e[s-1]]=e[s]}return t}t.packObject=packObject;function timeout(e,t){let r=null;const run=function(){if(r){clearTimeout(r);r=null;e.apply(this,arguments)}};r=setTimeout(run,t,new Error("timeout"));return run}t.timeout=timeout;function convertObjectToArray(e){const t=[];const r=Object.keys(e);for(let s=0,n=r.length;s<n;s++){t.push(r[s],e[r[s]])}return t}t.convertObjectToArray=convertObjectToArray;function convertMapToArray(e){const t=[];let r=0;e.forEach((function(e,s){t[r]=s;t[r+1]=e;r+=2}));return t}t.convertMapToArray=convertMapToArray;function toArg(e){if(e===null||typeof e==="undefined"){return""}return String(e)}t.toArg=toArg;function optimizeErrorStack(e,t,r){const s=t.split("\n");let n="";let o;for(o=1;o<s.length;++o){if(s[o].indexOf(r)===-1){break}}for(let e=o;e<s.length;++e){n+="\n"+s[e]}if(e.stack){const t=e.stack.indexOf("\n");e.stack=e.stack.slice(0,t)+n}return e}t.optimizeErrorStack=optimizeErrorStack;function parseURL(e){if(isInt(e)){return{port:e}}let t=(0,s.parse)(e,true,true);if(!t.slashes&&e[0]!=="/"){e="//"+e;t=(0,s.parse)(e,true,true)}const r=t.query||{};const o={};if(t.auth){const e=t.auth.indexOf(":");o.username=e===-1?t.auth:t.auth.slice(0,e);o.password=e===-1?"":t.auth.slice(e+1)}if(t.pathname){if(t.protocol==="redis:"||t.protocol==="rediss:"){if(t.pathname.length>1){o.db=t.pathname.slice(1)}}else{o.path=t.pathname}}if(t.host){o.host=t.hostname}if(t.port){o.port=t.port}if(typeof r.family==="string"){const e=Number.parseInt(r.family,10);if(!Number.isNaN(e)){o.family=e}}(0,n.defaults)(o,r);return o}t.parseURL=parseURL;function resolveTLSProfile(e){let t=e===null||e===void 0?void 0:e.tls;if(typeof t==="string")t={profile:t};const r=i.default[t===null||t===void 0?void 0:t.profile];if(r){t=Object.assign({},r,t);delete t.profile;e=Object.assign({},e,{tls:t})}return e}t.resolveTLSProfile=resolveTLSProfile;function sample(e,t=0){const r=e.length;if(t>=r){return null}return e[t+Math.floor(Math.random()*(r-t))]}t.sample=sample;function shuffle(e){let t=e.length;while(t>0){const r=Math.floor(Math.random()*t);t--;[e[t],e[r]]=[e[r],e[t]]}return e}t.shuffle=shuffle;t.CONNECTION_CLOSED_ERROR_MSG="Connection is closed.";function zipMap(e,t){const r=new Map;e.forEach(((e,s)=>{r.set(e,t[s])}));return r}t.zipMap=zipMap},7274:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.isArguments=t.defaults=t.noop=void 0;const s=r(7623);t.defaults=s;const n=r(2191);t.isArguments=n;function noop(){}t.noop=noop},7623:e=>{var t=9007199254740991;var r="[object Arguments]",s="[object Function]",n="[object GeneratorFunction]";var o=/^(?:0|[1-9]\d*)$/;function apply(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function baseTimes(e,t){var r=-1,s=Array(e);while(++r<e){s[r]=t(r)}return s}var i=Object.prototype;var a=i.hasOwnProperty;var c=i.toString;var l=i.propertyIsEnumerable;var u=Math.max;function arrayLikeKeys(e,t){var r=f(e)||isArguments(e)?baseTimes(e.length,String):[];var s=r.length,n=!!s;for(var o in e){if((t||a.call(e,o))&&!(n&&(o=="length"||isIndex(o,s)))){r.push(o)}}return r}function assignInDefaults(e,t,r,s){if(e===undefined||eq(e,i[r])&&!a.call(s,r)){return t}return e}function assignValue(e,t,r){var s=e[t];if(!(a.call(e,t)&&eq(s,r))||r===undefined&&!(t in e)){e[t]=r}}function baseKeysIn(e){if(!isObject(e)){return nativeKeysIn(e)}var t=isPrototype(e),r=[];for(var s in e){if(!(s=="constructor"&&(t||!a.call(e,s)))){r.push(s)}}return r}function baseRest(e,t){t=u(t===undefined?e.length-1:t,0);return function(){var r=arguments,s=-1,n=u(r.length-t,0),o=Array(n);while(++s<n){o[s]=r[t+s]}s=-1;var i=Array(t+1);while(++s<t){i[s]=r[s]}i[t]=o;return apply(e,this,i)}}function copyObject(e,t,r,s){r||(r={});var n=-1,o=t.length;while(++n<o){var i=t[n];var a=s?s(r[i],e[i],i,r,e):undefined;assignValue(r,i,a===undefined?e[i]:a)}return r}function createAssigner(e){return baseRest((function(t,r){var s=-1,n=r.length,o=n>1?r[n-1]:undefined,i=n>2?r[2]:undefined;o=e.length>3&&typeof o=="function"?(n--,o):undefined;if(i&&isIterateeCall(r[0],r[1],i)){o=n<3?undefined:o;n=1}t=Object(t);while(++s<n){var a=r[s];if(a){e(t,a,s,o)}}return t}))}function isIndex(e,r){r=r==null?t:r;return!!r&&(typeof e=="number"||o.test(e))&&(e>-1&&e%1==0&&e<r)}function isIterateeCall(e,t,r){if(!isObject(r)){return false}var s=typeof t;if(s=="number"?isArrayLike(r)&&isIndex(t,r.length):s=="string"&&t in r){return eq(r[t],e)}return false}function isPrototype(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||i;return e===r}function nativeKeysIn(e){var t=[];if(e!=null){for(var r in Object(e)){t.push(r)}}return t}function eq(e,t){return e===t||e!==e&&t!==t}function isArguments(e){return isArrayLikeObject(e)&&a.call(e,"callee")&&(!l.call(e,"callee")||c.call(e)==r)}var f=Array.isArray;function isArrayLike(e){return e!=null&&isLength(e.length)&&!isFunction(e)}function isArrayLikeObject(e){return isObjectLike(e)&&isArrayLike(e)}function isFunction(e){var t=isObject(e)?c.call(e):"";return t==s||t==n}function isLength(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=t}function isObject(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function isObjectLike(e){return!!e&&typeof e=="object"}var h=createAssigner((function(e,t,r,s){copyObject(t,keysIn(t),e,s)}));var d=baseRest((function(e){e.push(undefined,assignInDefaults);return apply(h,undefined,e)}));function keysIn(e){return isArrayLike(e)?arrayLikeKeys(e,true):baseKeysIn(e)}e.exports=d},2191:e=>{var t=9007199254740991;var r="[object Arguments]",s="[object Function]",n="[object GeneratorFunction]";var o=Object.prototype;var i=o.hasOwnProperty;var a=o.toString;var c=o.propertyIsEnumerable;function isArguments(e){return isArrayLikeObject(e)&&i.call(e,"callee")&&(!c.call(e,"callee")||a.call(e)==r)}function isArrayLike(e){return e!=null&&isLength(e.length)&&!isFunction(e)}function isArrayLikeObject(e){return isObjectLike(e)&&isArrayLike(e)}function isFunction(e){var t=isObject(e)?a.call(e):"";return t==s||t==n}function isLength(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=t}function isObject(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function isObjectLike(e){return!!e&&typeof e=="object"}e.exports=isArguments},744:e=>{var t=1e3;var r=t*60;var s=r*60;var n=s*24;var o=n*7;var i=n*365.25;e.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0){return parse(e)}else if(r==="number"&&isFinite(e)){return t.long?fmtLong(e):fmtShort(e)}throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function parse(e){e=String(e);if(e.length>100){return}var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a){return}var c=parseFloat(a[1]);var l=(a[2]||"ms").toLowerCase();switch(l){case"years":case"year":case"yrs":case"yr":case"y":return c*i;case"weeks":case"week":case"w":return c*o;case"days":case"day":case"d":return c*n;case"hours":case"hour":case"hrs":case"hr":case"h":return c*s;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return undefined}}function fmtShort(e){var o=Math.abs(e);if(o>=n){return Math.round(e/n)+"d"}if(o>=s){return Math.round(e/s)+"h"}if(o>=r){return Math.round(e/r)+"m"}if(o>=t){return Math.round(e/t)+"s"}return e+"ms"}function fmtLong(e){var o=Math.abs(e);if(o>=n){return plural(e,o,n,"day")}if(o>=s){return plural(e,o,s,"hour")}if(o>=r){return plural(e,o,r,"minute")}if(o>=t){return plural(e,o,t,"second")}return e+" ms"}function plural(e,t,r,s){var n=t>=r*1.5;return Math.round(e/r)+" "+s+(n?"s":"")}},6961:(e,t,r)=>{"use strict";const s=process.version.charCodeAt(1)<55&&process.version.charCodeAt(2)===46?r(9236):r(5854);e.exports=s},5854:(e,t,r)=>{"use strict";const s=r(2613);class RedisError extends Error{get name(){return this.constructor.name}}class ParserError extends RedisError{constructor(e,t,r){s(t);s.strictEqual(typeof r,"number");const n=Error.stackTraceLimit;Error.stackTraceLimit=2;super(e);Error.stackTraceLimit=n;this.offset=r;this.buffer=t}get name(){return this.constructor.name}}class ReplyError extends RedisError{constructor(e){const t=Error.stackTraceLimit;Error.stackTraceLimit=2;super(e);Error.stackTraceLimit=t}get name(){return this.constructor.name}}class AbortError extends RedisError{get name(){return this.constructor.name}}class InterruptError extends AbortError{get name(){return this.constructor.name}}e.exports={RedisError:RedisError,ParserError:ParserError,ReplyError:ReplyError,AbortError:AbortError,InterruptError:InterruptError}},9236:(e,t,r)=>{"use strict";const s=r(2613);const n=r(9023);function RedisError(e){Object.defineProperty(this,"message",{value:e||"",configurable:true,writable:true});Error.captureStackTrace(this,this.constructor)}n.inherits(RedisError,Error);Object.defineProperty(RedisError.prototype,"name",{value:"RedisError",configurable:true,writable:true});function ParserError(e,t,r){s(t);s.strictEqual(typeof r,"number");Object.defineProperty(this,"message",{value:e||"",configurable:true,writable:true});const n=Error.stackTraceLimit;Error.stackTraceLimit=2;Error.captureStackTrace(this,this.constructor);Error.stackTraceLimit=n;this.offset=r;this.buffer=t}n.inherits(ParserError,RedisError);Object.defineProperty(ParserError.prototype,"name",{value:"ParserError",configurable:true,writable:true});function ReplyError(e){Object.defineProperty(this,"message",{value:e||"",configurable:true,writable:true});const t=Error.stackTraceLimit;Error.stackTraceLimit=2;Error.captureStackTrace(this,this.constructor);Error.stackTraceLimit=t}n.inherits(ReplyError,RedisError);Object.defineProperty(ReplyError.prototype,"name",{value:"ReplyError",configurable:true,writable:true});function AbortError(e){Object.defineProperty(this,"message",{value:e||"",configurable:true,writable:true});Error.captureStackTrace(this,this.constructor)}n.inherits(AbortError,RedisError);Object.defineProperty(AbortError.prototype,"name",{value:"AbortError",configurable:true,writable:true});function InterruptError(e){Object.defineProperty(this,"message",{value:e||"",configurable:true,writable:true});Error.captureStackTrace(this,this.constructor)}n.inherits(InterruptError,AbortError);Object.defineProperty(InterruptError.prototype,"name",{value:"InterruptError",configurable:true,writable:true});e.exports={RedisError:RedisError,ParserError:ParserError,ReplyError:ReplyError,AbortError:AbortError,InterruptError:InterruptError}},5665:(e,t,r)=>{"use strict";e.exports=r(2486)},2486:(e,t,r)=>{"use strict";const s=r(181).Buffer;const n=r(3193).StringDecoder;const o=new n;const i=r(6961);const a=i.ReplyError;const c=i.ParserError;var l=s.allocUnsafe(32*1024);var u=0;var f=null;var h=0;var d=0;function parseSimpleNumbers(e){const t=e.buffer.length-1;var r=e.offset;var s=0;var n=1;if(e.buffer[r]===45){n=-1;r++}while(r<t){const t=e.buffer[r++];if(t===13){e.offset=r+1;return n*s}s=s*10+(t-48)}}function parseStringNumbers(e){const t=e.buffer.length-1;var r=e.offset;var s=0;var n="";if(e.buffer[r]===45){n+="-";r++}while(r<t){var o=e.buffer[r++];if(o===13){e.offset=r+1;if(s!==0){n+=s}return n}else if(s>429496728){n+=s*10+(o-48);s=0}else if(o===48&&s===0){n+=0}else{s=s*10+(o-48)}}}function parseSimpleString(e){const t=e.offset;const r=e.buffer;const s=r.length-1;var n=t;while(n<s){if(r[n++]===13){e.offset=n+1;if(e.optionReturnBuffers===true){return e.buffer.slice(t,n-1)}return e.buffer.toString("utf8",t,n-1)}}}function parseLength(e){const t=e.buffer.length-1;var r=e.offset;var s=0;while(r<t){const t=e.buffer[r++];if(t===13){e.offset=r+1;return s}s=s*10+(t-48)}}function parseInteger(e){if(e.optionStringNumbers===true){return parseStringNumbers(e)}return parseSimpleNumbers(e)}function parseBulkString(e){const t=parseLength(e);if(t===undefined){return}if(t<0){return null}const r=e.offset+t;if(r+2>e.buffer.length){e.bigStrSize=r+2;e.totalChunkSize=e.buffer.length;e.bufferCache.push(e.buffer);return}const s=e.offset;e.offset=r+2;if(e.optionReturnBuffers===true){return e.buffer.slice(s,r)}return e.buffer.toString("utf8",s,r)}function parseError(e){var t=parseSimpleString(e);if(t!==undefined){if(e.optionReturnBuffers===true){t=t.toString()}return new a(t)}}function handleError(e,t){const r=new c("Protocol error, got "+JSON.stringify(String.fromCharCode(t))+" as reply type byte",JSON.stringify(e.buffer),e.offset);e.buffer=null;e.returnFatalError(r)}function parseArray(e){const t=parseLength(e);if(t===undefined){return}if(t<0){return null}const r=new Array(t);return parseArrayElements(e,r,0)}function pushArrayCache(e,t,r){e.arrayCache.push(t);e.arrayPos.push(r)}function parseArrayChunks(e){const t=e.arrayCache.pop();var r=e.arrayPos.pop();if(e.arrayCache.length){const s=parseArrayChunks(e);if(s===undefined){pushArrayCache(e,t,r);return}t[r++]=s}return parseArrayElements(e,t,r)}function parseArrayElements(e,t,r){const s=e.buffer.length;while(r<t.length){const n=e.offset;if(e.offset>=s){pushArrayCache(e,t,r);return}const o=parseType(e,e.buffer[e.offset++]);if(o===undefined){if(!(e.arrayCache.length||e.bufferCache.length)){e.offset=n}pushArrayCache(e,t,r);return}t[r]=o;r++}return t}function parseType(e,t){switch(t){case 36:return parseBulkString(e);case 43:return parseSimpleString(e);case 42:return parseArray(e);case 58:return parseInteger(e);case 45:return parseError(e);default:return handleError(e,t)}}function decreaseBufferPool(){if(l.length>50*1024){if(h===1||d>h*2){const e=Math.floor(l.length/10);const t=e<u?u:e;u=0;l=l.slice(t,l.length)}else{d++;h--}}else{clearInterval(f);h=0;d=0;f=null}}function resizeBuffer(e){if(l.length<e+u){const t=e>1024*1024*75?2:3;if(u>1024*1024*111){u=1024*1024*50}l=s.allocUnsafe(e*t+u);u=0;h++;if(f===null){f=setInterval(decreaseBufferPool,50)}}}function concatBulkString(e){const t=e.bufferCache;const r=e.offset;var s=t.length;var n=e.bigStrSize-e.totalChunkSize;e.offset=n;if(n<=2){if(s===2){return t[0].toString("utf8",r,t[0].length+n-2)}s--;n=t[t.length-2].length+n}var i=o.write(t[0].slice(r));for(var a=1;a<s-1;a++){i+=o.write(t[a])}i+=o.end(t[a].slice(0,n-2));return i}function concatBulkBuffer(e){const t=e.bufferCache;const r=e.offset;const s=e.bigStrSize-r-2;var n=t.length;var o=e.bigStrSize-e.totalChunkSize;e.offset=o;if(o<=2){if(n===2){return t[0].slice(r,t[0].length+o-2)}n--;o=t[t.length-2].length+o}resizeBuffer(s);const i=u;t[0].copy(l,i,r,t[0].length);u+=t[0].length-r;for(var a=1;a<n-1;a++){t[a].copy(l,u);u+=t[a].length}t[a].copy(l,u,0,o-2);u+=o-2;return l.slice(i,u)}class JavascriptRedisParser{constructor(e){if(!e){throw new TypeError("Options are mandatory.")}if(typeof e.returnError!=="function"||typeof e.returnReply!=="function"){throw new TypeError("The returnReply and returnError options have to be functions.")}this.setReturnBuffers(!!e.returnBuffers);this.setStringNumbers(!!e.stringNumbers);this.returnError=e.returnError;this.returnFatalError=e.returnFatalError||e.returnError;this.returnReply=e.returnReply;this.reset()}reset(){this.offset=0;this.buffer=null;this.bigStrSize=0;this.totalChunkSize=0;this.bufferCache=[];this.arrayCache=[];this.arrayPos=[]}setReturnBuffers(e){if(typeof e!=="boolean"){throw new TypeError("The returnBuffers argument has to be a boolean")}this.optionReturnBuffers=e}setStringNumbers(e){if(typeof e!=="boolean"){throw new TypeError("The stringNumbers argument has to be a boolean")}this.optionStringNumbers=e}execute(e){if(this.buffer===null){this.buffer=e;this.offset=0}else if(this.bigStrSize===0){const t=this.buffer.length;const r=t-this.offset;const n=s.allocUnsafe(r+e.length);this.buffer.copy(n,0,this.offset,t);e.copy(n,r,0,e.length);this.buffer=n;this.offset=0;if(this.arrayCache.length){const e=parseArrayChunks(this);if(e===undefined){return}this.returnReply(e)}}else if(this.totalChunkSize+e.length>=this.bigStrSize){this.bufferCache.push(e);var t=this.optionReturnBuffers?concatBulkBuffer(this):concatBulkString(this);this.bigStrSize=0;this.bufferCache=[];this.buffer=e;if(this.arrayCache.length){this.arrayCache[0][this.arrayPos[0]++]=t;t=parseArrayChunks(this);if(t===undefined){return}}this.returnReply(t)}else{this.bufferCache.push(e);this.totalChunkSize+=e.length;return}while(this.offset<this.buffer.length){const e=this.offset;const t=this.buffer[this.offset++];const r=parseType(this,t);if(r===undefined){if(!(this.arrayCache.length||this.bufferCache.length)){this.offset=e}return}if(t===45){this.returnError(r)}else{this.returnReply(r)}}this.buffer=null}}e.exports=JavascriptRedisParser},5659:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const s=r(2630);function throwLater(e){setTimeout((function(){throw e}),0)}function asCallback(e,t,r){if(typeof t==="function"){e.then((e=>{let n;if(r!==undefined&&Object(r).spread&&Array.isArray(e)){n=s.tryCatch(t).apply(undefined,[null].concat(e))}else{n=e===undefined?s.tryCatch(t)(null):s.tryCatch(t)(null,e)}if(n===s.errorObj){throwLater(n.e)}}),(e=>{if(!e){const t=new Error(e+"");Object.assign(t,{cause:e});e=t}const r=s.tryCatch(t)(e);if(r===s.errorObj){throwLater(r.e)}}))}return e}t["default"]=asCallback},2630:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.tryCatch=t.errorObj=void 0;t.errorObj={e:{}};let r;function tryCatcher(e,s){try{const e=r;r=null;return e.apply(this,arguments)}catch(e){t.errorObj.e=e;return t.errorObj}}function tryCatch(e){r=e;return tryCatcher}t.tryCatch=tryCatch},1857:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.storeHandler=storeHandler;const s=r(122);async function storeHandler(e){try{const t=await e.req.json();if(!t.key){return e.json({error:"Missing key parameter"},400)}await s.kvStore.set(t.key,t.value);return e.json({success:true,key:t.key,value:t.value},200)}catch(e){console.error("KV Store error:",e);throw e}}},122:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});t.kvStore=void 0;const n=s(r(7796));class Store{constructor(){this.DEFAULT_TTL_MS=86400*1e3;this.redis=new n.default({path:"/home/bmrknhtf/redis.sock",password:"ar0Dt3x7Iq"})}async set(e,t,r=this.DEFAULT_TTL_MS){const s=JSON.stringify(t);await this.redis.set(e,s,"PX",r)}async get(e){const t=await this.redis.get(e);if(!t){return undefined}try{return JSON.parse(t)}catch(t){console.error(`Failed to parse Redis value for key: ${e}`,t);return undefined}}async has(e){const t=await this.redis.exists(e);return t===1}async delete(e){const t=await this.redis.del(e);return t===1}async clear(){await this.redis.flushdb()}async size(){return await this.redis.dbsize()}async disconnect(){await this.redis.quit()}}t.kvStore=new Store},75:module=>{module.exports=eval("require")("supports-color")},2613:e=>{"use strict";e.exports=require("assert")},181:e=>{"use strict";e.exports=require("buffer")},6982:e=>{"use strict";e.exports=require("crypto")},2250:e=>{"use strict";e.exports=require("dns")},4434:e=>{"use strict";e.exports=require("events")},8611:e=>{"use strict";e.exports=require("http")},5675:e=>{"use strict";e.exports=require("http2")},9278:e=>{"use strict";e.exports=require("net")},2203:e=>{"use strict";e.exports=require("stream")},3193:e=>{"use strict";e.exports=require("string_decoder")},4756:e=>{"use strict";e.exports=require("tls")},2018:e=>{"use strict";e.exports=require("tty")},7016:e=>{"use strict";e.exports=require("url")},9023:e=>{"use strict";e.exports=require("util")},3965:e=>{"use strict";var t=Object.defineProperty;var r=Object.getOwnPropertyDescriptor;var s=Object.getOwnPropertyNames;var n=Object.prototype.hasOwnProperty;var __export=(e,r)=>{for(var s in r)t(e,s,{get:r[s],enumerable:true})};var __copyProps=(e,o,i,a)=>{if(o&&typeof o==="object"||typeof o==="function"){for(let c of s(o))if(!n.call(e,c)&&c!==i)t(e,c,{get:()=>o[c],enumerable:!(a=r(o,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(t({},"__esModule",{value:true}),e);var o={};__export(o,{compose:()=>compose});e.exports=__toCommonJS(o);const compose=(e,t,r)=>(s,n)=>{let o=-1;return dispatch(0);async function dispatch(i){if(i<=o){throw new Error("next() called multiple times")}o=i;let a;let c=false;let l;if(e[i]){l=e[i][0][0];s.req.routeIndex=i}else{l=i===e.length&&n||void 0}if(l){try{a=await l(s,(()=>dispatch(i+1)))}catch(e){if(e instanceof Error&&t){s.error=e;a=await t(e,s);c=true}else{throw e}}}else{if(s.finalized===false&&r){a=await r(s)}}if(a&&(s.finalized===false||c)){s.res=a}return s}};0&&0},6118:(e,t,r)=>{"use strict";var s=Object.defineProperty;var n=Object.getOwnPropertyDescriptor;var o=Object.getOwnPropertyNames;var i=Object.prototype.hasOwnProperty;var __export=(e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:true})};var __copyProps=(e,t,r,a)=>{if(t&&typeof t==="object"||typeof t==="function"){for(let c of o(t))if(!i.call(e,c)&&c!==r)s(e,c,{get:()=>t[c],enumerable:!(a=n(t,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(s({},"__esModule",{value:true}),e);var a={};__export(a,{Context:()=>Context,TEXT_PLAIN:()=>u});e.exports=__toCommonJS(a);var c=r(2588);var l=r(1270);const u="text/plain; charset=UTF-8";const setHeaders=(e,t={})=>{for(const r of Object.keys(t)){e.set(r,t[r])}return e};class Context{#r;#s;env={};#n;finalized=false;error;#o=200;#i;#a;#c;#l;#u=true;#f;#h;#d;#p;#y;constructor(e,t){this.#r=e;if(t){this.#i=t.executionCtx;this.env=t.env;this.#d=t.notFoundHandler;this.#y=t.path;this.#p=t.matchResult}}get req(){this.#s??=new c.HonoRequest(this.#r,this.#y,this.#p);return this.#s}get event(){if(this.#i&&"respondWith"in this.#i){return this.#i}else{throw Error("This context has no FetchEvent")}}get executionCtx(){if(this.#i){return this.#i}else{throw Error("This context has no ExecutionContext")}}get res(){this.#u=false;return this.#l||=new Response("404 Not Found",{status:404})}set res(e){this.#u=false;if(this.#l&&e){e=new Response(e.body,e);for(const[t,r]of this.#l.headers.entries()){if(t==="content-type"){continue}if(t==="set-cookie"){const t=this.#l.headers.getSetCookie();e.headers.delete("set-cookie");for(const r of t){e.headers.append("set-cookie",r)}}else{e.headers.set(t,r)}}}this.#l=e;this.finalized=true}render=(...e)=>{this.#h??=e=>this.html(e);return this.#h(...e)};setLayout=e=>this.#f=e;getLayout=()=>this.#f;setRenderer=e=>{this.#h=e};header=(e,t,r)=>{if(this.finalized){this.#l=new Response(this.#l.body,this.#l)}if(t===void 0){if(this.#a){this.#a.delete(e)}else if(this.#c){delete this.#c[e.toLocaleLowerCase()]}if(this.finalized){this.res.headers.delete(e)}return}if(r?.append){if(!this.#a){this.#u=false;this.#a=new Headers(this.#c);this.#c={}}this.#a.append(e,t)}else{if(this.#a){this.#a.set(e,t)}else{this.#c??={};this.#c[e.toLowerCase()]=t}}if(this.finalized){if(r?.append){this.res.headers.append(e,t)}else{this.res.headers.set(e,t)}}};status=e=>{this.#u=false;this.#o=e};set=(e,t)=>{this.#n??=new Map;this.#n.set(e,t)};get=e=>this.#n?this.#n.get(e):void 0;get var(){if(!this.#n){return{}}return Object.fromEntries(this.#n)}#g(e,t,r){if(this.#u&&!r&&!t&&this.#o===200){return new Response(e,{headers:this.#c})}if(t&&typeof t!=="number"){const r=new Headers(t.headers);if(this.#a){this.#a.forEach(((e,t)=>{if(t==="set-cookie"){r.append(t,e)}else{r.set(t,e)}}))}const s=setHeaders(r,this.#c);return new Response(e,{headers:s,status:t.status??this.#o})}const s=typeof t==="number"?t:this.#o;this.#c??={};this.#a??=new Headers;setHeaders(this.#a,this.#c);if(this.#l){this.#l.headers.forEach(((e,t)=>{if(t==="set-cookie"){this.#a?.append(t,e)}else{this.#a?.set(t,e)}}));setHeaders(this.#a,this.#c)}r??={};for(const[e,t]of Object.entries(r)){if(typeof t==="string"){this.#a.set(e,t)}else{this.#a.delete(e);for(const r of t){this.#a.append(e,r)}}}return new Response(e,{status:s,headers:this.#a})}newResponse=(...e)=>this.#g(...e);body=(e,t,r)=>typeof t==="number"?this.#g(e,t,r):this.#g(e,t);text=(e,t,r)=>{if(!this.#c){if(this.#u&&!r&&!t){return new Response(e)}this.#c={}}this.#c["content-type"]=u;if(typeof t==="number"){return this.#g(e,t,r)}return this.#g(e,t)};json=(e,t,r)=>{const s=JSON.stringify(e);this.#c??={};this.#c["content-type"]="application/json";return typeof t==="number"?this.#g(s,t,r):this.#g(s,t)};html=(e,t,r)=>{this.#c??={};this.#c["content-type"]="text/html; charset=UTF-8";if(typeof e==="object"){return(0,l.resolveCallback)(e,l.HtmlEscapedCallbackPhase.Stringify,false,{}).then((e=>typeof t==="number"?this.#g(e,t,r):this.#g(e,t)))}return typeof t==="number"?this.#g(e,t,r):this.#g(e,t)};redirect=(e,t)=>{this.#a??=new Headers;this.#a.set("Location",String(e));return this.newResponse(null,t??302)};notFound=()=>{this.#d??=()=>new Response;return this.#d(this)}}0&&0},8165:e=>{"use strict";var t=Object.defineProperty;var r=Object.getOwnPropertyDescriptor;var s=Object.getOwnPropertyNames;var n=Object.prototype.hasOwnProperty;var __export=(e,r)=>{for(var s in r)t(e,s,{get:r[s],enumerable:true})};var __copyProps=(e,o,i,a)=>{if(o&&typeof o==="object"||typeof o==="function"){for(let c of s(o))if(!n.call(e,c)&&c!==i)t(e,c,{get:()=>o[c],enumerable:!(a=r(o,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(t({},"__esModule",{value:true}),e);var o={};__export(o,{proxy:()=>proxy});e.exports=__toCommonJS(o);const i=["connection","keep-alive","proxy-authenticate","proxy-authorization","te","trailers","transfer-encoding"];const buildRequestInitFromRequest=e=>{if(!e){return{}}const t=new Headers(e.headers);i.forEach((e=>{t.delete(e)}));return{method:e.method,body:e.body,duplex:e.body?"half":void 0,headers:t,signal:e.signal}};const preprocessRequestInit=e=>{if(!e.headers||Array.isArray(e.headers)||e.headers instanceof Headers){return e}const t=new Headers;for(const[r,s]of Object.entries(e.headers)){if(s==null){t.delete(r)}else{t.set(r,s)}}e.headers=t;return e};const proxy=async(e,t)=>{const{raw:r,...s}=t instanceof Request?{raw:t}:t??{};const n=new Request(e,{...buildRequestInitFromRequest(r),...preprocessRequestInit(s)});n.headers.delete("accept-encoding");const o=await fetch(n);const a=new Headers(o.headers);i.forEach((e=>{a.delete(e)}));if(a.has("content-encoding")){a.delete("content-encoding");a.delete("content-length")}return new Response(o.body,{status:o.status,statusText:o.statusText,headers:a})};0&&0},2381:(e,t,r)=>{"use strict";var s=Object.defineProperty;var n=Object.getOwnPropertyDescriptor;var o=Object.getOwnPropertyNames;var i=Object.prototype.hasOwnProperty;var __export=(e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:true})};var __copyProps=(e,t,r,a)=>{if(t&&typeof t==="object"||typeof t==="function"){for(let c of o(t))if(!i.call(e,c)&&c!==r)s(e,c,{get:()=>t[c],enumerable:!(a=n(t,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(s({},"__esModule",{value:true}),e);var a={};__export(a,{HonoBase:()=>Hono});e.exports=__toCommonJS(a);var c=r(3965);var l=r(6118);var u=r(7120);var f=r(8638);var h=r(2154);const notFoundHandler=e=>e.text("404 Not Found",404);const errorHandler=(e,t)=>{if("getResponse"in e){return e.getResponse()}console.error(e);return t.text("Internal Server Error",500)};class Hono{get;post;put;delete;options;patch;all;on;use;router;getPath;_basePath="/";#y="/";routes=[];constructor(e={}){const t=[...u.METHODS,u.METHOD_NAME_ALL_LOWERCASE];t.forEach((e=>{this[e]=(t,...r)=>{if(typeof t==="string"){this.#y=t}else{this.#m(e,this.#y,t)}r.forEach((t=>{this.#m(e,this.#y,t)}));return this}}));this.on=(e,t,...r)=>{for(const s of[t].flat()){this.#y=s;for(const t of[e].flat()){r.map((e=>{this.#m(t.toUpperCase(),this.#y,e)}))}}return this};this.use=(e,...t)=>{if(typeof e==="string"){this.#y=e}else{this.#y="*";t.unshift(e)}t.forEach((e=>{this.#m(u.METHOD_NAME_ALL,this.#y,e)}));return this};const{strict:r,...s}=e;Object.assign(this,s);this.getPath=r??true?e.getPath??h.getPath:h.getPathNoStrict}#b(){const e=new Hono({router:this.router,getPath:this.getPath});e.errorHandler=this.errorHandler;e.#d=this.#d;e.routes=this.routes;return e}#d=notFoundHandler;errorHandler=errorHandler;route(e,t){const r=this.basePath(e);t.routes.map((e=>{let s;if(t.errorHandler===errorHandler){s=e.handler}else{s=async(r,s)=>(await(0,c.compose)([],t.errorHandler)(r,(()=>e.handler(r,s)))).res;s[f.COMPOSED_HANDLER]=e.handler}r.#m(e.method,e.path,s)}));return this}basePath(e){const t=this.#b();t._basePath=(0,h.mergePath)(this._basePath,e);return t}onError=e=>{this.errorHandler=e;return this};notFound=e=>{this.#d=e;return this};mount(e,t,r){let s;let n;if(r){if(typeof r==="function"){n=r}else{n=r.optionHandler;if(r.replaceRequest===false){s=e=>e}else{s=r.replaceRequest}}}const o=n?e=>{const t=n(e);return Array.isArray(t)?t:[t]}:e=>{let t=void 0;try{t=e.executionCtx}catch{}return[e.env,t]};s||=(()=>{const t=(0,h.mergePath)(this._basePath,e);const r=t==="/"?0:t.length;return e=>{const t=new URL(e.url);t.pathname=t.pathname.slice(r)||"/";return new Request(t,e)}})();const handler=async(e,r)=>{const n=await t(s(e.req.raw),...o(e));if(n){return n}await r()};this.#m(u.METHOD_NAME_ALL,(0,h.mergePath)(e,"*"),handler);return this}#m(e,t,r){e=e.toUpperCase();t=(0,h.mergePath)(this._basePath,t);const s={path:t,method:e,handler:r};this.router.add(e,t,[r,s]);this.routes.push(s)}#S(e,t){if(e instanceof Error){return this.errorHandler(e,t)}throw e}#v(e,t,r,s){if(s==="HEAD"){return(async()=>new Response(null,await this.#v(e,t,r,"GET")))()}const n=this.getPath(e,{env:r});const o=this.router.match(s,n);const i=new l.Context(e,{path:n,matchResult:o,env:r,executionCtx:t,notFoundHandler:this.#d});if(o[0].length===1){let e;try{e=o[0][0][0][0](i,(async()=>{i.res=await this.#d(i)}))}catch(e){return this.#S(e,i)}return e instanceof Promise?e.then((e=>e||(i.finalized?i.res:this.#d(i)))).catch((e=>this.#S(e,i))):e??this.#d(i)}const a=(0,c.compose)(o[0],this.errorHandler,this.#d);return(async()=>{try{const e=await a(i);if(!e.finalized){throw new Error("Context is not finalized. Did you forget to return a Response object or `await next()`?")}return e.res}catch(e){return this.#S(e,i)}})()}fetch=(e,...t)=>this.#v(e,t[1],t[0],e.method);request=(e,t,r,s)=>{if(e instanceof Request){return this.fetch(t?new Request(e,t):e,r,s)}e=e.toString();return this.fetch(new Request(/^https?:\/\//.test(e)?e:`http://localhost${(0,h.mergePath)("/",e)}`,t),r,s)};fire=()=>{addEventListener("fetch",(e=>{e.respondWith(this.#v(e.request,e,void 0,e.request.method))}))}}0&&0},7591:(e,t,r)=>{"use strict";var s=Object.defineProperty;var n=Object.getOwnPropertyDescriptor;var o=Object.getOwnPropertyNames;var i=Object.prototype.hasOwnProperty;var __export=(e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:true})};var __copyProps=(e,t,r,a)=>{if(t&&typeof t==="object"||typeof t==="function"){for(let c of o(t))if(!i.call(e,c)&&c!==r)s(e,c,{get:()=>t[c],enumerable:!(a=n(t,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(s({},"__esModule",{value:true}),e);var a={};__export(a,{Hono:()=>Hono});e.exports=__toCommonJS(a);var c=r(2381);var l=r(5250);var u=r(4893);var f=r(4294);class Hono extends c.HonoBase{constructor(e={}){super(e);this.router=e.router??new u.SmartRouter({routers:[new l.RegExpRouter,new f.TrieRouter]})}}0&&0},6233:(e,t,r)=>{"use strict";var s=Object.defineProperty;var n=Object.getOwnPropertyDescriptor;var o=Object.getOwnPropertyNames;var i=Object.prototype.hasOwnProperty;var __export=(e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:true})};var __copyProps=(e,t,r,a)=>{if(t&&typeof t==="object"||typeof t==="function"){for(let c of o(t))if(!i.call(e,c)&&c!==r)s(e,c,{get:()=>t[c],enumerable:!(a=n(t,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(s({},"__esModule",{value:true}),e);var a={};__export(a,{Hono:()=>c.Hono});e.exports=__toCommonJS(a);var c=r(7591);0&&0},5058:e=>{"use strict";var t=Object.defineProperty;var r=Object.getOwnPropertyDescriptor;var s=Object.getOwnPropertyNames;var n=Object.prototype.hasOwnProperty;var __export=(e,r)=>{for(var s in r)t(e,s,{get:r[s],enumerable:true})};var __copyProps=(e,o,i,a)=>{if(o&&typeof o==="object"||typeof o==="function"){for(let c of s(o))if(!n.call(e,c)&&c!==i)t(e,c,{get:()=>o[c],enumerable:!(a=r(o,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(t({},"__esModule",{value:true}),e);var o={};__export(o,{cors:()=>cors});e.exports=__toCommonJS(o);const cors=e=>{const t={origin:"*",allowMethods:["GET","HEAD","PUT","POST","DELETE","PATCH"],allowHeaders:[],exposeHeaders:[]};const r={...t,...e};const s=(e=>{if(typeof e==="string"){if(e==="*"){return()=>e}else{return t=>e===t?t:null}}else if(typeof e==="function"){return e}else{return t=>e.includes(t)?t:null}})(r.origin);return async function cors2(e,t){function set(t,r){e.res.headers.set(t,r)}const n=s(e.req.header("origin")||"",e);if(n){set("Access-Control-Allow-Origin",n)}if(r.origin!=="*"){const t=e.req.header("Vary");if(t){set("Vary",t)}else{set("Vary","Origin")}}if(r.credentials){set("Access-Control-Allow-Credentials","true")}if(r.exposeHeaders?.length){set("Access-Control-Expose-Headers",r.exposeHeaders.join(","))}if(e.req.method==="OPTIONS"){if(r.maxAge!=null){set("Access-Control-Max-Age",r.maxAge.toString())}if(r.allowMethods?.length){set("Access-Control-Allow-Methods",r.allowMethods.join(","))}let t=r.allowHeaders;if(!t?.length){const r=e.req.header("Access-Control-Request-Headers");if(r){t=r.split(/\s*,\s*/)}}if(t?.length){set("Access-Control-Allow-Headers",t.join(","));e.res.headers.append("Vary","Access-Control-Request-Headers")}e.res.headers.delete("Content-Length");e.res.headers.delete("Content-Type");return new Response(null,{headers:e.res.headers,status:204,statusText:"No Content"})}await t()}};0&&0},2588:(e,t,r)=>{"use strict";var s=Object.defineProperty;var n=Object.getOwnPropertyDescriptor;var o=Object.getOwnPropertyNames;var i=Object.prototype.hasOwnProperty;var __export=(e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:true})};var __copyProps=(e,t,r,a)=>{if(t&&typeof t==="object"||typeof t==="function"){for(let c of o(t))if(!i.call(e,c)&&c!==r)s(e,c,{get:()=>t[c],enumerable:!(a=n(t,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(s({},"__esModule",{value:true}),e);var a={};__export(a,{HonoRequest:()=>HonoRequest});e.exports=__toCommonJS(a);var c=r(4187);var l=r(2154);const tryDecodeURIComponent=e=>(0,l.tryDecode)(e,l.decodeURIComponent_);class HonoRequest{raw;#k;#p;routeIndex=0;path;bodyCache={};constructor(e,t="/",r=[[]]){this.raw=e;this.path=t;this.#p=r;this.#k={}}param(e){return e?this.#w(e):this.#E()}#w(e){const t=this.#p[0][this.routeIndex][1][e];const r=this.#_(t);return r?/\%/.test(r)?tryDecodeURIComponent(r):r:void 0}#E(){const e={};const t=Object.keys(this.#p[0][this.routeIndex][1]);for(const r of t){const t=this.#_(this.#p[0][this.routeIndex][1][r]);if(t&&typeof t==="string"){e[r]=/\%/.test(t)?tryDecodeURIComponent(t):t}}return e}#_(e){return this.#p[1]?this.#p[1][e]:e}query(e){return(0,l.getQueryParam)(this.url,e)}queries(e){return(0,l.getQueryParams)(this.url,e)}header(e){if(e){return this.raw.headers.get(e)??void 0}const t={};this.raw.headers.forEach(((e,r)=>{t[r]=e}));return t}async parseBody(e){return this.bodyCache.parsedBody??=await(0,c.parseBody)(this,e)}#C=e=>{const{bodyCache:t,raw:r}=this;const s=t[e];if(s){return s}const n=Object.keys(t)[0];if(n){return t[n].then((t=>{if(n==="json"){t=JSON.stringify(t)}return new Response(t)[e]()}))}return t[e]=r[e]()};json(){return this.#C("json")}text(){return this.#C("text")}arrayBuffer(){return this.#C("arrayBuffer")}blob(){return this.#C("blob")}formData(){return this.#C("formData")}addValidatedData(e,t){this.#k[e]=t}valid(e){return this.#k[e]}get url(){return this.raw.url}get method(){return this.raw.method}get matchedRoutes(){return this.#p[0].map((([[,e]])=>e))}get routePath(){return this.#p[0].map((([[,e]])=>e))[this.routeIndex].path}}0&&0},7120:e=>{"use strict";var t=Object.defineProperty;var r=Object.getOwnPropertyDescriptor;var s=Object.getOwnPropertyNames;var n=Object.prototype.hasOwnProperty;var __export=(e,r)=>{for(var s in r)t(e,s,{get:r[s],enumerable:true})};var __copyProps=(e,o,i,a)=>{if(o&&typeof o==="object"||typeof o==="function"){for(let c of s(o))if(!n.call(e,c)&&c!==i)t(e,c,{get:()=>o[c],enumerable:!(a=r(o,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(t({},"__esModule",{value:true}),e);var o={};__export(o,{MESSAGE_MATCHER_IS_ALREADY_BUILT:()=>l,METHODS:()=>c,METHOD_NAME_ALL:()=>i,METHOD_NAME_ALL_LOWERCASE:()=>a,UnsupportedPathError:()=>UnsupportedPathError});e.exports=__toCommonJS(o);const i="ALL";const a="all";const c=["get","post","put","delete","options","patch"];const l="Can not add a route since the matcher is already built.";class UnsupportedPathError extends Error{}0&&0},5250:(e,t,r)=>{"use strict";var s=Object.defineProperty;var n=Object.getOwnPropertyDescriptor;var o=Object.getOwnPropertyNames;var i=Object.prototype.hasOwnProperty;var __export=(e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:true})};var __copyProps=(e,t,r,a)=>{if(t&&typeof t==="object"||typeof t==="function"){for(let c of o(t))if(!i.call(e,c)&&c!==r)s(e,c,{get:()=>t[c],enumerable:!(a=n(t,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(s({},"__esModule",{value:true}),e);var a={};__export(a,{RegExpRouter:()=>c.RegExpRouter});e.exports=__toCommonJS(a);var c=r(8177);0&&0},7960:e=>{"use strict";var t=Object.defineProperty;var r=Object.getOwnPropertyDescriptor;var s=Object.getOwnPropertyNames;var n=Object.prototype.hasOwnProperty;var __export=(e,r)=>{for(var s in r)t(e,s,{get:r[s],enumerable:true})};var __copyProps=(e,o,i,a)=>{if(o&&typeof o==="object"||typeof o==="function"){for(let c of s(o))if(!n.call(e,c)&&c!==i)t(e,c,{get:()=>o[c],enumerable:!(a=r(o,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(t({},"__esModule",{value:true}),e);var o={};__export(o,{Node:()=>Node,PATH_ERROR:()=>l});e.exports=__toCommonJS(o);const i="[^/]+";const a=".*";const c="(?:|/.*)";const l=Symbol();const u=new Set(".\\+*[^]$()");function compareKey(e,t){if(e.length===1){return t.length===1?e<t?-1:1:-1}if(t.length===1){return 1}if(e===a||e===c){return 1}else if(t===a||t===c){return-1}if(e===i){return 1}else if(t===i){return-1}return e.length===t.length?e<t?-1:1:t.length-e.length}class Node{#O;#A;#R=Object.create(null);insert(e,t,r,s,n){if(e.length===0){if(this.#O!==void 0){throw l}if(n){return}this.#O=t;return}const[o,...u]=e;const f=o==="*"?u.length===0?["","",a]:["","",i]:o==="/*"?["","",c]:o.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);let h;if(f){const e=f[1];let t=f[2]||i;if(e&&f[2]){t=t.replace(/^\((?!\?:)(?=[^)]+\)$)/,"(?:");if(/\((?!\?:)/.test(t)){throw l}}h=this.#R[t];if(!h){if(Object.keys(this.#R).some((e=>e!==a&&e!==c))){throw l}if(n){return}h=this.#R[t]=new Node;if(e!==""){h.#A=s.varIndex++}}if(!n&&e!==""){r.push([e,h.#A])}}else{h=this.#R[o];if(!h){if(Object.keys(this.#R).some((e=>e.length>1&&e!==a&&e!==c))){throw l}if(n){return}h=this.#R[o]=new Node}}h.insert(u,t,r,s,n)}buildRegExpStr(){const e=Object.keys(this.#R).sort(compareKey);const t=e.map((e=>{const t=this.#R[e];return(typeof t.#A==="number"?`(${e})@${t.#A}`:u.has(e)?`\\${e}`:e)+t.buildRegExpStr()}));if(typeof this.#O==="number"){t.unshift(`#${this.#O}`)}if(t.length===0){return""}if(t.length===1){return t[0]}return"(?:"+t.join("|")+")"}}0&&0},8177:(e,t,r)=>{"use strict";var s=Object.defineProperty;var n=Object.getOwnPropertyDescriptor;var o=Object.getOwnPropertyNames;var i=Object.prototype.hasOwnProperty;var __export=(e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:true})};var __copyProps=(e,t,r,a)=>{if(t&&typeof t==="object"||typeof t==="function"){for(let c of o(t))if(!i.call(e,c)&&c!==r)s(e,c,{get:()=>t[c],enumerable:!(a=n(t,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(s({},"__esModule",{value:true}),e);var a={};__export(a,{RegExpRouter:()=>RegExpRouter});e.exports=__toCommonJS(a);var c=r(7120);var l=r(2154);var u=r(7960);var f=r(2280);const h=[];const d=[/^$/,[],Object.create(null)];let p=Object.create(null);function buildWildcardRegExp(e){return p[e]??=new RegExp(e==="*"?"":`^${e.replace(/\/\*$|([.\\+*[^\]$()])/g,((e,t)=>t?`\\${t}`:"(?:|/.*)"))}$`)}function clearWildcardRegExpCache(){p=Object.create(null)}function buildMatcherFromPreprocessedRoutes(e){const t=new f.Trie;const r=[];if(e.length===0){return d}const s=e.map((e=>[!/\*|\/:/.test(e[0]),...e])).sort((([e,t],[r,s])=>e?1:r?-1:t.length-s.length));const n=Object.create(null);for(let e=0,o=-1,i=s.length;e<i;e++){const[i,a,l]=s[e];if(i){n[a]=[l.map((([e])=>[e,Object.create(null)])),h]}else{o++}let f;try{f=t.insert(a,o,i)}catch(e){throw e===u.PATH_ERROR?new c.UnsupportedPathError(a):e}if(i){continue}r[o]=l.map((([e,t])=>{const r=Object.create(null);t-=1;for(;t>=0;t--){const[e,s]=f[t];r[e]=s}return[e,r]}))}const[o,i,a]=t.buildRegExp();for(let e=0,t=r.length;e<t;e++){for(let t=0,s=r[e].length;t<s;t++){const s=r[e][t]?.[1];if(!s){continue}const n=Object.keys(s);for(let e=0,t=n.length;e<t;e++){s[n[e]]=a[s[n[e]]]}}}const l=[];for(const e in i){l[e]=r[i[e]]}return[o,l,n]}function findMiddleware(e,t){if(!e){return void 0}for(const r of Object.keys(e).sort(((e,t)=>t.length-e.length))){if(buildWildcardRegExp(r).test(t)){return[...e[r]]}}return void 0}class RegExpRouter{name="RegExpRouter";#x;#M;constructor(){this.#x={[c.METHOD_NAME_ALL]:Object.create(null)};this.#M={[c.METHOD_NAME_ALL]:Object.create(null)}}add(e,t,r){const s=this.#x;const n=this.#M;if(!s||!n){throw new Error(c.MESSAGE_MATCHER_IS_ALREADY_BUILT)}if(!s[e]){[s,n].forEach((t=>{t[e]=Object.create(null);Object.keys(t[c.METHOD_NAME_ALL]).forEach((r=>{t[e][r]=[...t[c.METHOD_NAME_ALL][r]]}))}))}if(t==="/*"){t="*"}const o=(t.match(/\/:/g)||[]).length;if(/\*$/.test(t)){const i=buildWildcardRegExp(t);if(e===c.METHOD_NAME_ALL){Object.keys(s).forEach((e=>{s[e][t]||=findMiddleware(s[e],t)||findMiddleware(s[c.METHOD_NAME_ALL],t)||[]}))}else{s[e][t]||=findMiddleware(s[e],t)||findMiddleware(s[c.METHOD_NAME_ALL],t)||[]}Object.keys(s).forEach((t=>{if(e===c.METHOD_NAME_ALL||e===t){Object.keys(s[t]).forEach((e=>{i.test(e)&&s[t][e].push([r,o])}))}}));Object.keys(n).forEach((t=>{if(e===c.METHOD_NAME_ALL||e===t){Object.keys(n[t]).forEach((e=>i.test(e)&&n[t][e].push([r,o])))}}));return}const i=(0,l.checkOptionalParameter)(t)||[t];for(let t=0,a=i.length;t<a;t++){const l=i[t];Object.keys(n).forEach((i=>{if(e===c.METHOD_NAME_ALL||e===i){n[i][l]||=[...findMiddleware(s[i],l)||findMiddleware(s[c.METHOD_NAME_ALL],l)||[]];n[i][l].push([r,o-a+t+1])}}))}}match(e,t){clearWildcardRegExpCache();const r=this.#j();this.match=(e,t)=>{const s=r[e]||r[c.METHOD_NAME_ALL];const n=s[2][t];if(n){return n}const o=t.match(s[0]);if(!o){return[[],h]}const i=o.indexOf("",1);return[s[1][i],o]};return this.match(e,t)}#j(){const e=Object.create(null);Object.keys(this.#M).concat(Object.keys(this.#x)).forEach((t=>{e[t]||=this.#P(t)}));this.#x=this.#M=void 0;return e}#P(e){const t=[];let r=e===c.METHOD_NAME_ALL;[this.#x,this.#M].forEach((s=>{const n=s[e]?Object.keys(s[e]).map((t=>[t,s[e][t]])):[];if(n.length!==0){r||=true;t.push(...n)}else if(e!==c.METHOD_NAME_ALL){t.push(...Object.keys(s[c.METHOD_NAME_ALL]).map((e=>[e,s[c.METHOD_NAME_ALL][e]])))}}));if(!r){return null}else{return buildMatcherFromPreprocessedRoutes(t)}}}0&&0},2280:(e,t,r)=>{"use strict";var s=Object.defineProperty;var n=Object.getOwnPropertyDescriptor;var o=Object.getOwnPropertyNames;var i=Object.prototype.hasOwnProperty;var __export=(e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:true})};var __copyProps=(e,t,r,a)=>{if(t&&typeof t==="object"||typeof t==="function"){for(let c of o(t))if(!i.call(e,c)&&c!==r)s(e,c,{get:()=>t[c],enumerable:!(a=n(t,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(s({},"__esModule",{value:true}),e);var a={};__export(a,{Trie:()=>Trie});e.exports=__toCommonJS(a);var c=r(7960);class Trie{#T={varIndex:0};#D=new c.Node;insert(e,t,r){const s=[];const n=[];for(let t=0;;){let r=false;e=e.replace(/\{[^}]+\}/g,(e=>{const s=`@\\${t}`;n[t]=[s,e];t++;r=true;return s}));if(!r){break}}const o=e.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let e=n.length-1;e>=0;e--){const[t]=n[e];for(let r=o.length-1;r>=0;r--){if(o[r].indexOf(t)!==-1){o[r]=o[r].replace(t,n[e][1]);break}}}this.#D.insert(o,t,s,this.#T,r);return s}buildRegExp(){let e=this.#D.buildRegExpStr();if(e===""){return[/^$/,[],[]]}let t=0;const r=[];const s=[];e=e.replace(/#(\d+)|@(\d+)|\.\*\$/g,((e,n,o)=>{if(n!==void 0){r[++t]=Number(n);return"$()"}if(o!==void 0){s[Number(o)]=++t;return""}return""}));return[new RegExp(`^${e}`),r,s]}}0&&0},4893:(e,t,r)=>{"use strict";var s=Object.defineProperty;var n=Object.getOwnPropertyDescriptor;var o=Object.getOwnPropertyNames;var i=Object.prototype.hasOwnProperty;var __export=(e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:true})};var __copyProps=(e,t,r,a)=>{if(t&&typeof t==="object"||typeof t==="function"){for(let c of o(t))if(!i.call(e,c)&&c!==r)s(e,c,{get:()=>t[c],enumerable:!(a=n(t,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(s({},"__esModule",{value:true}),e);var a={};__export(a,{SmartRouter:()=>c.SmartRouter});e.exports=__toCommonJS(a);var c=r(9348);0&&0},9348:(e,t,r)=>{"use strict";var s=Object.defineProperty;var n=Object.getOwnPropertyDescriptor;var o=Object.getOwnPropertyNames;var i=Object.prototype.hasOwnProperty;var __export=(e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:true})};var __copyProps=(e,t,r,a)=>{if(t&&typeof t==="object"||typeof t==="function"){for(let c of o(t))if(!i.call(e,c)&&c!==r)s(e,c,{get:()=>t[c],enumerable:!(a=n(t,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(s({},"__esModule",{value:true}),e);var a={};__export(a,{SmartRouter:()=>SmartRouter});e.exports=__toCommonJS(a);var c=r(7120);class SmartRouter{name="SmartRouter";#B=[];#M=[];constructor(e){this.#B=e.routers}add(e,t,r){if(!this.#M){throw new Error(c.MESSAGE_MATCHER_IS_ALREADY_BUILT)}this.#M.push([e,t,r])}match(e,t){if(!this.#M){throw new Error("Fatal error")}const r=this.#B;const s=this.#M;const n=r.length;let o=0;let i;for(;o<n;o++){const n=r[o];try{for(let e=0,t=s.length;e<t;e++){n.add(...s[e])}i=n.match(e,t)}catch(e){if(e instanceof c.UnsupportedPathError){continue}throw e}this.match=n.match.bind(n);this.#B=[n];this.#M=void 0;break}if(o===n){throw new Error("Fatal error")}this.name=`SmartRouter + ${this.activeRouter.name}`;return i}get activeRouter(){if(this.#M||this.#B.length!==1){throw new Error("No active router has been determined yet.")}return this.#B[0]}}0&&0},4294:(e,t,r)=>{"use strict";var s=Object.defineProperty;var n=Object.getOwnPropertyDescriptor;var o=Object.getOwnPropertyNames;var i=Object.prototype.hasOwnProperty;var __export=(e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:true})};var __copyProps=(e,t,r,a)=>{if(t&&typeof t==="object"||typeof t==="function"){for(let c of o(t))if(!i.call(e,c)&&c!==r)s(e,c,{get:()=>t[c],enumerable:!(a=n(t,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(s({},"__esModule",{value:true}),e);var a={};__export(a,{TrieRouter:()=>c.TrieRouter});e.exports=__toCommonJS(a);var c=r(8693);0&&0},8044:(e,t,r)=>{"use strict";var s=Object.defineProperty;var n=Object.getOwnPropertyDescriptor;var o=Object.getOwnPropertyNames;var i=Object.prototype.hasOwnProperty;var __export=(e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:true})};var __copyProps=(e,t,r,a)=>{if(t&&typeof t==="object"||typeof t==="function"){for(let c of o(t))if(!i.call(e,c)&&c!==r)s(e,c,{get:()=>t[c],enumerable:!(a=n(t,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(s({},"__esModule",{value:true}),e);var a={};__export(a,{Node:()=>Node});e.exports=__toCommonJS(a);var c=r(7120);var l=r(2154);const u=Object.create(null);class Node{#N;#R;#I;#F=0;#L=u;constructor(e,t,r){this.#R=r||Object.create(null);this.#N=[];if(e&&t){const r=Object.create(null);r[e]={handler:t,possibleKeys:[],score:0};this.#N=[r]}this.#I=[]}insert(e,t,r){this.#F=++this.#F;let s=this;const n=(0,l.splitRoutingPath)(t);const o=[];for(let e=0,t=n.length;e<t;e++){const t=n[e];const r=n[e+1];const i=(0,l.getPattern)(t,r);const a=Array.isArray(i)?i[0]:t;if(Object.keys(s.#R).includes(a)){s=s.#R[a];const e=(0,l.getPattern)(t,r);if(e){o.push(e[1])}continue}s.#R[a]=new Node;if(i){s.#I.push(i);o.push(i[1])}s=s.#R[a]}const i=Object.create(null);const a={handler:r,possibleKeys:o.filter(((e,t,r)=>r.indexOf(e)===t)),score:this.#F};i[e]=a;s.#N.push(i);return s}#H(e,t,r,s){const n=[];for(let o=0,i=e.#N.length;o<i;o++){const i=e.#N[o];const a=i[t]||i[c.METHOD_NAME_ALL];const l={};if(a!==void 0){a.params=Object.create(null);n.push(a);if(r!==u||s&&s!==u){for(let e=0,t=a.possibleKeys.length;e<t;e++){const t=a.possibleKeys[e];const n=l[a.score];a.params[t]=s?.[t]&&!n?s[t]:r[t]??s?.[t];l[a.score]=true}}}}return n}search(e,t){const r=[];this.#L=u;const s=this;let n=[s];const o=(0,l.splitPath)(t);const i=[];for(let t=0,s=o.length;t<s;t++){const a=o[t];const c=t===s-1;const l=[];for(let s=0,f=n.length;s<f;s++){const f=n[s];const h=f.#R[a];if(h){h.#L=f.#L;if(c){if(h.#R["*"]){r.push(...this.#H(h.#R["*"],e,f.#L))}r.push(...this.#H(h,e,f.#L))}else{l.push(h)}}for(let s=0,n=f.#I.length;s<n;s++){const n=f.#I[s];const h=f.#L===u?{}:{...f.#L};if(n==="*"){const t=f.#R["*"];if(t){r.push(...this.#H(t,e,f.#L));t.#L=h;l.push(t)}continue}if(a===""){continue}const[d,p,y]=n;const g=f.#R[d];const m=o.slice(t).join("/");if(y instanceof RegExp){const t=y.exec(m);if(t){h[p]=t[0];r.push(...this.#H(g,e,f.#L,h));if(Object.keys(g.#R).length){g.#L=h;const e=t[0].match(/\//)?.length??0;const r=i[e]||=[];r.push(g)}continue}}if(y===true||y.test(a)){h[p]=a;if(c){r.push(...this.#H(g,e,h,f.#L));if(g.#R["*"]){r.push(...this.#H(g.#R["*"],e,h,f.#L))}}else{g.#L=h;l.push(g)}}}}n=l.concat(i.shift()??[])}if(r.length>1){r.sort(((e,t)=>e.score-t.score))}return[r.map((({handler:e,params:t})=>[e,t]))]}}0&&0},8693:(e,t,r)=>{"use strict";var s=Object.defineProperty;var n=Object.getOwnPropertyDescriptor;var o=Object.getOwnPropertyNames;var i=Object.prototype.hasOwnProperty;var __export=(e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:true})};var __copyProps=(e,t,r,a)=>{if(t&&typeof t==="object"||typeof t==="function"){for(let c of o(t))if(!i.call(e,c)&&c!==r)s(e,c,{get:()=>t[c],enumerable:!(a=n(t,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(s({},"__esModule",{value:true}),e);var a={};__export(a,{TrieRouter:()=>TrieRouter});e.exports=__toCommonJS(a);var c=r(2154);var l=r(8044);class TrieRouter{name="TrieRouter";#Q;constructor(){this.#Q=new l.Node}add(e,t,r){const s=(0,c.checkOptionalParameter)(t);if(s){for(let t=0,n=s.length;t<n;t++){this.#Q.insert(e,s[t],r)}return}this.#Q.insert(e,t,r)}match(e,t){return this.#Q.search(e,t)}}0&&0},4187:(e,t,r)=>{"use strict";var s=Object.defineProperty;var n=Object.getOwnPropertyDescriptor;var o=Object.getOwnPropertyNames;var i=Object.prototype.hasOwnProperty;var __export=(e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:true})};var __copyProps=(e,t,r,a)=>{if(t&&typeof t==="object"||typeof t==="function"){for(let c of o(t))if(!i.call(e,c)&&c!==r)s(e,c,{get:()=>t[c],enumerable:!(a=n(t,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(s({},"__esModule",{value:true}),e);var a={};__export(a,{parseBody:()=>parseBody});e.exports=__toCommonJS(a);var c=r(2588);const parseBody=async(e,t=Object.create(null))=>{const{all:r=false,dot:s=false}=t;const n=e instanceof c.HonoRequest?e.raw.headers:e.headers;const o=n.get("Content-Type");if(o?.startsWith("multipart/form-data")||o?.startsWith("application/x-www-form-urlencoded")){return parseFormData(e,{all:r,dot:s})}return{}};async function parseFormData(e,t){const r=await e.formData();if(r){return convertFormDataToBodyData(r,t)}return{}}function convertFormDataToBodyData(e,t){const r=Object.create(null);e.forEach(((e,s)=>{const n=t.all||s.endsWith("[]");if(!n){r[s]=e}else{handleParsingAllValues(r,s,e)}}));if(t.dot){Object.entries(r).forEach((([e,t])=>{const s=e.includes(".");if(s){handleParsingNestedValues(r,e,t);delete r[e]}}))}return r}const handleParsingAllValues=(e,t,r)=>{if(e[t]!==void 0){if(Array.isArray(e[t])){e[t].push(r)}else{e[t]=[e[t],r]}}else{e[t]=r}};const handleParsingNestedValues=(e,t,r)=>{let s=e;const n=t.split(".");n.forEach(((e,t)=>{if(t===n.length-1){s[e]=r}else{if(!s[e]||typeof s[e]!=="object"||Array.isArray(s[e])||s[e]instanceof File){s[e]=Object.create(null)}s=s[e]}}))};0&&0},8638:e=>{"use strict";var t=Object.defineProperty;var r=Object.getOwnPropertyDescriptor;var s=Object.getOwnPropertyNames;var n=Object.prototype.hasOwnProperty;var __export=(e,r)=>{for(var s in r)t(e,s,{get:r[s],enumerable:true})};var __copyProps=(e,o,i,a)=>{if(o&&typeof o==="object"||typeof o==="function"){for(let c of s(o))if(!n.call(e,c)&&c!==i)t(e,c,{get:()=>o[c],enumerable:!(a=r(o,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(t({},"__esModule",{value:true}),e);var o={};__export(o,{COMPOSED_HANDLER:()=>i});e.exports=__toCommonJS(o);const i="__COMPOSED_HANDLER";0&&0},1270:e=>{"use strict";var t=Object.defineProperty;var r=Object.getOwnPropertyDescriptor;var s=Object.getOwnPropertyNames;var n=Object.prototype.hasOwnProperty;var __export=(e,r)=>{for(var s in r)t(e,s,{get:r[s],enumerable:true})};var __copyProps=(e,o,i,a)=>{if(o&&typeof o==="object"||typeof o==="function"){for(let c of s(o))if(!n.call(e,c)&&c!==i)t(e,c,{get:()=>o[c],enumerable:!(a=r(o,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(t({},"__esModule",{value:true}),e);var o={};__export(o,{HtmlEscapedCallbackPhase:()=>i,escapeToBuffer:()=>escapeToBuffer,raw:()=>raw,resolveCallback:()=>resolveCallback,resolveCallbackSync:()=>resolveCallbackSync,stringBufferToString:()=>stringBufferToString});e.exports=__toCommonJS(o);const i={Stringify:1,BeforeStream:2,Stream:3};const raw=(e,t)=>{const r=new String(e);r.isEscaped=true;r.callbacks=t;return r};const a=/[&<>'"]/;const stringBufferToString=async(e,t)=>{let r="";t||=[];const s=await Promise.all(e);for(let e=s.length-1;;e--){r+=s[e];e--;if(e<0){break}let n=s[e];if(typeof n==="object"){t.push(...n.callbacks||[])}const o=n.isEscaped;n=await(typeof n==="object"?n.toString():n);if(typeof n==="object"){t.push(...n.callbacks||[])}if(n.isEscaped??o){r+=n}else{const e=[r];escapeToBuffer(n,e);r=e[0]}}return raw(r,t)};const escapeToBuffer=(e,t)=>{const r=e.search(a);if(r===-1){t[0]+=e;return}let s;let n;let o=0;for(n=r;n<e.length;n++){switch(e.charCodeAt(n)){case 34:s="&quot;";break;case 39:s="&#39;";break;case 38:s="&amp;";break;case 60:s="&lt;";break;case 62:s="&gt;";break;default:continue}t[0]+=e.substring(o,n)+s;o=n+1}t[0]+=e.substring(o,n)};const resolveCallbackSync=e=>{const t=e.callbacks;if(!t?.length){return e}const r=[e];const s={};t.forEach((e=>e({phase:i.Stringify,buffer:r,context:s})));return r[0]};const resolveCallback=async(e,t,r,s,n)=>{if(typeof e==="object"&&!(e instanceof String)){if(!(e instanceof Promise)){e=e.toString()}if(e instanceof Promise){e=await e}}const o=e.callbacks;if(!o?.length){return Promise.resolve(e)}if(n){n[0]+=e}else{n=[e]}const i=Promise.all(o.map((e=>e({phase:t,buffer:n,context:s})))).then((e=>Promise.all(e.filter(Boolean).map((e=>resolveCallback(e,t,false,s,n)))).then((()=>n[0]))));if(r){return raw(await i,o)}else{return i}};0&&0},2154:e=>{"use strict";var t=Object.defineProperty;var r=Object.getOwnPropertyDescriptor;var s=Object.getOwnPropertyNames;var n=Object.prototype.hasOwnProperty;var __export=(e,r)=>{for(var s in r)t(e,s,{get:r[s],enumerable:true})};var __copyProps=(e,o,i,a)=>{if(o&&typeof o==="object"||typeof o==="function"){for(let c of s(o))if(!n.call(e,c)&&c!==i)t(e,c,{get:()=>o[c],enumerable:!(a=r(o,c))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(t({},"__esModule",{value:true}),e);var o={};__export(o,{checkOptionalParameter:()=>checkOptionalParameter,decodeURIComponent_:()=>c,getPath:()=>getPath,getPathNoStrict:()=>getPathNoStrict,getPattern:()=>getPattern,getQueryParam:()=>a,getQueryParams:()=>getQueryParams,getQueryStrings:()=>getQueryStrings,mergePath:()=>mergePath,splitPath:()=>splitPath,splitRoutingPath:()=>splitRoutingPath,tryDecode:()=>tryDecode});e.exports=__toCommonJS(o);const splitPath=e=>{const t=e.split("/");if(t[0]===""){t.shift()}return t};const splitRoutingPath=e=>{const{groups:t,path:r}=extractGroupsFromPath(e);const s=splitPath(r);return replaceGroupMarks(s,t)};const extractGroupsFromPath=e=>{const t=[];e=e.replace(/\{[^}]+\}/g,((e,r)=>{const s=`@${r}`;t.push([s,e]);return s}));return{groups:t,path:e}};const replaceGroupMarks=(e,t)=>{for(let r=t.length-1;r>=0;r--){const[s]=t[r];for(let n=e.length-1;n>=0;n--){if(e[n].includes(s)){e[n]=e[n].replace(s,t[r][1]);break}}}return e};const i={};const getPattern=(e,t)=>{if(e==="*"){return"*"}const r=e.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);if(r){const s=`${e}#${t}`;if(!i[s]){if(r[2]){i[s]=t&&t[0]!==":"&&t[0]!=="*"?[s,r[1],new RegExp(`^${r[2]}(?=/${t})`)]:[e,r[1],new RegExp(`^${r[2]}$`)]}else{i[s]=[e,r[1],true]}}return i[s]}return null};const tryDecode=(e,t)=>{try{return t(e)}catch{return e.replace(/(?:%[0-9A-Fa-f]{2})+/g,(e=>{try{return t(e)}catch{return e}}))}};const tryDecodeURI=e=>tryDecode(e,decodeURI);const getPath=e=>{const t=e.url;const r=t.indexOf("/",8);let s=r;for(;s<t.length;s++){const e=t.charCodeAt(s);if(e===37){const e=t.indexOf("?",s);const n=t.slice(r,e===-1?void 0:e);return tryDecodeURI(n.includes("%25")?n.replace(/%25/g,"%2525"):n)}else if(e===63){break}}return t.slice(r,s)};const getQueryStrings=e=>{const t=e.indexOf("?",8);return t===-1?"":"?"+e.slice(t+1)};const getPathNoStrict=e=>{const t=getPath(e);return t.length>1&&t.at(-1)==="/"?t.slice(0,-1):t};const mergePath=(e,t,...r)=>{if(r.length){t=mergePath(t,...r)}return`${e?.[0]==="/"?"":"/"}${e}${t==="/"?"":`${e?.at(-1)==="/"?"":"/"}${t?.[0]==="/"?t.slice(1):t}`}`};const checkOptionalParameter=e=>{if(e.charCodeAt(e.length-1)!==63||!e.includes(":")){return null}const t=e.split("/");const r=[];let s="";t.forEach((e=>{if(e!==""&&!/\:/.test(e)){s+="/"+e}else if(/\:/.test(e)){if(/\?/.test(e)){if(r.length===0&&s===""){r.push("/")}else{r.push(s)}const t=e.replace("?","");s+="/"+t;r.push(s)}else{s+="/"+e}}}));return r.filter(((e,t,r)=>r.indexOf(e)===t))};const _decodeURI=e=>{if(!/[%+]/.test(e)){return e}if(e.indexOf("+")!==-1){e=e.replace(/\+/g," ")}return e.indexOf("%")!==-1?c(e):e};const _getQueryParam=(e,t,r)=>{let s;if(!r&&t&&!/[%+]/.test(t)){let r=e.indexOf(`?${t}`,8);if(r===-1){r=e.indexOf(`&${t}`,8)}while(r!==-1){const s=e.charCodeAt(r+t.length+1);if(s===61){const s=r+t.length+2;const n=e.indexOf("&",s);return _decodeURI(e.slice(s,n===-1?void 0:n))}else if(s==38||isNaN(s)){return""}r=e.indexOf(`&${t}`,r+1)}s=/[%+]/.test(e);if(!s){return void 0}}const n={};s??=/[%+]/.test(e);let o=e.indexOf("?",8);while(o!==-1){const t=e.indexOf("&",o+1);let i=e.indexOf("=",o);if(i>t&&t!==-1){i=-1}let a=e.slice(o+1,i===-1?t===-1?void 0:t:i);if(s){a=_decodeURI(a)}o=t;if(a===""){continue}let c;if(i===-1){c=""}else{c=e.slice(i+1,t===-1?void 0:t);if(s){c=_decodeURI(c)}}if(r){if(!(n[a]&&Array.isArray(n[a]))){n[a]=[]}n[a].push(c)}else{n[a]??=c}}return t?n[t]:n};const a=_getQueryParam;const getQueryParams=(e,t)=>_getQueryParam(e,t,true);const c=decodeURIComponent;0&&0},7613:e=>{"use strict";e.exports=JSON.parse('{"acl":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"append":{"arity":3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"asking":{"arity":1,"flags":["fast"],"keyStart":0,"keyStop":0,"step":0},"auth":{"arity":-2,"flags":["noscript","loading","stale","fast","no_auth","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"bgrewriteaof":{"arity":1,"flags":["admin","noscript","no_async_loading"],"keyStart":0,"keyStop":0,"step":0},"bgsave":{"arity":-1,"flags":["admin","noscript","no_async_loading"],"keyStart":0,"keyStop":0,"step":0},"bitcount":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"bitfield":{"arity":-2,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"bitfield_ro":{"arity":-2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"bitop":{"arity":-4,"flags":["write","denyoom"],"keyStart":2,"keyStop":-1,"step":1},"bitpos":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"blmove":{"arity":6,"flags":["write","denyoom","noscript","blocking"],"keyStart":1,"keyStop":2,"step":1},"blmpop":{"arity":-5,"flags":["write","blocking","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"blpop":{"arity":-3,"flags":["write","noscript","blocking"],"keyStart":1,"keyStop":-2,"step":1},"brpop":{"arity":-3,"flags":["write","noscript","blocking"],"keyStart":1,"keyStop":-2,"step":1},"brpoplpush":{"arity":4,"flags":["write","denyoom","noscript","blocking"],"keyStart":1,"keyStop":2,"step":1},"bzmpop":{"arity":-5,"flags":["write","blocking","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"bzpopmax":{"arity":-3,"flags":["write","noscript","blocking","fast"],"keyStart":1,"keyStop":-2,"step":1},"bzpopmin":{"arity":-3,"flags":["write","noscript","blocking","fast"],"keyStart":1,"keyStop":-2,"step":1},"client":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"cluster":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"command":{"arity":-1,"flags":["loading","stale"],"keyStart":0,"keyStop":0,"step":0},"config":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"copy":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":2,"step":1},"dbsize":{"arity":1,"flags":["readonly","fast"],"keyStart":0,"keyStop":0,"step":0},"debug":{"arity":-2,"flags":["admin","noscript","loading","stale"],"keyStart":0,"keyStop":0,"step":0},"decr":{"arity":2,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"decrby":{"arity":3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"del":{"arity":-2,"flags":["write"],"keyStart":1,"keyStop":-1,"step":1},"discard":{"arity":1,"flags":["noscript","loading","stale","fast","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"dump":{"arity":2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"echo":{"arity":2,"flags":["fast"],"keyStart":0,"keyStop":0,"step":0},"eval":{"arity":-3,"flags":["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"eval_ro":{"arity":-3,"flags":["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"evalsha":{"arity":-3,"flags":["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"evalsha_ro":{"arity":-3,"flags":["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"exec":{"arity":1,"flags":["noscript","loading","stale","skip_slowlog"],"keyStart":0,"keyStop":0,"step":0},"exists":{"arity":-2,"flags":["readonly","fast"],"keyStart":1,"keyStop":-1,"step":1},"expire":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"expireat":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"expiretime":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"failover":{"arity":-1,"flags":["admin","noscript","stale"],"keyStart":0,"keyStop":0,"step":0},"fcall":{"arity":-3,"flags":["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"fcall_ro":{"arity":-3,"flags":["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"flushall":{"arity":-1,"flags":["write"],"keyStart":0,"keyStop":0,"step":0},"flushdb":{"arity":-1,"flags":["write"],"keyStart":0,"keyStop":0,"step":0},"function":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"geoadd":{"arity":-5,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"geodist":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"geohash":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"geopos":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"georadius":{"arity":-6,"flags":["write","denyoom","movablekeys"],"keyStart":1,"keyStop":1,"step":1},"georadius_ro":{"arity":-6,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"georadiusbymember":{"arity":-5,"flags":["write","denyoom","movablekeys"],"keyStart":1,"keyStop":1,"step":1},"georadiusbymember_ro":{"arity":-5,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"geosearch":{"arity":-7,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"geosearchstore":{"arity":-8,"flags":["write","denyoom"],"keyStart":1,"keyStop":2,"step":1},"get":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"getbit":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"getdel":{"arity":2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"getex":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"getrange":{"arity":4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"getset":{"arity":3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"hdel":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"hello":{"arity":-1,"flags":["noscript","loading","stale","fast","no_auth","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"hexists":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"hget":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"hgetall":{"arity":2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"hincrby":{"arity":4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"hincrbyfloat":{"arity":4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"hkeys":{"arity":2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"hlen":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"hmget":{"arity":-3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"hmset":{"arity":-4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"hrandfield":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"hscan":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"hset":{"arity":-4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"hsetnx":{"arity":4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"hstrlen":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"hvals":{"arity":2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"incr":{"arity":2,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"incrby":{"arity":3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"incrbyfloat":{"arity":3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"info":{"arity":-1,"flags":["loading","stale"],"keyStart":0,"keyStop":0,"step":0},"keys":{"arity":2,"flags":["readonly"],"keyStart":0,"keyStop":0,"step":0},"lastsave":{"arity":1,"flags":["loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"latency":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"lcs":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":2,"step":1},"lindex":{"arity":3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"linsert":{"arity":5,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"llen":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"lmove":{"arity":5,"flags":["write","denyoom"],"keyStart":1,"keyStop":2,"step":1},"lmpop":{"arity":-4,"flags":["write","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"lolwut":{"arity":-1,"flags":["readonly","fast"],"keyStart":0,"keyStop":0,"step":0},"lpop":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"lpos":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"lpush":{"arity":-3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"lpushx":{"arity":-3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"lrange":{"arity":4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"lrem":{"arity":4,"flags":["write"],"keyStart":1,"keyStop":1,"step":1},"lset":{"arity":4,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"ltrim":{"arity":4,"flags":["write"],"keyStart":1,"keyStop":1,"step":1},"memory":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"mget":{"arity":-2,"flags":["readonly","fast"],"keyStart":1,"keyStop":-1,"step":1},"migrate":{"arity":-6,"flags":["write","movablekeys"],"keyStart":3,"keyStop":3,"step":1},"module":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"monitor":{"arity":1,"flags":["admin","noscript","loading","stale"],"keyStart":0,"keyStop":0,"step":0},"move":{"arity":3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"mset":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":-1,"step":2},"msetnx":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":-1,"step":2},"multi":{"arity":1,"flags":["noscript","loading","stale","fast","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"object":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"persist":{"arity":2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"pexpire":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"pexpireat":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"pexpiretime":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"pfadd":{"arity":-2,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"pfcount":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":-1,"step":1},"pfdebug":{"arity":3,"flags":["write","denyoom","admin"],"keyStart":2,"keyStop":2,"step":1},"pfmerge":{"arity":-2,"flags":["write","denyoom"],"keyStart":1,"keyStop":-1,"step":1},"pfselftest":{"arity":1,"flags":["admin"],"keyStart":0,"keyStop":0,"step":0},"ping":{"arity":-1,"flags":["fast"],"keyStart":0,"keyStop":0,"step":0},"psetex":{"arity":4,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"psubscribe":{"arity":-2,"flags":["pubsub","noscript","loading","stale"],"keyStart":0,"keyStop":0,"step":0},"psync":{"arity":-3,"flags":["admin","noscript","no_async_loading","no_multi"],"keyStart":0,"keyStop":0,"step":0},"pttl":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"publish":{"arity":3,"flags":["pubsub","loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"pubsub":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"punsubscribe":{"arity":-1,"flags":["pubsub","noscript","loading","stale"],"keyStart":0,"keyStop":0,"step":0},"quit":{"arity":-1,"flags":["noscript","loading","stale","fast","no_auth","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"randomkey":{"arity":1,"flags":["readonly"],"keyStart":0,"keyStop":0,"step":0},"readonly":{"arity":1,"flags":["loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"readwrite":{"arity":1,"flags":["loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"rename":{"arity":3,"flags":["write"],"keyStart":1,"keyStop":2,"step":1},"renamenx":{"arity":3,"flags":["write","fast"],"keyStart":1,"keyStop":2,"step":1},"replconf":{"arity":-1,"flags":["admin","noscript","loading","stale","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"replicaof":{"arity":3,"flags":["admin","noscript","stale","no_async_loading"],"keyStart":0,"keyStop":0,"step":0},"reset":{"arity":1,"flags":["noscript","loading","stale","fast","no_auth","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"restore":{"arity":-4,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"restore-asking":{"arity":-4,"flags":["write","denyoom","asking"],"keyStart":1,"keyStop":1,"step":1},"role":{"arity":1,"flags":["noscript","loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"rpop":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"rpoplpush":{"arity":3,"flags":["write","denyoom"],"keyStart":1,"keyStop":2,"step":1},"rpush":{"arity":-3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"rpushx":{"arity":-3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"sadd":{"arity":-3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"save":{"arity":1,"flags":["admin","noscript","no_async_loading","no_multi"],"keyStart":0,"keyStop":0,"step":0},"scan":{"arity":-2,"flags":["readonly"],"keyStart":0,"keyStop":0,"step":0},"scard":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"script":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"sdiff":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":-1,"step":1},"sdiffstore":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":-1,"step":1},"select":{"arity":2,"flags":["loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"set":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"setbit":{"arity":4,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"setex":{"arity":4,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"setnx":{"arity":3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"setrange":{"arity":4,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"shutdown":{"arity":-1,"flags":["admin","noscript","loading","stale","no_multi","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"sinter":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":-1,"step":1},"sintercard":{"arity":-3,"flags":["readonly","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"sinterstore":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":-1,"step":1},"sismember":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"slaveof":{"arity":3,"flags":["admin","noscript","stale","no_async_loading"],"keyStart":0,"keyStop":0,"step":0},"slowlog":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"smembers":{"arity":2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"smismember":{"arity":-3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"smove":{"arity":4,"flags":["write","fast"],"keyStart":1,"keyStop":2,"step":1},"sort":{"arity":-2,"flags":["write","denyoom","movablekeys"],"keyStart":1,"keyStop":1,"step":1},"sort_ro":{"arity":-2,"flags":["readonly","movablekeys"],"keyStart":1,"keyStop":1,"step":1},"spop":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"spublish":{"arity":3,"flags":["pubsub","loading","stale","fast"],"keyStart":1,"keyStop":1,"step":1},"srandmember":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"srem":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"sscan":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"ssubscribe":{"arity":-2,"flags":["pubsub","noscript","loading","stale"],"keyStart":1,"keyStop":-1,"step":1},"strlen":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"subscribe":{"arity":-2,"flags":["pubsub","noscript","loading","stale"],"keyStart":0,"keyStop":0,"step":0},"substr":{"arity":4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"sunion":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":-1,"step":1},"sunionstore":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":-1,"step":1},"sunsubscribe":{"arity":-1,"flags":["pubsub","noscript","loading","stale"],"keyStart":1,"keyStop":-1,"step":1},"swapdb":{"arity":3,"flags":["write","fast"],"keyStart":0,"keyStop":0,"step":0},"sync":{"arity":1,"flags":["admin","noscript","no_async_loading","no_multi"],"keyStart":0,"keyStop":0,"step":0},"time":{"arity":1,"flags":["loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"touch":{"arity":-2,"flags":["readonly","fast"],"keyStart":1,"keyStop":-1,"step":1},"ttl":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"type":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"unlink":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":-1,"step":1},"unsubscribe":{"arity":-1,"flags":["pubsub","noscript","loading","stale"],"keyStart":0,"keyStop":0,"step":0},"unwatch":{"arity":1,"flags":["noscript","loading","stale","fast","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"wait":{"arity":3,"flags":["noscript"],"keyStart":0,"keyStop":0,"step":0},"watch":{"arity":-2,"flags":["noscript","loading","stale","fast","allow_busy"],"keyStart":1,"keyStop":-1,"step":1},"xack":{"arity":-4,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"xadd":{"arity":-5,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"xautoclaim":{"arity":-6,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"xclaim":{"arity":-6,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"xdel":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"xgroup":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"xinfo":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"xlen":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"xpending":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"xrange":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"xread":{"arity":-4,"flags":["readonly","blocking","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"xreadgroup":{"arity":-7,"flags":["write","blocking","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"xrevrange":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"xsetid":{"arity":-3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"xtrim":{"arity":-4,"flags":["write"],"keyStart":1,"keyStop":1,"step":1},"zadd":{"arity":-4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"zcard":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zcount":{"arity":4,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zdiff":{"arity":-3,"flags":["readonly","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"zdiffstore":{"arity":-4,"flags":["write","denyoom","movablekeys"],"keyStart":1,"keyStop":1,"step":1},"zincrby":{"arity":4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"zinter":{"arity":-3,"flags":["readonly","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"zintercard":{"arity":-3,"flags":["readonly","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"zinterstore":{"arity":-4,"flags":["write","denyoom","movablekeys"],"keyStart":1,"keyStop":1,"step":1},"zlexcount":{"arity":4,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zmpop":{"arity":-4,"flags":["write","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"zmscore":{"arity":-3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zpopmax":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"zpopmin":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"zrandmember":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrange":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrangebylex":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrangebyscore":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrangestore":{"arity":-5,"flags":["write","denyoom"],"keyStart":1,"keyStop":2,"step":1},"zrank":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zrem":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"zremrangebylex":{"arity":4,"flags":["write"],"keyStart":1,"keyStop":1,"step":1},"zremrangebyrank":{"arity":4,"flags":["write"],"keyStart":1,"keyStop":1,"step":1},"zremrangebyscore":{"arity":4,"flags":["write"],"keyStart":1,"keyStop":1,"step":1},"zrevrange":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrevrangebylex":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrevrangebyscore":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrevrank":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zscan":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zscore":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zunion":{"arity":-3,"flags":["readonly","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"zunionstore":{"arity":-4,"flags":["write","denyoom","movablekeys"],"keyStart":1,"keyStop":1,"step":1}}')}};var __webpack_module_cache__={};function __nccwpck_require__(e){var t=__webpack_module_cache__[e];if(t!==undefined){return t.exports}var r=__webpack_module_cache__[e]={exports:{}};var s=true;try{__webpack_modules__[e].call(r.exports,r,r.exports,__nccwpck_require__);s=false}finally{if(s)delete __webpack_module_cache__[e]}return r.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var __webpack_exports__={};(()=>{"use strict";var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:true});const t=__nccwpck_require__(3790);const r=__nccwpck_require__(6233);const s=__nccwpck_require__(5058);const n=__nccwpck_require__(8165);const o=__nccwpck_require__(1857);const i=__nccwpck_require__(122);const a=new r.Hono;a.use((0,s.cors)());a.get("/",(e=>e.json({status:"working"})));a.post("/kv",o.storeHandler);a.get("/videoplayback",(async e=>{const t=e.req.query("v");if(!t){return e.json({error:"Missing video parameter"},400)}const r=await i.kvStore.get(t);if(!r){return e.json({error:"Video not found"},404)}return(0,n.proxy)(r,{...e.req,headers:e.req.header()})}));a.all("/proxy",(async e=>{const t=e.req.query("__href");if(!t){return e.json({error:"Missing href parameter"},400)}return(0,n.proxy)(t,{...e.req,headers:e.req.header()})}));(0,t.serve)({fetch:a.fetch})})();module.exports=__webpack_exports__})();